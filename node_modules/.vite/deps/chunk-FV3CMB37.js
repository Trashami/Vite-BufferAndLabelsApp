import {
  d,
  e as e2,
  n as n2
} from "./chunk-AIDV7EKX.js";
import {
  e,
  m,
  n2 as n,
  y as y2
} from "./chunk-OOLCFNXJ.js";
import {
  s2 as s
} from "./chunk-UA3YPL2R.js";
import {
  has,
  y
} from "./chunk-HVKDYDPP.js";

// node_modules/@arcgis/core/layers/effects/EffectView.js
var l = -1;
var a = class extends m {
  constructor(t) {
    super(t), this._from = null, this._to = null, this._final = null, this._current = [], this._time = 0, this.duration = has("mapview-transitions-duration"), this.effects = [];
  }
  set effect(t) {
    if (this._get("effect") !== (t = t || "")) {
      this._set("effect", t);
      try {
        this._transitionTo(h(t));
      } catch (e3) {
        this._transitionTo([]), s.getLogger(this.declaredClass).warn("Invalid Effect", { effect: t, error: e3 });
      }
    }
  }
  get hasEffects() {
    return this.transitioning || !!this.effects.length;
  }
  set scale(t) {
    this._updateForScale(t);
  }
  get transitioning() {
    return null !== this._to;
  }
  canTransitionTo(t) {
    try {
      return this.scale > 0 && u(this._current, h(t), this.scale);
    } catch {
      return false;
    }
  }
  transitionStep(t, e3) {
    this._applyTimeTransition(t), this._updateForScale(e3);
  }
  endTransitions() {
    this._applyTimeTransition(this.duration);
  }
  _transitionTo(t) {
    this.scale > 0 && u(this._current, t, this.scale) ? (this._final = t, this._to = y(t), _(this._current, this._to, this.scale), this._from = y(this._current), this._time = 0) : (this._from = this._to = this._final = null, this._current = t), this._set("effects", this._current[0] ? y(this._current[0].effects) : []);
  }
  _applyTimeTransition(t) {
    if (!(this._to && this._from && this._current && this._final))
      return;
    this._time += t;
    const e3 = Math.min(1, this._time / this.duration);
    for (let s2 = 0; s2 < this._current.length; s2++) {
      const t2 = this._current[s2], r = this._from[s2], i = this._to[s2];
      t2.scale = p(r.scale, i.scale, e3);
      for (let s3 = 0; s3 < t2.effects.length; s3++) {
        const n3 = t2.effects[s3], c = r.effects[s3], o = i.effects[s3];
        n3.interpolate(c, o, e3);
      }
    }
    1 === e3 && (this._current = this._final, this._set("effects", this._current[0] ? y(this._current[0].effects) : []), this._from = this._to = this._final = null);
  }
  _updateForScale(t) {
    if (this._set("scale", t), 0 === this._current.length)
      return;
    const e3 = this._current, s2 = this._current.length - 1;
    let r, i, n3 = 1;
    if (1 === e3.length || t >= e3[0].scale)
      i = r = e3[0].effects;
    else if (t <= e3[s2].scale)
      i = r = e3[s2].effects;
    else
      for (let c = 0; c < s2; c++) {
        const s3 = e3[c], o = e3[c + 1];
        if (s3.scale >= t && o.scale <= t) {
          n3 = (t - s3.scale) / (o.scale - s3.scale), r = s3.effects, i = o.effects;
          break;
        }
      }
    for (let c = 0; c < this.effects.length; c++) {
      this.effects[c].interpolate(r[c], i[c], n3);
    }
  }
};
function h(t) {
  const e3 = d(t) || [];
  return m2(e3) ? [{ scale: l, effects: e3 }] : e3;
}
function u(t, e3, s2) {
  var _a, _b, _c, _d;
  if (!((_a = t[0]) == null ? void 0 : _a.effects) || !((_b = e3[0]) == null ? void 0 : _b.effects))
    return true;
  return !((((_c = t[0]) == null ? void 0 : _c.scale) === l || ((_d = e3[0]) == null ? void 0 : _d.scale) === l) && (t.length > 1 || e3.length > 1) && s2 <= 0) && n2(t[0].effects, e3[0].effects);
}
function _(t, e3, s2) {
  var _a, _b;
  const r = t.length > e3.length ? t : e3, i = t.length > e3.length ? e3 : t, n3 = i[i.length - 1], c = (_a = n3 == null ? void 0 : n3.scale) != null ? _a : s2, o = (_b = n3 == null ? void 0 : n3.effects) != null ? _b : [];
  for (let f = i.length; f < r.length; f++)
    i.push({ scale: c, effects: [...o] });
  for (let a2 = 0; a2 < r.length; a2++)
    i[a2].scale = i[a2].scale === l ? s2 : i[a2].scale, r[a2].scale = r[a2].scale === l ? s2 : r[a2].scale, e2(i[a2].effects, r[a2].effects);
}
function p(t, e3, s2) {
  return t + (e3 - t) * s2;
}
function m2(t) {
  const e3 = t[0];
  return !!e3 && "type" in e3;
}
e([y2()], a.prototype, "_to", void 0), e([y2()], a.prototype, "duration", void 0), e([y2({ value: "" })], a.prototype, "effect", null), e([y2({ readOnly: true })], a.prototype, "effects", void 0), e([y2({ readOnly: true })], a.prototype, "hasEffects", null), e([y2({ value: 0 })], a.prototype, "scale", null), e([y2({ readOnly: true })], a.prototype, "transitioning", null), a = e([n("esri.layers.effects.EffectView")], a);

export {
  a
};
//# sourceMappingURL=chunk-FV3CMB37.js.map
