{
  "version": 3,
  "sources": ["../../@arcgis/core/libs/i3s/enums.js", "../../@arcgis/core/libs/i3s/I3SModule.js", "../../@arcgis/core/views/3d/layers/i3s/I3SNode.js", "../../@arcgis/core/views/3d/layers/SceneLayerWorker.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nvar n,e;!function(n){n[n.None=0]=\"None\",n[n.Int16=1]=\"Int16\",n[n.Int32=2]=\"Int32\"}(n||(n={})),function(n){n[n.Replace=0]=\"Replace\",n[n.Outside=1]=\"Outside\",n[n.Inside=2]=\"Inside\",n[n.Finished=3]=\"Finished\"}(e||(e={}));export{n as IndexType,e as ModificationType};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as t}from\"../../assets.js\";function e(){return n||(n=new Promise((t=>import(\"../../chunks/i3s.js\").then((t=>t.i)).then((({default:e})=>{const n=e({locateFile:i,onRuntimeInitialized:()=>t(n)});delete n.then})))).catch((t=>{throw t}))),n}function i(e){return t(`esri/libs/i3s/${e}`)}let n;export{e as get};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{f as e}from\"../../../../chunks/sphere.js\";class t{constructor(t,i){this.id=t,this.mbs=i,this.renderMbs=e(0,0,0,-1),this.elevationRange=null}}class i{constructor(){this.min=1/0,this.max=-1/0,this.valid=!1}}var n,o,s,a,c;!function(e){e[e.Unmodified=0]=\"Unmodified\",e[e.Culled=1]=\"Culled\",e[e.NotChecked=2]=\"NotChecked\"}(n||(n={})),function(e){e[e.Unmodified=0]=\"Unmodified\",e[e.PotentiallyModified=1]=\"PotentiallyModified\",e[e.Culled=2]=\"Culled\",e[e.Unknown=3]=\"Unknown\",e[e.NotChecked=4]=\"NotChecked\"}(o||(o={}));class h extends t{constructor(e,t,i,n,a,c,h,d,r,l){super(e,i),this.index=t,this.childCount=n,this.level=a,this.resources=c,this.version=h,this.lodMetric=d,this.maxError=r,this.numFeatures=l,this.failed=!1,this.cacheState=s.Unknown,this.vertexCount=0,this.memory=0,this.childrenLoaded=0,this.hasModifications=!1,this.imModificationImpact=o.NotChecked}}!function(e){e[e.Unknown=0]=\"Unknown\",e[e.Uncached=1]=\"Uncached\",e[e.Cached=2]=\"Cached\"}(s||(s={})),function(e){e[e.None=0]=\"None\",e[e.MaxScreenThreshold=1]=\"MaxScreenThreshold\",e[e.ScreenSpaceRelative=2]=\"ScreenSpaceRelative\",e[e.RemovedFeatureDiameter=3]=\"RemovedFeatureDiameter\",e[e.DistanceRangeFromDefaultCamera=4]=\"DistanceRangeFromDefaultCamera\"}(a||(a={})),function(e){e[e.Hole=0]=\"Hole\",e[e.Leaf=1]=\"Leaf\"}(c||(c={}));class d{constructor(e,t,i,n){this.nodeHasLOD=e,this.isChosen=t,this.lodLevel=i,this.version=n}}export{s as CacheState,i as ElevationRange,a as LodMetric,h as Node,t as NodeBase,n as NodeFilterImpact,o as NodeIMModificationImpact,c as NodeState,d as NodeTraversalState};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{slice as t}from\"../../../core/typedArrayUtil.js\";import{IndexType as r}from\"../../../libs/i3s/enums.js\";import{get as n}from\"../../../libs/i3s/I3SModule.js\";import{NodeIMModificationImpact as o}from\"./i3s/I3SNode.js\";async function s(e){await g();const t=[e.geometryBuffer];return{result:m(e,t),transferList:t}}async function f(e){await g();const r=[e.geometryBuffer],{geometryBuffer:n}=e,o=n.byteLength,s=y._malloc(o),f=new Uint8Array(y.HEAPU8.buffer,s,o);f.set(new Uint8Array(n));const i=y.dracoDecompressPointCloudData(s,f.byteLength);if(y._free(s),i.error.length>0)throw`i3s.wasm: ${i.error}`;const a=i.featureIds?.length>0?t(i.featureIds):null,u=t(i.positions);return a&&r.push(a.buffer),r.push(u.buffer),{result:{positions:u,featureIds:a},transferList:r}}async function i(e){await g(),E(e);const t={buffer:e.buffer};return{result:t,transferList:[t.buffer]}}async function a(e){await g(),b(e)}async function u(e){await g(),y.setLegacySchema(e.context,e.jsonSchema)}function l(e){h(e)}let c,y;function b(e){const t=e.modifications,r=y._malloc(8*t.length),n=new Float64Array(y.HEAPU8.buffer,r,t.length);for(let o=0;o<t.length;++o)n[o]=t[o];y.setModifications(e.context,r,t.length,e.isGeodetic),y._free(r)}function m(n,o){if(!y)return null;const{context:s,localOrigin:f,globalTrafo:i,mbs:a,obb:u,elevationOffset:l,geometryBuffer:c,geometryDescriptor:b,indexToVertexProjector:m,vertexToRenderProjector:d}=n,E=y._malloc(c.byteLength),h=33,g=y._malloc(h*Float64Array.BYTES_PER_ELEMENT),w=new Uint8Array(y.HEAPU8.buffer,E,c.byteLength);w.set(new Uint8Array(c));const A=new Float64Array(y.HEAPU8.buffer,g,h);p(A,f);let _=A.byteOffset+3*A.BYTES_PER_ELEMENT,L=new Float64Array(A.buffer,_);p(L,i),_+=16*A.BYTES_PER_ELEMENT,L=new Float64Array(A.buffer,_),p(L,a),_+=4*A.BYTES_PER_ELEMENT,e(u)&&(L=new Float64Array(A.buffer,_),p(L,u.center),_+=3*A.BYTES_PER_ELEMENT,L=new Float64Array(A.buffer,_),p(L,u.halfSize),_+=3*A.BYTES_PER_ELEMENT,L=new Float64Array(A.buffer,_),p(L,u.quaternion));const I=b,T={isDraco:!1,isLegacy:!1,color:n.layouts.some((e=>e.some((e=>\"color\"===e.name)))),normal:n.needNormals&&n.layouts.some((e=>e.some((e=>\"normalCompressed\"===e.name)))),uv0:n.layouts.some((e=>e.some((e=>\"uv0\"===e.name)))),uvRegion:n.layouts.some((e=>e.some((e=>\"uvRegion\"===e.name)))),featureIndex:I.featureIndex},P=y.process(s,!!n.obb,E,w.byteLength,I,T,g,l,m,d,n.normalReferenceFrame);if(y._free(g),y._free(E),P.error.length>0)throw`i3s.wasm: ${P.error}`;if(P.discarded)return null;const U=P.componentOffsets.length>0?t(P.componentOffsets):null,B=P.featureIds.length>0?t(P.featureIds):null,F=t(P.interleavedVertedData).buffer,M=P.indicesType===r.Int16?t(new Uint16Array(P.indices.buffer,P.indices.byteOffset,P.indices.byteLength/2)):t(new Uint32Array(P.indices.buffer,P.indices.byteOffset,P.indices.byteLength/4)),S=t(P.positions),x=P.positionIndicesType===r.Int16?t(new Uint16Array(P.positionIndices.buffer,P.positionIndices.byteOffset,P.positionIndices.byteLength/2)):t(new Uint32Array(P.positionIndices.buffer,P.positionIndices.byteOffset,P.positionIndices.byteLength/4)),O={layout:n.layouts[0],interleavedVertexData:F,indices:M,hasColors:P.hasColors,hasModifications:P.hasModifications,positionData:{data:S,indices:x}};return B&&o.push(B.buffer),U&&o.push(U.buffer),o.push(F),o.push(M.buffer),o.push(S.buffer),o.push(x.buffer),{componentOffsets:U,featureIds:B,transformedGeometry:O,obb:P.obb}}function d(e){return 0===e?o.Unmodified:1===e?o.PotentiallyModified:2===e?o.Culled:o.Unknown}function E(e){const{context:t,buffer:r}=e,n=y._malloc(r.byteLength),o=r.byteLength/Float64Array.BYTES_PER_ELEMENT,s=new Float64Array(y.HEAPU8.buffer,n,o),f=new Float64Array(r);s.set(f),y.filterOBBs(t,n,o),f.set(s),y._free(n)}function h(e){y&&y.destroy(e)}function p(e,t){for(let r=0;r<t.length;++r)e[r]=t[r]}function g(){return y?Promise.resolve():(c||(c=n().then((e=>{y=e,c=null}))),c)}const w={transform:m,destroy:h};export{l as destroyContext,f as dracoDecompressPointCloudData,i as filterObbsForModifications,E as filterObbsForModificationsSync,g as initialize,d as interpretObbModificationResults,s as process,u as setLegacySchema,a as setModifications,b as setModificationsSync,w as test};\n"],
  "mappings": "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",
  "names": ["n", "e", "n", "t", "n", "a", "e", "e", "a", "s", "e", "t", "r", "n", "o", "f", "i", "a", "u", "E", "c", "l", "b", "m", "d", "h", "g", "w"]
}
