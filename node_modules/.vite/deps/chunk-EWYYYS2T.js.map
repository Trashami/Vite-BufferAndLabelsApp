{
  "version": 3,
  "sources": ["../../@arcgis/core/views/2d/layers/features/support/rendererUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/Error.js\";import has from\"../../../../../core/has.js\";import r from\"../../../../../core/Logger.js\";import{toPt as t}from\"../../../../../core/screenUtils.js\";import{getWebGLCapabilities as o}from\"../../../../webgl/capabilities.js\";const s=8,l=s-2,a=r.getLogger(\"esri.views.2d.layers.features.support.rendererUtils\"),n=e=>{if(!(\"visualVariables\"in e)||!e.visualVariables||!e.visualVariables.length)return e;const r=e.clone(),t=r.visualVariables.map((e=>u(e)?p(e):e));return r.visualVariables=t,r};function i(e){return e.map((e=>u(e)?p(e.clone()):e))}function u(e){return(\"size\"===e.type||\"color\"===e.type||\"opacity\"===e.type)&&null!=e.stops}function p(e){return e.stops=m(e.type,e.stops),e}function c(e,r,t){return(1-t)*e+t*r}function f(e,r){const[o,...s]=r,a=s.pop(),n=s[0].value,i=s[s.length-1].value,u=(i-n)/l,p=[];for(let l=n;l<i;l+=u){let o=0;for(;l>=s[o].value;)o++;const a=s[o],n=r[o-1],i=l-n.value,u=a.value===n.value?1:i/(a.value-n.value);if(\"color\"===e){const e=s[o],t=r[o-1],a=e.color.clone();a.r=c(t.color.r,a.r,u),a.g=c(t.color.g,a.g,u),a.b=c(t.color.b,a.b,u),a.a=c(t.color.a,a.a,u),p.push({value:l,color:a,label:e.label})}else if(\"size\"===e){const e=s[o],a=r[o-1],n=t(e.size),i=c(t(a.size),n,u);p.push({value:l,size:i,label:e.label})}else{const e=s[o],t=c(r[o-1].opacity,e.opacity,u);p.push({value:l,opacity:t,label:e.label})}}return[o,...p,a]}function b(e){const[r,...t]=e,o=t.pop();for(;t.length>l;){let e=0,r=0;for(let o=1;o<t.length;o++){const s=t[o-1],l=t[o],a=Math.abs(l.value-s.value);a>r&&(r=a,e=o)}t.splice(e,1)}return[r,...t,o]}function m(e,r){return r.length<=s?r:(a.warn(`Found ${r.length} Visual Variable stops, but MapView only supports ${s}. Displayed stops will be simplified.`),r.length>2*s?f(e,r):b(r))}function g(){if(has(\"heatmap-force-raster\"))return\"raster\";const{supportsTextureFloat:e,supportsTextureHalfFloat:r,supportsColorBufferFloat:t,supportsColorBufferFloatBlend:s,supportsColorBufferHalfFloat:l}=o(\"2d\");return e&&t&&s||r&&l?\"symbol\":has(\"heatmap-allow-raster-fallback\")?\"raster\":\"none\"}function h(r){if(!r)return!0;switch(r.type){case\"dot-density\":if(!o(\"2d\").supportsTextureFloat)return a.error(new e(\"webgl-missing-extension\",\"Missing WebGL extension OES_Texture_Float which is required for DotDensity\")),!1;break;case\"heatmap\":{const r=g();if(\"none\"===r||\"raster\"===r&&!has(\"heatmap-force-raster\")){const t=o(\"2d\"),s=[\"supportsTextureFloat\",\"supportsTextureHalfFloat\",\"supportsColorBufferFloat\",\"supportsColorBufferFloatBlend\",\"supportsColorBufferHalfFloat\"].filter((e=>!t[e])).join(\", \");if(\"none\"===r)return a.errorOnce(new e(\"webgl-missing-extension\",`Missing WebGL${t.type} requirements for Heatmap: ${s}`)),!1;\"raster\"===r&&a.warnOnce(`Missing WebGL${t.type} requirements for accelerated Heatmap: ${s}. Feature support may be limited.`)}break}}return!0}export{g as getSupportedHeatmapRenderer,h as isRendererSupported,n as simplifyVVRenderer,i as simplifyVisualVariables};\n"],
  "mappings": "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",
  "names": ["s", "l", "e", "o", "a", "n", "i", "u", "p", "r"]
}
