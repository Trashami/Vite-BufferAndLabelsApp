{
  "version": 3,
  "sources": ["../../@arcgis/core/support/arcadeOnDemand.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport\"../geometry.js\";import e from\"../core/Error.js\";import r from\"../core/Logger.js\";import{isSome as t}from\"../core/maybe.js\";import a from\"../geometry/SpatialReference.js\";const s=r.getLogger(\"esri.support.arcadeOnDemand\");let c;function i(){return c||(c=(async()=>{const e=await import(\"./arcadeUtils.js\");return{arcade:e.arcade,arcadeUtils:e,Dictionary:e.Dictionary,Feature:e.arcadeFeature}})()),c}const n=(e,r,t)=>p.create(e,r,t,null,[\"$feature\"]),o=(e,r,t)=>p.create(e,r,t,null,[\"$feature\",\"$view\"]),l=o,u=(e,r,t,a)=>p.create(e,r,t,a,[\"$feature\",\"$view\"]);class p{constructor(e,r,t,a,s,c,i,n){this.script=e,this.evaluate=s;const o=Array.isArray(i)?i:i.fields;this.fields=o,this._syntaxTree=a,this._arcade=r,this._arcadeDictionary=t,this._arcadeFeature=c,this._spatialReference=n,this._referencesGeometry=r.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,\"scale\")}static async create(r,c,n,o,l,u){const{arcade:d,Feature:m,Dictionary:f}=await i(),y=a.fromJSON(c);let h=null;try{h=d.parseScript(r,u)}catch(R){return s.error(new e(\"arcade-bad-expression\",\"Failed to parse arcade script\",{script:r,error:R})),null}const _=l.reduce(((e,r)=>({...e,[r]:null})),{});let w=null;t(o)&&(w=new f(o),w.immutable=!0,_.$config=null);const F=d.scriptUsesGeometryEngine(h),g=F&&d.enableGeometrySupport(),S=d.scriptUsesFeatureSet(h)&&d.enableFeatureSetSupport(),b=d.scriptIsAsync(h),x=b&&d.enableAsyncSupport(),$={vars:_,spatialReference:y,useAsync:!!x};await Promise.all([g,S,x]);const v=new Set;await d.loadDependentModules(v,h,null,b,F);const D=new f;D.immutable=!1,D.setField(\"scale\",0);const j=d.compileScript(h,$),G=e=>(\"$view\"in e&&e.$view&&(D.setField(\"scale\",e.$view.scale),e.$view=D),w&&(e.$config=w),j({vars:e,spatialReference:y}));return new p(r,d,f,h,G,new m,n,y)}repurposeFeature(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}createDictionary(){return new this._arcadeDictionary}referencesMember(e){return this._arcade.referencesMember(this._syntaxTree,e)}referencesFunction(e){return this._arcade.referencesFunction(this._syntaxTree,e)}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}extractFieldLiterals(){return this._arcade.extractExpectedFieldLiterals(this._syntaxTree)}}export{p as ArcadeExpression,u as createDictionaryExpression,n as createLabelExpression,o as createRendererExpression,l as createVVExpression,i as loadArcade};\n"],
  "mappings": "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",
  "names": ["s", "r", "r", "s", "c", "i", "n", "o", "u"]
}
