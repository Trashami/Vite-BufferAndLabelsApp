{
  "version": 3,
  "sources": ["../../@arcgis/core/views/2d/engine/webgl/cpuMapped/FreeList.js", "../../@arcgis/core/views/2d/engine/webgl/BufferPool.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isNone as t}from\"../../../../../core/maybe.js\";class a{constructor(t){if(this.next=null,!Array.isArray(t))return void(this.data=t);this.data=t[0];let e=this;for(let n=1;n<t.length;n++)e.next=new a([t[n]]),e=e.next}*values(){let t=this;for(;t;)yield t.data,t=t.next}forEach(t){let a=this;for(;a;)t(a.data),a=a.next}find(t){return t(this.data)?this:this.next?.find(t)}max(t,a=this){const e=t(this.data)>t(a.data)?this:a;return this.next?this.next.max(t,e):e}remove(t,a=null){return this===t?a?(a.next=this.next,a):this.next:this.next?.remove(t,this)??null}get last(){return this.next?this.next.last:this}}class e{constructor(e){this._head=null,t(e)||(this._head=new a(e))}get head(){return this._head}maxAvailableSpace(){if(t(this._head))return 0;const a=this._head.max((t=>t.end-t.start));return a.data.end-a.data.start}firstFit(a){if(t(this._head))return null;let e=null,n=this._head;for(;n;){const t=n.data.end-n.data.start;if(t===a)return e?e.next=n.next:this._head=n.next,n.data.start;if(t>a){const t=n.data.start;return n.data.start+=a,t}e=n,n=n.next}return null}free(e,n){const r=e+n;if(t(this._head)){const t=new a({start:e,end:r});return void(this._head=t)}if(r<=this._head.data.start){if(r===this._head.data.start)return void(this._head.data.start-=n);const t=new a({start:e,end:r});return t.next=this._head,void(this._head=t)}let s=this._head,d=s.next;for(;d;){if(d.data.start>=r){if(s.data.end===e){if(s.data.end+=n,s.data.end===d.data.start){const t=d.data.end-d.data.start;return s.data.end+=t,void(s.next=d.next)}return}if(d.data.start===r)return void(d.data.start-=n);const t=new a({start:e,end:r});return t.next=s.next,void(s.next=t)}s=d,d=d.next}if(e===s.data.end)return void(s.data.end+=n);const i=new a({start:e,end:r});s.next=i}}export{e as FreeList,a as List};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport has from\"../../../../core/has.js\";import{isSome as t,unwrapOrThrow as e,isNone as s}from\"../../../../core/maybe.js\";import{FreeList as r}from\"./cpuMapped/FreeList.js\";const a=has(\"esri-2d-log-allocations\");class i{constructor(t,e){this._array=t,this._pool=e}get array(){return this._array}get length(){return this._array.length}static create(t,e){const s=e.acquire(t);return new i(s,e)}expand(t){const e=this._pool.acquire(t);e.set(this._array),this._pool.release(this._array),this._array=e}destroy(){this._pool.release(this._array)}set(t,e){this._array.set(t._array,e)}slice(){const t=this._pool.acquire(this._array.byteLength);return t.set(this._array),new i(t,this._pool)}}class o{constructor(){this._data=new ArrayBuffer(o.BYTE_LENGTH),this._freeList=new r({start:0,end:this._data.byteLength})}static get BYTE_LENGTH(){return 64e6}get buffer(){return this._data}allocate(t){const e=this._freeList.firstFit(t);return s(e)?null:new Uint32Array(this._data,e,t/Uint32Array.BYTES_PER_ELEMENT)}free(t){this._freeList.free(t.byteOffset,t.byteLength)}}class n{constructor(){this._bytesAllocated=0,this._pages=[],this._pagesByBuffer=new Map,this._addPage()}destroy(){this._pages=[],this._pagesByBuffer=null}get _bytesTotal(){return this._pages.length*o.BYTE_LENGTH}acquire(s){if(this._bytesAllocated+=s,a&&console.log(`Allocating ${s}, (${this._bytesAllocated} / ${this._bytesTotal})`),s>o.BYTE_LENGTH)return new Uint32Array(s/Uint32Array.BYTES_PER_ELEMENT);for(const e of this._pages){const r=e.allocate(s);if(t(r))return r}return e(this._addPage().allocate(s),\"Expected to allocate page\")}release(t){this._bytesAllocated-=t.byteLength,a&&console.log(`Freeing ${t.byteLength}, (${this._bytesAllocated} / ${this._bytesTotal})`);const e=this._pagesByBuffer.get(t.buffer);e&&e.free(t)}_addPage(){const t=new o;return this._pages.push(t),this._pagesByBuffer.set(t.buffer,t),t}}export{n as BufferPool,i as TypedBuffer};\n"],
  "mappings": "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",
  "names": ["t", "e", "n", "a", "r", "i", "a", "t", "e", "r"]
}
