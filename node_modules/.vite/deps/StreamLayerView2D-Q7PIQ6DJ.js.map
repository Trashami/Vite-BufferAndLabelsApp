{
  "version": 3,
  "sources": ["../../@arcgis/core/views/2d/layers/StreamLayerView2D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{isNone as r,isSome as s}from\"../../../core/maybe.js\";import{watch as i}from\"../../../core/reactiveUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../rest/support/FeatureSet.js\";import c from\"./FeatureLayerView2D.js\";import{toJSONGeometryType as p}from\"./support/util.js\";function l(e,t){if(r(e)&&r(t))return null;const i={};return s(t)&&(i.geometry=t.toJSON()),s(e)&&(i.where=e),i}let d=class extends c{constructor(){super(...arguments),this._enabledDataReceived=!1,this.errorString=null,this.connectionStatus=\"disconnected\"}initialize(){this.handles.add([i((()=>this.layer?.purgeOptions),(()=>this._update())),i((()=>this.suspended),(e=>{e?this._proxy.pauseStream():this._proxy.resumeStream()}))])}get connectionError(){if(this.errorString)return new t(\"stream-controller\",this.errorString)}on(e,t){\"data-received\"===e&&(this._enabledDataReceived=!0,this._proxy.enableEvent(\"data-received\",!0));const r=super.on(e,t),s=this;return{remove(){r.remove(),\"data-received\"===e&&(s._proxy.closed||s.hasEventListener(\"data-received\")||s._proxy.enableEvent(\"data-received\",!1))}}}queryLatestObservations(e,r){if(!(this.layer.timeInfo.endField||this.layer.timeInfo.startField))throw new t(\"streamlayer-no-timeField\",\"queryLatestObservation can only be used with services that define a TrackIdField\");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),r).then((e=>{const t=n.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}detach(){super.detach(),this.connectionStatus=\"disconnected\"}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(l(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),s=p(e.geometryType),i=e.timeInfo&&e.timeInfo.toJSON()||null,o=e.spatialReference?e.spatialReference.toJSON():null;return{type:\"stream\",fields:r,geometryType:s,objectIdField:t,timeInfo:i,source:this.layer.parsedUrl,serviceFilter:l(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enableDataReceived:this._enabledDataReceived,spatialReference:o,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:e.customParameters}}};e([o()],d.prototype,\"errorString\",void 0),e([o({readOnly:!0})],d.prototype,\"connectionError\",null),e([o()],d.prototype,\"connectionStatus\",void 0),d=e([a(\"esri.views.2d.layers.StreamLayerView2D\")],d);const u=d;export{u as default};\n"],
  "mappings": "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",
  "names": ["l", "e", "t", "r", "s"]
}
