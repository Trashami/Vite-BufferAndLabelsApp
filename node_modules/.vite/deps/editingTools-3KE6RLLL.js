import {
  A as A8,
  B as B3,
  C as C4,
  E as E8,
  E2 as E9,
  F as F4,
  H as H5,
  J2 as J,
  Q as Q2,
  T as T3,
  T2 as T4,
  X as X3,
  Z as Z5,
  b as b6,
  e as e16,
  f as f11,
  f3 as f12,
  h2 as h13,
  i as i12,
  i4 as i13,
  k as k2,
  l as l14,
  m as m11,
  m2 as m12,
  m3 as m13,
  q as q6,
  r2 as r13,
  s2 as s13,
  v3 as v9,
  x as x8
} from "./chunk-LOQE65I2.js";
import {
  i as i14,
  p as p14
} from "./chunk-6ZSFG5OL.js";
import {
  a as a16,
  c as c8,
  l as l15,
  n as n10,
  p as p13,
  r as r14
} from "./chunk-O5SNR6GN.js";
import {
  C as C5
} from "./chunk-NVFGGIRQ.js";
import "./chunk-7UVYS6N7.js";
import "./chunk-TMILTRNC.js";
import "./chunk-ZGU5MP3X.js";
import "./chunk-KPTMJVEB.js";
import "./chunk-EHTPZ3ZP.js";
import {
  h as h14
} from "./chunk-CNSD6N77.js";
import {
  w as w7
} from "./chunk-ROBFQONW.js";
import "./chunk-T6LV2MRC.js";
import {
  g as g8
} from "./chunk-XYNJ24V5.js";
import {
  G as G2,
  H as H3,
  X
} from "./chunk-WWDLDTQB.js";
import {
  C,
  C2,
  D as D3,
  G as G3,
  M as M4,
  P as P3,
  U as U3,
  X as X2,
  Z as Z3,
  c as c7,
  d as d10,
  g as g7,
  h as h12,
  o as o12,
  p as p11,
  q as q5,
  u as u8,
  v as v8
} from "./chunk-44WW37FH.js";
import {
  A as A7,
  E as E7,
  P as P4,
  V,
  c as c6,
  e as e14,
  e2 as e15,
  i as i11,
  r as r12,
  s as s12,
  t as t14,
  t2 as t15
} from "./chunk-6W5CPYUF.js";
import {
  Z as Z4,
  k,
  p as p12
} from "./chunk-FS3REKZ4.js";
import {
  D as D2,
  a as a13,
  a2 as a14,
  c as c5,
  d as d9,
  e as e13,
  g as g6,
  j as j5,
  l as l13,
  m as m9,
  m2 as m10,
  p as p10,
  v as v7,
  x as x6,
  x2 as x7,
  y as y6
} from "./chunk-6NRJP66X.js";
import "./chunk-KDTWVGPE.js";
import "./chunk-YBAOLQVA.js";
import {
  w as w6
} from "./chunk-YK4SWNCN.js";
import {
  C as C3,
  H as H4
} from "./chunk-I2IVJRN2.js";
import "./chunk-X3TCLMHI.js";
import "./chunk-LX3EHQCS.js";
import "./chunk-ELKWN2M6.js";
import {
  a as a15,
  o as o13
} from "./chunk-FGBXDVCJ.js";
import "./chunk-5OCDKMG5.js";
import "./chunk-BU5AMSMP.js";
import "./chunk-KLOEF26H.js";
import {
  r as r11,
  t as t13
} from "./chunk-WGK2FJEK.js";
import {
  A as A6,
  a as a12,
  p as p7,
  s as s11,
  v as v6
} from "./chunk-FXVIA5BW.js";
import "./chunk-DWAZ7HI7.js";
import {
  o as o11
} from "./chunk-WWLBKNPY.js";
import {
  v as v5
} from "./chunk-IJUE2JUP.js";
import "./chunk-URFNTHOE.js";
import {
  E as E5,
  d as d4,
  e as e11,
  f as f7,
  f2 as f8,
  m as m6,
  o as o10,
  y2 as y5
} from "./chunk-7ZSUZDMT.js";
import "./chunk-QB3YZMAB.js";
import {
  s as s9
} from "./chunk-OF6PIPJD.js";
import {
  L
} from "./chunk-IMFUUJSK.js";
import "./chunk-5OCLJKTT.js";
import {
  A as A5,
  E as E4,
  S as S3,
  _ as _4,
  a as a11,
  c as c3,
  l as l10
} from "./chunk-5SEVEYDG.js";
import {
  B,
  M as M3,
  b as b5,
  h as h7,
  l as l8,
  m as m5,
  v as v4
} from "./chunk-77RDPZ67.js";
import {
  T as T2
} from "./chunk-ZNZ4EIIF.js";
import {
  g as g4
} from "./chunk-MQZ56CH5.js";
import "./chunk-KBM2LGNP.js";
import {
  e as e10,
  o as o9,
  t as t9
} from "./chunk-HP6QT5KY.js";
import "./chunk-OPS2DUBP.js";
import "./chunk-PNLWREZJ.js";
import {
  h as h9,
  t as t8
} from "./chunk-WEBU4A2Q.js";
import "./chunk-QFWDN2OM.js";
import "./chunk-372DRRBO.js";
import "./chunk-X7GQR2IY.js";
import {
  e as e12,
  t as t10
} from "./chunk-6WTG5RYO.js";
import {
  B as B2,
  E as E2,
  S as S2,
  d2 as d5,
  e as e9,
  h as h10,
  o2 as o7,
  r2 as r10,
  u as u5,
  x as x5
} from "./chunk-HNRPDSCT.js";
import "./chunk-ZSBQER52.js";
import "./chunk-GDICPMRK.js";
import "./chunk-BW4YO4QD.js";
import "./chunk-S6WNSMC7.js";
import "./chunk-JPRTIOCM.js";
import "./chunk-AMNM3DGI.js";
import "./chunk-RNRS2JL4.js";
import {
  h as h8
} from "./chunk-SBPLVEUA.js";
import "./chunk-3IISYLTT.js";
import "./chunk-7QNA4ADD.js";
import "./chunk-FGA4AGTH.js";
import "./chunk-6ZCPLPAF.js";
import "./chunk-XTFH7327.js";
import {
  W,
  _ as _3,
  a as a10,
  h as h11,
  l as l9,
  s as s8
} from "./chunk-MOPTUDCV.js";
import "./chunk-6VLXCUNV.js";
import {
  i as i8,
  n as n9
} from "./chunk-D2XA6Z6P.js";
import {
  o as o8
} from "./chunk-MYQCUAHK.js";
import {
  E2 as E3
} from "./chunk-O4DPVR3F.js";
import "./chunk-MATM5L52.js";
import "./chunk-4OM3EX6P.js";
import "./chunk-YJIITZRY.js";
import "./chunk-ZSZHMQBF.js";
import "./chunk-MIXBH4EM.js";
import "./chunk-L7GGOP5S.js";
import "./chunk-C6PUUIY2.js";
import "./chunk-33T2SX6R.js";
import "./chunk-TGHV3HKU.js";
import "./chunk-HT2GXPWH.js";
import "./chunk-BQL7VXQR.js";
import "./chunk-735C75BI.js";
import {
  t as t7
} from "./chunk-ZLTZ3KAT.js";
import {
  H as H2,
  Y as Y2,
  _ as _2,
  p2 as p5,
  q as q3
} from "./chunk-ZX55SO5Y.js";
import {
  b as b4,
  c as c2,
  d as d3,
  e as e7,
  f as f6,
  h as h6,
  i as i7,
  o as o6,
  p as p4,
  t as t6
} from "./chunk-FCIHN4UG.js";
import "./chunk-A22ACVMF.js";
import {
  O as O2
} from "./chunk-RUM3DXFX.js";
import "./chunk-5ZAWCTS6.js";
import "./chunk-X6GHUY4U.js";
import {
  E,
  F as F3,
  I as I2,
  R as R2
} from "./chunk-3OFVLRSL.js";
import "./chunk-4NNECS4K.js";
import "./chunk-UWKVAZQ6.js";
import "./chunk-XP6I2GEX.js";
import {
  g as g3,
  l as l5
} from "./chunk-4M35HEAB.js";
import {
  i as i6
} from "./chunk-67RD6CZ4.js";
import {
  Q
} from "./chunk-NGFMX3UT.js";
import "./chunk-XFDO4CMR.js";
import {
  e as e6,
  o as o4,
  t as t5
} from "./chunk-IVLBGTXL.js";
import {
  e as e5
} from "./chunk-GHN7C53L.js";
import "./chunk-XLJB6BCW.js";
import "./chunk-CNM6M4B2.js";
import {
  P as P2,
  d as d8,
  f as f10,
  i as i10,
  l as l11,
  m as m7,
  m2 as m8
} from "./chunk-DYOXDMFD.js";
import {
  c as c4
} from "./chunk-OFXOSNPT.js";
import "./chunk-IMBIE27L.js";
import {
  p as p8
} from "./chunk-2NKIENHY.js";
import {
  E as E6,
  l as l12,
  p as p9
} from "./chunk-2J2YGTXG.js";
import "./chunk-I4YZGF7W.js";
import {
  d as d7,
  f as f9,
  g as g5,
  i as i9,
  s as s10,
  u as u6
} from "./chunk-C6BDJNUQ.js";
import {
  t as t11
} from "./chunk-2GNI5SZ3.js";
import {
  t as t12,
  u as u7
} from "./chunk-KXA4TECI.js";
import "./chunk-Y3Q6KWWE.js";
import "./chunk-VHXWATHW.js";
import "./chunk-UDYHZLTE.js";
import "./chunk-4JNOVZUK.js";
import "./chunk-OJ2HHY2O.js";
import {
  a as a9
} from "./chunk-ZNRXLY4R.js";
import "./chunk-RG3AHHRL.js";
import {
  d2 as d6
} from "./chunk-O7LTV6XN.js";
import "./chunk-4TWWY75O.js";
import "./chunk-SQSR6K2M.js";
import {
  p as p6,
  q as q4,
  y as y4
} from "./chunk-UAJ2SDPQ.js";
import {
  A as A4,
  M as M2,
  a as a8,
  b as b3,
  f as f5,
  j as j4,
  l as l6,
  o as o5,
  r as r8,
  s as s6,
  v as v3,
  w as w5
} from "./chunk-75RMBUYZ.js";
import "./chunk-TWJNUVV2.js";
import "./chunk-IZUZZJS7.js";
import "./chunk-TM6KXMYT.js";
import "./chunk-7CB5BEGB.js";
import "./chunk-QGJM2PN7.js";
import {
  e as e8
} from "./chunk-EGV5SNBD.js";
import "./chunk-LT5KLTS5.js";
import "./chunk-SERWCSJG.js";
import {
  l as l7
} from "./chunk-MFXTPFHI.js";
import "./chunk-RW4M3CI3.js";
import {
  n as n8
} from "./chunk-ZEEU5HOK.js";
import {
  An,
  Xn,
  gn,
  jn,
  pe,
  pn,
  xn
} from "./chunk-FFVIDMFN.js";
import {
  r as r9,
  s as s7
} from "./chunk-ZN2ROKCE.js";
import "./chunk-NWBHRPMR.js";
import "./chunk-IIUWTGWW.js";
import "./chunk-K6AYGXUT.js";
import "./chunk-BHXTNOEK.js";
import "./chunk-IS4TIT4N.js";
import "./chunk-I4RYNNL6.js";
import "./chunk-NCONZRBI.js";
import "./chunk-A4HIS5ZJ.js";
import "./chunk-GLGOVVCK.js";
import "./chunk-BUVDI6S7.js";
import "./chunk-N43PI2UO.js";
import {
  n as n7
} from "./chunk-O6VYMEIX.js";
import {
  e as e4,
  r as r7
} from "./chunk-NDQ5FHGV.js";
import {
  j as j3
} from "./chunk-HUQX7WZO.js";
import "./chunk-ZWUEORSX.js";
import "./chunk-FMJZBZWF.js";
import {
  u as u2
} from "./chunk-GOYVJTGW.js";
import "./chunk-ZPYDYUP5.js";
import "./chunk-36I5ESAQ.js";
import "./chunk-CYI2FLSH.js";
import "./chunk-TDV3ZXCQ.js";
import "./chunk-XJCUKRCO.js";
import "./chunk-SOEQPPQP.js";
import "./chunk-22F6X66Z.js";
import "./chunk-AIDV7EKX.js";
import "./chunk-FZQZIM7U.js";
import {
  x as x4
} from "./chunk-YM6PUX7G.js";
import "./chunk-QEYOWTXD.js";
import "./chunk-CZBRZ6SU.js";
import "./chunk-KDO6J2FO.js";
import {
  I,
  R,
  b as b2,
  c,
  f as f4,
  g as g2,
  h as h5,
  i as i4,
  m as m4,
  n as n6,
  q as q2,
  r as r6,
  s as s5,
  u as u4,
  x as x3
} from "./chunk-RT3T2K4S.js";
import {
  $,
  Z,
  u as u3,
  ue
} from "./chunk-WJCI2CGX.js";
import {
  a as a7,
  d as d2
} from "./chunk-REIQNAQW.js";
import "./chunk-J6LQZWZI.js";
import "./chunk-OD3FDQCI.js";
import "./chunk-J2PJNRU7.js";
import "./chunk-56SPM3WK.js";
import {
  A as A3,
  M,
  Y,
  Z as Z2,
  a as a6,
  p as p3
} from "./chunk-XMZAPOBR.js";
import "./chunk-BLJKKR5D.js";
import "./chunk-ZGNCYHMZ.js";
import "./chunk-X2S4RQJ4.js";
import "./chunk-FUPLN7UM.js";
import "./chunk-376OPXM4.js";
import "./chunk-DER356EU.js";
import "./chunk-MZIWIEIR.js";
import "./chunk-TQEOEDAZ.js";
import "./chunk-SHFHZMHO.js";
import {
  d,
  i as i3,
  l as l4,
  p as p2,
  x as x2,
  y as y3
} from "./chunk-NRP45AHD.js";
import "./chunk-IWQ7452U.js";
import "./chunk-NAN5J6QS.js";
import "./chunk-B4DKBAM3.js";
import {
  F as F2,
  w as w4
} from "./chunk-6M2AHKYV.js";
import "./chunk-SZIJNKCV.js";
import "./chunk-6O43OEU5.js";
import "./chunk-J2K7ZDSV.js";
import "./chunk-2UML3WQZ.js";
import {
  i as i5
} from "./chunk-KXVMEIWT.js";
import {
  j as j2
} from "./chunk-UDND2Z3V.js";
import {
  s as s4
} from "./chunk-23Y3DIC6.js";
import "./chunk-JUVQV3R3.js";
import {
  l
} from "./chunk-RAX2HD42.js";
import "./chunk-ZYRIJWLX.js";
import {
  a as a3,
  b,
  i as i2,
  m
} from "./chunk-C5H57NTD.js";
import {
  A,
  F,
  G,
  H,
  O,
  P,
  S,
  T,
  U,
  _,
  e as e2,
  g,
  j,
  o as o2,
  p,
  q,
  r as r3,
  s as s2,
  u,
  v,
  x,
  z
} from "./chunk-3LR5O4WA.js";
import {
  D,
  a as a2,
  r as r4
} from "./chunk-GDVNKPJ7.js";
import {
  f,
  n as n2,
  r as r2,
  t as t2
} from "./chunk-D4V6J5BT.js";
import "./chunk-OSHI574D.js";
import "./chunk-YWAQYJRC.js";
import "./chunk-B356PXLT.js";
import "./chunk-EHPBHJYZ.js";
import {
  h as h3,
  m2 as m3
} from "./chunk-3MNMDUQZ.js";
import {
  w as w2
} from "./chunk-UWG37XSU.js";
import "./chunk-LNZAOBFW.js";
import "./chunk-PF5I4XZQ.js";
import "./chunk-HLM6QCL2.js";
import "./chunk-RXYULINL.js";
import {
  U as U2,
  a as a5,
  f as f3,
  h as h4,
  l as l3,
  w as w3
} from "./chunk-5NXILPDI.js";
import {
  n as n5
} from "./chunk-THVR7IAM.js";
import "./chunk-ZWJJTUFL.js";
import "./chunk-XQN7F674.js";
import "./chunk-DMI7A7TC.js";
import "./chunk-ZHAW7FZS.js";
import "./chunk-KAN4HXCG.js";
import "./chunk-4FEGON7M.js";
import {
  s as s3
} from "./chunk-VWYWOOPX.js";
import "./chunk-M5VHU5LK.js";
import "./chunk-CXFRNDG4.js";
import {
  l as l2
} from "./chunk-7QMMKGW4.js";
import {
  A as A2,
  e as e3,
  h as h2,
  m as m2,
  n as n3,
  n2 as n4,
  o as o3,
  r as r5,
  t as t3,
  t5 as t4,
  y as y2
} from "./chunk-OOLCFNXJ.js";
import "./chunk-6KZ2LTDA.js";
import "./chunk-U2XHEJM7.js";
import {
  f as f2
} from "./chunk-MJXQTGI2.js";
import "./chunk-LIZHLHNA.js";
import {
  a as a4
} from "./chunk-BTUHYGXO.js";
import "./chunk-UA3YPL2R.js";
import {
  has
} from "./chunk-HVKDYDPP.js";
import {
  v as v2
} from "./chunk-6QC7MLLS.js";
import {
  a,
  e,
  h,
  i,
  n,
  o,
  r,
  s,
  t,
  w,
  y
} from "./chunk-MIHB3CIK.js";
import "./chunk-OL3AADLO.js";

// node_modules/@arcgis/core/libs/maquette/h.js
var e17 = (e21) => ({ vnodeSelector: "", properties: void 0, children: void 0, text: e21.toString(), domNode: null });
var r15 = (t24, o18, n20) => {
  for (let l21 = 0, i21 = o18.length; l21 < i21; l21++) {
    let i22 = o18[l21];
    Array.isArray(i22) ? r15(t24, i22, n20) : null != i22 && false !== i22 && ("string" == typeof i22 && (i22 = e17(i22)), n20.push(i22));
  }
};
function t16(e21, t24, o18) {
  if (Array.isArray(t24))
    o18 = t24, t24 = void 0;
  else if (t24 && ("string" == typeof t24 || t24.hasOwnProperty("vnodeSelector")) || o18 && ("string" == typeof o18 || o18.hasOwnProperty("vnodeSelector")))
    throw new Error("h called with invalid arguments");
  let n20, l21;
  return o18 && 1 === o18.length && "string" == typeof o18[0] ? n20 = o18[0] : o18 && (l21 = [], r15(e21, o18, l21), 0 === l21.length && (l21 = void 0)), { vnodeSelector: e21, properties: t24, children: l21, text: "" === n20 ? void 0 : n20, domNode: null };
}

// node_modules/@arcgis/core/views/overlay/TextOverlayItem.js
var l16 = { bottom: "esri-text-overlay-item-anchor-bottom", "bottom-right": "esri-text-overlay-item-anchor-bottom-right", "bottom-left": "esri-text-overlay-item-anchor-bottom-left", top: "esri-text-overlay-item-anchor-top", "top-right": "esri-text-overlay-item-anchor-top-right", "top-left": "esri-text-overlay-item-anchor-top-left", center: "esri-text-overlay-item-anchor-center", right: "esri-text-overlay-item-anchor-right", left: "esri-text-overlay-item-anchor-left" };
var n11 = class extends m2 {
  constructor(t24) {
    super(t24), this.x = 0, this.y = 0, this.text = "-", this.fontSize = 14, this.anchor = "center", this.visible = true, this.backgroundColor = new l([0, 0, 0, 0.6]), this.textColor = new l([255, 255, 255]), this._textShadowSize = 1;
  }
  get position() {
    return [this.x, this.y];
  }
  set position(t24) {
    this._set("x", t24[0]), this._set("y", t24[1]);
  }
  get _textShadowColor() {
    return this.backgroundColor;
  }
  get _textShadow() {
    const t24 = this._textShadowColor.toCss(false);
    return `0 0 ${this._textShadowSize}px ${t24}`;
  }
  get _padding() {
    return 0.5 * this.fontSize;
  }
  get _borderRadius() {
    return this._padding;
  }
  render() {
    return t16("div", { classes: this._cssClasses(), styles: { left: Math.floor(this.x) + "px", top: Math.floor(this.y) + "px", visibility: this.visible ? "visible" : "hidden", fontSize: this.fontSize + "px", lineHeight: this.fontSize + "px", backgroundColor: this.backgroundColor.toCss(true), color: this.textColor.toCss(true), padding: this._padding + "px", borderRadius: this._borderRadius + "px", textShadow: this._textShadow } }, [this.text]);
  }
  renderCanvas(t24) {
    if (!this.visible)
      return;
    const e21 = t24.font.replace(/^(.*?)px/, "");
    t24.font = `${this.fontSize}px ${e21}`;
    const o18 = this._padding, i21 = this._borderRadius, r22 = t24.measureText(this.text).width, s19 = this.fontSize, l21 = h15[this.anchor];
    t24.textAlign = "center", t24.textBaseline = "middle";
    const n20 = r22 + 2 * o18, a25 = s19 + 2 * o18, x19 = this.x + l21.x * n20, p23 = this.y + l21.y * a25;
    this._roundedRect(t24, x19, p23, n20, a25, i21), t24.fillStyle = this.backgroundColor.toCss(true), t24.fill();
    const d19 = this.x + (l21.x + 0.5) * n20, c16 = this.y + (l21.y + 0.5) * a25;
    this._renderTextShadow(t24, this.text, d19, c16), t24.fillStyle = this.textColor.toCss(true), t24.fillText(this.text, d19, c16);
  }
  _renderTextShadow(t24, e21, o18, i21) {
    t24.lineJoin = "miter", t24.fillStyle = `rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1 / a17.length})`;
    const r22 = this._textShadowSize;
    for (const [s19, l21] of a17)
      t24.fillText(e21, o18 + r22 * s19, i21 + r22 * l21);
  }
  _roundedRect(t24, e21, o18, i21, r22, s19) {
    t24.beginPath(), t24.moveTo(e21, o18 + s19), t24.arcTo(e21, o18, e21 + s19, o18, s19), t24.lineTo(e21 + i21 - s19, o18), t24.arcTo(e21 + i21, o18, e21 + i21, o18 + s19, s19), t24.lineTo(e21 + i21, o18 + r22 - s19), t24.arcTo(e21 + i21, o18 + r22, e21 + i21 - s19, o18 + r22, s19), t24.lineTo(e21 + s19, o18 + r22), t24.arcTo(e21, o18 + r22, e21, o18 + r22 - s19, s19), t24.closePath();
  }
  _cssClasses() {
    const t24 = { "esri-text-overlay-item": true };
    for (const e21 in l16)
      t24[l16[e21]] = this.anchor === e21;
    return t24;
  }
};
e3([y2()], n11.prototype, "x", void 0), e3([y2()], n11.prototype, "y", void 0), e3([y2()], n11.prototype, "position", null), e3([y2()], n11.prototype, "text", void 0), e3([y2()], n11.prototype, "fontSize", void 0), e3([y2()], n11.prototype, "anchor", void 0), e3([y2()], n11.prototype, "visible", void 0), e3([y2()], n11.prototype, "backgroundColor", void 0), e3([y2()], n11.prototype, "textColor", void 0), e3([y2()], n11.prototype, "_textShadowSize", void 0), e3([y2()], n11.prototype, "_textShadowColor", null), e3([y2()], n11.prototype, "_textShadow", null), e3([y2()], n11.prototype, "_padding", null), e3([y2()], n11.prototype, "_borderRadius", null), n11 = e3([n4("esri.views.overlay.TextOverlayItem")], n11);
var h15 = { bottom: { x: -0.5, y: -1, textAlign: "center", textBaseline: "bottom" }, "bottom-left": { x: 0, y: -1, textAlign: "left", textBaseline: "bottom" }, "bottom-right": { x: -1, y: -1, textAlign: "right", textBaseline: "bottom" }, center: { x: -0.5, y: -0.5, textAlign: "center", textBaseline: "middle" }, left: { x: 0, y: -0.5, textAlign: "left", textBaseline: "middle" }, right: { x: -1, y: -0.5, textAlign: "right", textBaseline: "middle" }, top: { x: -0.5, y: 0, textAlign: "center", textBaseline: "top" }, "top-left": { x: 0, y: 0, textAlign: "left", textBaseline: "top" }, "top-right": { x: -1, y: 0, textAlign: "right", textBaseline: "top" } };
var a17 = [];
{
  const t24 = 16;
  for (let e21 = 0; e21 < 360; e21 += 360 / t24)
    a17.push([Math.cos(Math.PI * e21 / 180), Math.sin(Math.PI * e21 / 180)]);
}
var x9 = n11;

// node_modules/@arcgis/core/views/interactive/SegmentLabels.js
var S4 = 3025;
var w8 = { default: 15, far: 25 };
var P5 = class extends m2 {
  constructor(e21) {
    super(e21), this.context = null, this.stagedVertex = null, this.visible = true, this.edgeDistance = "default", this._messagesUnits = null, this._labelInfos = [], this._nextLabelIndex = 0;
  }
  initialize() {
    const e21 = j3(async (e22) => {
      const t25 = await u2("esri/core/t9n/Units");
      f2(e22), this._messagesUnits = t25;
    }), t24 = () => o(this.context, (e22) => e22.editGeometryOperations);
    this.addHandles([l3(() => [r(this.context) && this.getCameraOrExtent(this.context), this.visible, this._edgeDistancePixels, this.stagedVertex, this._messagesUnits], () => this._update()), ...["vertex-add", "vertex-update", "vertex-remove"].map((e22) => a5(t24, e22, () => this._update())), n3(() => e21.abort())]);
  }
  destroy() {
    for (this._nextLabelIndex = 0; this._labelInfos.length; )
      this._destroyLabel(this._labelInfos.pop());
  }
  get updating() {
    return t(this._messagesUnits);
  }
  get test() {
    return { labelContents: this._labelInfos.slice(0, this._nextLabelIndex).map((e21) => e21.label.text) };
  }
  get _edgeDistancePixels() {
    return w8[this.edgeDistance];
  }
  _update() {
    this._nextLabelIndex = 0;
    const e21 = this.context;
    if (t(e21))
      return void this._destroyUnusedLabels();
    const { components: t24, geometry: s19, coordinateHelper: o18 } = e21.editGeometryOperations.data;
    if (!s19)
      return void this._destroyUnusedLabels();
    const a25 = t24.length;
    for (let i21 = 0; i21 < a25; ++i21) {
      const n20 = [];
      if (t24[i21].iterateVertices((e22) => {
        n20.push(o18.toXYZ(e22.pos));
      }), 0 === i21 && r(this.stagedVertex) && n20.push(o18.toXYZ(this.stagedVertex)), n20.length < 2)
        continue;
      const l21 = n20[0], c16 = n20[n20.length - 1];
      "polygon" === s19.type && n20.length > 2 && !G(l21, c16) && n20.push(l21);
      const p23 = 1 === a25 && !h3(n20, false, false);
      let h26 = C6, d19 = G4;
      this.toScreenPointArray(e21, l21, h26);
      for (let t25 = 1; t25 < n20.length; ++t25) {
        const s20 = n20[t25 - 1], o19 = n20[t25];
        this.toScreenPointArray(e21, o19, d19), this._addLabel(e21, s20, h26, o19, d19, p23), [h26, d19] = [d19, h26];
      }
    }
    this._destroyUnusedLabels();
  }
  _addLabel(e21, t24, s19, o18, i21, a25) {
    const { label: n20 } = this._getOrCreateLabel(e21);
    if (!this.visible || b3(s19, i21) < S4)
      return void (n20.visible = false);
    const c16 = r(e21.graphicState) ? e21.graphicState.isDraped ? "on-the-ground" : "absolute-height" : i9(e21.editGeometryOperations.data.geometry, e21.elevationInfo), { spatialReference: p23 } = e21.editGeometryOperations.data, h26 = d9(t24, o18, p23, c16), m21 = this._messagesUnits, u15 = ue(e21.view);
    n20.text = r(m21) && r(h26) ? x6(m21, h26, u15) : "", n20.visible = true;
    const v16 = i21[0] - s19[0], j14 = i21[1] - s19[1];
    a25 ? r8(V2, -j14, v16) : r8(V2, j14, -v16), v3(V2, V2), l6(V2, V2, this._edgeDistancePixels), A4(k3, s19, i21, 0.5), s6(k3, k3, V2), n20.position = [k3[0], k3[1]], Math.abs(V2[0]) > Math.abs(V2[1]) ? n20.anchor = V2[0] > 0 ? "left" : "right" : n20.anchor = -V2[1] < 0 ? "top" : "bottom";
  }
  _getOrCreateLabel(e21) {
    if (this._labelInfos.length > this._nextLabelIndex)
      return this._labelInfos[this._nextLabelIndex++];
    const t24 = new x9({ fontSize: 10, anchor: "center" });
    e21.view.overlay.items.add(t24);
    const s19 = { label: t24 };
    return this._labelInfos.push(s19), this._nextLabelIndex = this._labelInfos.length, s19;
  }
  _destroyUnusedLabels() {
    for (; this._labelInfos.length > this._nextLabelIndex; )
      this._destroyLabel(this._labelInfos.pop());
  }
  _destroyLabel({ label: e21 }) {
    o(this.context, (t24) => t24.view.overlay.items.remove(e21)), e21.destroy();
  }
};
e3([y2()], P5.prototype, "context", void 0), e3([y2()], P5.prototype, "stagedVertex", void 0), e3([y2()], P5.prototype, "visible", void 0), e3([y2()], P5.prototype, "edgeDistance", void 0), e3([y2()], P5.prototype, "updating", null), e3([y2()], P5.prototype, "_messagesUnits", void 0), e3([y2()], P5.prototype, "_edgeDistancePixels", null), P5 = e3([n4("esri.views.interactive")], P5);
var V2 = n8();
var k3 = n8();
var C6 = i3();
var G4 = i3();

// node_modules/@arcgis/core/views/3d/interactive/SegmentLabels3D.js
var a18 = class extends P5 {
  getCameraOrExtent({ view: e21 }) {
    return e21.state.camera;
  }
  toScreenPointArray({ view: e21, elevationInfo: t24, editGeometryOperations: o18 }, s19, a25 = i3()) {
    const { spatialReference: m21 } = o18.data.coordinateHelper;
    return d8(s19, m21, t24, e21, c9), e21.state.camera.projectToScreen(c9, a25), a25;
  }
};
a18 = e3([n4("esri.views.3d.interactive.SegmentLabels3D")], a18);
var c9 = n2();

// node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js
var t17 = class {
  constructor(t24) {
    this._attached = false, this._resourcesCreated = false, this._visible = true, this.view = t24, this._handle = l3(() => this.view.ready, (e21) => {
      this._resourcesCreated && (e21 ? this._createResources() : this._destroyResources());
    });
  }
  applyProps(e21) {
    let t24 = false;
    for (const s19 in e21)
      s19 in this ? "attached" === s19 ? t24 = e21[s19] : this[s19] = e21[s19] : console.error("Cannot set unknown property", s19);
    this.attached = t24;
  }
  destroy() {
    this.attached = false, this._handle.remove();
  }
  get attached() {
    return this._attached;
  }
  set attached(e21) {
    e21 !== this._attached && this.view._stage && (this._attached = e21, this._attached && !this._resourcesCreated ? this._createResources() : !this._attached && this._resourcesCreated && this._destroyResources());
  }
  get visible() {
    return this._visible;
  }
  set visible(e21) {
    e21 !== this._visible && (this._visible = e21, this.attached && this.updateVisibility(e21));
  }
  _createResources() {
    this.createResources(), this._resourcesCreated = true, this.visible || this.updateVisibility(false);
  }
  _destroyResources() {
    this.destroyResources(), this._resourcesCreated = false;
  }
};

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/LaserlinePathTechnique.js
var m14 = class extends e10 {
  initializeProgram(e21) {
    return new o9(e21.rctx, m14.shader.get().build(this.configuration), h16);
  }
  initializePipeline() {
    return W({ blending: s8(R2.ONE, R2.ONE_MINUS_SRC_ALPHA), colorWrite: _3 });
  }
};
m14.shader = new t9(w6, () => import("./LaserlinePath.glsl-SQWGPMBU.js"));
var h16 = /* @__PURE__ */ new Map([[O2.START, 0], [O2.END, 1], [O2.UP, 2], [O2.EXTRUDE, 3]]);

// node_modules/@arcgis/core/views/3d/support/LaserlinePathData.js
var _5 = class {
  constructor(e21) {
    this._renderCoordsHelper = e21, this._buffers = null, this._origin = n2(), this._dirty = false, this._count = 0, this._vao = null;
  }
  set vertices(e21) {
    const t24 = new Float64Array(3 * e21.length);
    let r22 = 0;
    for (const s19 of e21)
      t24[r22++] = s19[0], t24[r22++] = s19[1], t24[r22++] = s19[2];
    this.buffers = [t24];
  }
  set buffers(e21) {
    if (this._buffers = e21, this._buffers.length > 0) {
      const e22 = this._buffers[0], t24 = 3 * Math.floor(e22.length / 3 / 2);
      o2(this._origin, e22[t24 + 0], e22[t24 + 1], e22[t24 + 2]);
    } else
      o2(this._origin, 0, 0, 0);
    this._dirty = true;
  }
  get origin() {
    return this._origin;
  }
  draw(t24) {
    const r22 = this._ensureVAO(t24);
    r(r22) && (t24.bindVAO(r22), t24.drawArrays(E.TRIANGLES, 0, this._count));
  }
  dispose() {
    r(this._vao) && this._vao.dispose();
  }
  _ensureVAO(e21) {
    return t(this._buffers) ? null : (t(this._vao) && (this._vao = this._createVAO(e21, this._buffers)), this._ensureVertexData(this._vao, this._buffers), this._vao);
  }
  _createVAO(e21, t24) {
    const r22 = this._createDataBuffer(t24);
    return this._dirty = false, new r10(e21, h16, { data: o11(V3) }, { data: E3.createVertex(e21, F3.STATIC_DRAW, r22) });
  }
  _ensureVertexData(e21, t24) {
    if (!this._dirty)
      return;
    const r22 = this._createDataBuffer(t24);
    e21.vertexBuffers.data.setData(r22), this._dirty = false;
  }
  _numberOfRenderVertices(e21) {
    return 3 * (2 * (e21.length / 3 - 1));
  }
  _createDataBuffer(e21) {
    const t24 = e21.reduce((e22, t25) => e22 + this._numberOfRenderVertices(t25), 0);
    this._count = t24;
    const i21 = V3.createBuffer(t24), o18 = this._origin;
    let n20 = 0, f18 = 0;
    for (const u15 of e21) {
      for (let e22 = 0; e22 < u15.length; e22 += 3) {
        const t25 = o2(b7, u15[e22 + 0], u15[e22 + 1], u15[e22 + 2]);
        0 === e22 ? f18 = this._renderCoordsHelper.getAltitude(t25) : this._renderCoordsHelper.setAltitude(t25, f18);
        const a25 = this._renderCoordsHelper.worldUpAtPosition(t25, d11), c16 = n20 + 2 * e22, h26 = e2(b7, t25, o18);
        if (e22 < u15.length - 3) {
          i21.up.setVec(c16, a25), i21.up.setVec(c16 + 3, a25), i21.up.setVec(c16 + 5, a25);
          for (let e23 = 0; e23 < 6; e23++)
            i21.start.setVec(c16 + e23, h26);
          i21.extrude.setValues(c16 + 0, 0, -1), i21.extrude.setValues(c16 + 1, 1, -1), i21.extrude.setValues(c16 + 2, 1, 1), i21.extrude.setValues(c16 + 3, 0, -1), i21.extrude.setValues(c16 + 4, 1, 1), i21.extrude.setValues(c16 + 5, 0, 1);
        }
        if (e22 > 0) {
          i21.up.setVec(c16 - 2, a25), i21.up.setVec(c16 - 4, a25), i21.up.setVec(c16 - 5, a25);
          for (let e23 = -6; e23 < 0; e23++)
            i21.end.setVec(c16 + e23, h26);
        }
      }
      n20 += this._numberOfRenderVertices(u15);
    }
    return i21.buffer;
  }
};
var d11 = n2();
var b7 = n2();
var V3 = T2().vec3f(O2.START).vec3f(O2.END).vec3f(O2.UP).vec2f(O2.EXTRUDE);

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/LaserlinePathTechniqueConfiguration.js
var e18 = class extends t10 {
  constructor() {
    super(...arguments), this.contrastControlEnabled = false;
  }
};
e3([e12()], e18.prototype, "contrastControlEnabled", void 0);

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/LaserlineTechnique.js
var f13 = class extends t7 {
  constructor() {
    super(...arguments), this.innerColor = r2(1, 1, 1), this.innerWidth = 1, this.glowColor = r2(1, 0.5, 0), this.glowWidth = 8, this.glowFalloff = 8, this.globalAlpha = 0.75, this.globalAlphaContrastBoost = 2, this.angleCutoff = m(6), this.pointDistanceOrigin = n2(), this.pointDistanceTarget = n2(), this.lineVerticalPlaneSegment = v4(), this.intersectsLineSegment = v4(), this.intersectsLineRadius = 3, this.heightManifoldTarget = n2(), this.lineStartWorld = n2(), this.lineEndWorld = n2();
  }
};
var p15 = class extends e10 {
  initializeProgram(e21) {
    return new o9(e21.rctx, p15.shader.get().build(this.configuration), E2);
  }
  initializePipeline() {
    return W({ blending: s8(R2.ONE, R2.ONE_MINUS_SRC_ALPHA), colorWrite: _3 });
  }
};
p15.shader = new t9(H4, () => import("./Laserlines.glsl-2QQGJUKC.js"));

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/LaserlineTechniqueConfiguration.js
var n12 = class extends e18 {
  constructor() {
    super(...arguments), this.heightManifoldEnabled = false, this.pointDistanceEnabled = false, this.lineVerticalPlaneEnabled = false, this.intersectsLineEnabled = false, this.spherical = false;
  }
};
e3([e12()], n12.prototype, "heightManifoldEnabled", void 0), e3([e12()], n12.prototype, "pointDistanceEnabled", void 0), e3([e12()], n12.prototype, "lineVerticalPlaneEnabled", void 0), e3([e12()], n12.prototype, "intersectsLineEnabled", void 0), e3([e12()], n12.prototype, "spherical", void 0);

// node_modules/@arcgis/core/views/3d/support/LaserLineRenderer.js
var D4 = class {
  constructor(e21, t24 = { contrastControlEnabled: false }) {
    this._config = t24, this._technique = null, this._heightManifoldEnabled = false, this._pointDistanceEnabled = false, this._lineVerticalPlaneEnabled = false, this._intersectsLineEnabled = false, this._intersectsLineInfinite = false, this._viewingMode = l7.Local, this._pathVerticalPlaneEnabled = false, this._pathVerticalPlaneData = null, this._pathTechnique = null, this.canRender = true, this._passParameters = S2(e21, new f13());
  }
  get renderSlots() {
    return [this._config.contrastControlEnabled ? E5.LASERLINES_CONTRAST_CONTROL : E5.LASERLINES];
  }
  get needsLinearDepth() {
    return true;
  }
  get heightManifoldEnabled() {
    return this._heightManifoldEnabled;
  }
  set heightManifoldEnabled(e21) {
    this._heightManifoldEnabled !== e21 && (this._heightManifoldEnabled = e21, this._requestRender());
  }
  get heightManifoldTarget() {
    return this._passParameters.heightManifoldTarget;
  }
  set heightManifoldTarget(e21) {
    r3(this._passParameters.heightManifoldTarget, e21), this._requestRender();
  }
  get pointDistanceEnabled() {
    return this._pointDistanceEnabled;
  }
  set pointDistanceEnabled(e21) {
    e21 !== this._pointDistanceEnabled && (this._pointDistanceEnabled = e21, this._requestRender());
  }
  get pointDistanceTarget() {
    return this._passParameters.pointDistanceTarget;
  }
  set pointDistanceTarget(e21) {
    r3(this._passParameters.pointDistanceTarget, e21), this._requestRender();
  }
  get pointDistanceOrigin() {
    return this._passParameters.pointDistanceOrigin;
  }
  set pointDistanceOrigin(e21) {
    r3(this._passParameters.pointDistanceOrigin, e21), this._requestRender();
  }
  get lineVerticalPlaneEnabled() {
    return this._lineVerticalPlaneEnabled;
  }
  set lineVerticalPlaneEnabled(e21) {
    e21 !== this._lineVerticalPlaneEnabled && (this._lineVerticalPlaneEnabled = e21, this._requestRender());
  }
  get lineVerticalPlaneSegment() {
    return this._passParameters.lineVerticalPlaneSegment;
  }
  set lineVerticalPlaneSegment(e21) {
    h7(e21, this._passParameters.lineVerticalPlaneSegment), this._requestRender();
  }
  get intersectsLineEnabled() {
    return this._intersectsLineEnabled;
  }
  set intersectsLineEnabled(e21) {
    e21 !== this._intersectsLineEnabled && (this._intersectsLineEnabled = e21, this._requestRender());
  }
  get intersectsLineSegment() {
    return this._passParameters.intersectsLineSegment;
  }
  set intersectsLineSegment(e21) {
    h7(e21, this._passParameters.intersectsLineSegment), this._requestRender();
  }
  get intersectsLineRadius() {
    return this._passParameters.intersectsLineRadius;
  }
  set intersectsLineRadius(e21) {
    e21 !== this._passParameters.intersectsLineRadius && (this._passParameters.intersectsLineRadius = e21, this._requestRender());
  }
  get intersectsLineInfinite() {
    return this._intersectsLineInfinite;
  }
  set intersectsLineInfinite(e21) {
    e21 !== this._intersectsLineInfinite && (this._intersectsLineInfinite = e21, this._requestRender());
  }
  get viewingMode() {
    return this._viewingMode;
  }
  set viewingMode(e21) {
    e21 !== this._viewingMode && (this._viewingMode = e21, this._requestRender());
  }
  get pathVerticalPlaneEnabled() {
    return this._pathVerticalPlaneEnabled;
  }
  set pathVerticalPlaneEnabled(t24) {
    t24 !== this._pathVerticalPlaneEnabled && (this._pathVerticalPlaneEnabled = t24, r(this._pathVerticalPlaneData) && this._requestRender());
  }
  set pathVerticalPlaneVertices(e21) {
    t(this._pathVerticalPlaneData) && (this._pathVerticalPlaneData = new _5(this._passParameters.renderCoordsHelper)), this._pathVerticalPlaneData.vertices = e21, this.pathVerticalPlaneEnabled && this._requestRender();
  }
  set pathVerticalPlaneBuffers(e21) {
    t(this._pathVerticalPlaneData) && (this._pathVerticalPlaneData = new _5(this._passParameters.renderCoordsHelper)), this._pathVerticalPlaneData.buffers = e21, this.pathVerticalPlaneEnabled && this._requestRender();
  }
  setParameters(e21) {
    B2(this._passParameters, e21) && this._requestRender();
  }
  initializeRenderContext(e21) {
    this._context = e21;
    const t24 = e21.renderContext.rctx;
    this._quadVAO = u5(t24), this._techniqueRepository = e21.shaderTechniqueRepository, this._techniqueConfig = new n12();
    const i21 = new e18();
    i21.contrastControlEnabled = this._config.contrastControlEnabled, this._pathTechnique = this._techniqueRepository.acquire(m14, i21);
  }
  uninitializeRenderContext() {
    this._quadVAO = a(this._quadVAO), this._technique = w(this._technique), this._pathVerticalPlaneData = a(this._pathVerticalPlaneData), this._pathTechnique = w(this._pathTechnique);
  }
  prepareTechnique() {
    return this.heightManifoldEnabled || this.pointDistanceEnabled || this.lineVerticalPlaneSegment || this.intersectsLineEnabled ? (this._techniqueConfig.heightManifoldEnabled = this.heightManifoldEnabled, this._techniqueConfig.lineVerticalPlaneEnabled = this.lineVerticalPlaneEnabled, this._techniqueConfig.pointDistanceEnabled = this.pointDistanceEnabled, this._techniqueConfig.intersectsLineEnabled = this.intersectsLineEnabled, this._techniqueConfig.contrastControlEnabled = this._config.contrastControlEnabled, this._techniqueConfig.spherical = this._viewingMode === l7.Global, this._technique = this._techniqueRepository.releaseAndAcquire(p15, this._techniqueConfig, this._technique), this._technique) : this._pathTechnique;
  }
  render(e21, t24) {
    (this.heightManifoldEnabled || this.pointDistanceEnabled || this.lineVerticalPlaneSegment || this.intersectsLineEnabled) && this._renderUnified(e21, t24), this.pathVerticalPlaneEnabled && this._renderPath(e21);
  }
  _renderUnified(e21, t24) {
    const i21 = e21.rctx;
    this._updatePassParameters(e21), i21.bindTechnique(t24, this._passParameters, e21.bindParameters), i21.bindVAO(this._quadVAO), i21.drawArrays(E.TRIANGLE_STRIP, 0, 4);
  }
  _renderPath(e21) {
    if (t(this._pathVerticalPlaneData) || t(this._pathTechnique))
      return;
    const i21 = e21.rctx, n20 = this._pathTechnique;
    i21.bindTechnique(n20, { ...this._passParameters, origin: this._pathVerticalPlaneData.origin }, e21.bindParameters), this._pathVerticalPlaneData.draw(e21.rctx);
  }
  _updatePassParameters(e21) {
    if (!this._intersectsLineEnabled)
      return;
    const t24 = e21.bindParameters.camera;
    if (this._intersectsLineInfinite) {
      if (p7(p4(this._passParameters.intersectsLineSegment.origin, this._passParameters.intersectsLineSegment.vector), T5), T5.c0 = -Number.MAX_VALUE, !a12(t24.frustum, T5))
        return;
      v6(T5, this._passParameters.lineStartWorld), A6(T5, this._passParameters.lineEndWorld);
    } else
      r3(this._passParameters.lineStartWorld, this._passParameters.intersectsLineSegment.origin), u(this._passParameters.lineEndWorld, this._passParameters.intersectsLineSegment.origin, this._passParameters.intersectsLineSegment.vector);
  }
  _requestRender() {
    this._context && this._context.requestRender();
  }
};
var T5 = s11();

// node_modules/@arcgis/core/views/3d/interactive/visualElements/LaserlineVisualElement.js
var d12 = class extends t17 {
  constructor(e21) {
    super(e21.view), this._angleCutoff = C3, this._style = {}, this._heightManifoldTarget = n2(), this._heightManifoldEnabled = false, this._intersectsLine = v4(), this._intersectsLineEnabled = false, this._intersectsLineInfinite = false, this._lineVerticalPlaneSegment = null, this._pathVerticalPlaneBuffers = null, this._pointDistanceLine = null, this.applyProps(e21);
  }
  get testData() {
    return this._renderer;
  }
  createResources() {
    this._ensureRenderer();
  }
  destroyResources() {
    this._disposeRenderer();
  }
  updateVisibility() {
    this._syncRenderer(), this._syncHeightManifold(), this._syncIntersectsLine(), this._syncPathVerticalPlane(), this._syncLineVerticalPlane(), this._syncPointDistance();
  }
  get angleCutoff() {
    return this._angleCutoff;
  }
  set angleCutoff(e21) {
    this._angleCutoff !== e21 && (this._angleCutoff = e21, this._syncAngleCutoff());
  }
  get style() {
    return this._style;
  }
  set style(e21) {
    this._style = e21, this._syncStyle();
  }
  get heightManifoldTarget() {
    return this._heightManifoldEnabled ? this._heightManifoldTarget : null;
  }
  set heightManifoldTarget(t24) {
    r(t24) ? (r3(this._heightManifoldTarget, t24), this._heightManifoldEnabled = true) : this._heightManifoldEnabled = false, this._syncRenderer(), this._syncHeightManifold();
  }
  set intersectsWorldUpAtLocation(e21) {
    if (t(e21))
      return void (this.intersectsLine = null);
    const i21 = this.view.renderCoordsHelper.worldUpAtPosition(e21, o14);
    this.intersectsLine = m5(e21, i21), this.intersectsLineInfinite = true;
  }
  get intersectsLine() {
    return this._intersectsLineEnabled ? this._intersectsLine : null;
  }
  set intersectsLine(t24) {
    r(t24) ? (h7(t24, this._intersectsLine), this._intersectsLineEnabled = true) : this._intersectsLineEnabled = false, this._syncIntersectsLine(), this._syncRenderer();
  }
  get intersectsLineInfinite() {
    return this._intersectsLineInfinite;
  }
  set intersectsLineInfinite(e21) {
    this._intersectsLineInfinite = e21, this._syncIntersectsLineInfinite();
  }
  get lineVerticalPlaneSegment() {
    return this._lineVerticalPlaneSegment;
  }
  set lineVerticalPlaneSegment(t24) {
    this._lineVerticalPlaneSegment = r(t24) ? h7(t24) : null, this._syncLineVerticalPlane(), this._syncRenderer();
  }
  get pathVerticalPlane() {
    return this._pathVerticalPlaneBuffers;
  }
  set pathVerticalPlane(e21) {
    this._pathVerticalPlaneBuffers = e21, this._syncPathVerticalPlane(), this._syncLineVerticalPlane(), this._syncPointDistance(), this._syncRenderer();
  }
  get pointDistanceLine() {
    return this._pointDistanceLine;
  }
  set pointDistanceLine(t24) {
    this._pointDistanceLine = r(t24) ? { origin: t2(t24.origin), target: t2(t24.target) } : null, this._syncPointDistance(), this._syncRenderer();
  }
  _syncRenderer() {
    this.attached && this.visible && (this._intersectsLineEnabled || this._heightManifoldEnabled || r(this._pointDistanceLine) || r(this._pathVerticalPlaneBuffers)) ? this._ensureRenderer() : this._disposeRenderer();
  }
  _ensureRenderer() {
    r(this._renderer) || (this._renderer = new D4({ renderCoordsHelper: this.view.renderCoordsHelper }, { contrastControlEnabled: true }), this._renderer.viewingMode = this.view.state.viewingMode, this._syncStyle(), this._syncHeightManifold(), this._syncIntersectsLine(), this._syncIntersectsLineInfinite(), this._syncPathVerticalPlane(), this._syncLineVerticalPlane(), this._syncPointDistance(), this._syncAngleCutoff(), this.view._stage && this.view._stage.addRenderPlugin(this._renderer.renderSlots, this._renderer));
  }
  _syncStyle() {
    t(this._renderer) || (this._renderer.setParameters(this._style), null != this._style.intersectsLineRadius && (this._renderer.intersectsLineRadius = this._style.intersectsLineRadius));
  }
  _syncAngleCutoff() {
    t(this._renderer) || this._renderer.setParameters({ angleCutoff: this._angleCutoff });
  }
  _syncHeightManifold() {
    t(this._renderer) || (this._renderer.heightManifoldEnabled = this._heightManifoldEnabled && this.visible, this._heightManifoldEnabled && (this._renderer.heightManifoldTarget = this._heightManifoldTarget));
  }
  _syncIntersectsLine() {
    t(this._renderer) || (this._renderer.intersectsLineEnabled = this._intersectsLineEnabled && this.visible, this._intersectsLineEnabled && (this._renderer.intersectsLineSegment = this._intersectsLine));
  }
  _syncIntersectsLineInfinite() {
    t(this._renderer) || (this._renderer.intersectsLineInfinite = this._intersectsLineInfinite);
  }
  _syncPathVerticalPlane() {
    t(this._renderer) || (this._renderer.pathVerticalPlaneEnabled = r(this._pathVerticalPlaneBuffers) && this.visible, r(this._pathVerticalPlaneBuffers) && (this._renderer.pathVerticalPlaneBuffers = this._pathVerticalPlaneBuffers));
  }
  _syncLineVerticalPlane() {
    t(this._renderer) || (this._renderer.lineVerticalPlaneEnabled = r(this._lineVerticalPlaneSegment) && this.visible, r(this._lineVerticalPlaneSegment) && (this._renderer.lineVerticalPlaneSegment = this._lineVerticalPlaneSegment));
  }
  _syncPointDistance() {
    t(this._renderer) || (this._renderer.pointDistanceEnabled = r(this._pointDistanceLine) && this.visible, r(this._pointDistanceLine) && (this._renderer.pointDistanceOrigin = this._pointDistanceLine.origin, this._renderer.pointDistanceTarget = this._pointDistanceLine.target));
  }
  _disposeRenderer() {
    r(this._renderer) && this.view._stage && (this.view._stage.removeRenderPlugin(this._renderer), this._renderer = null);
  }
};
var o14 = n2();

// node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js
var n13 = class extends t17 {
  constructor(e21) {
    super(e21.view), this._resources = null, this._transform = e6();
  }
  get object() {
    return r(this._resources) ? this._resources.object : null;
  }
  get transform() {
    return this._transform;
  }
  set transform(s19) {
    n6(this._transform, s19), r(this._resources) && (this._resources.object.transformation = this._transform);
  }
  recreate() {
    this.attached && this.createResources();
  }
  recreateGeometry() {
    if (t(this._resources))
      return;
    const e21 = this._resources.object, r22 = this.view._stage;
    r22.removeMany(e21.geometries), e21.removeAllGeometries(), this.createGeometries(e21), this.visible || e21.setVisible(this.visible), r22.addMany(e21.geometries);
  }
  createResources() {
    this.destroyResources();
    const e21 = this.view._stage;
    if (!e21)
      return;
    const s19 = new l14({ isPickable: false, updatePolicy: i8.SYNC });
    e21.add(s19);
    const r22 = new x8({ castShadow: false });
    r22.transformation = this._transform, this.createExternalResources(), this.createGeometries(r22), e21.addMany(r22.geometries), this.forEachExternalMaterial((s20) => e21.add(s20)), e21.add(r22), s19.add(r22), this.visible || r22.setVisible(false), this._resources = { layer: s19, object: r22 };
  }
  destroyResources() {
    const e21 = this.view._stage;
    !t(this._resources) && e21 && (e21.remove(this._resources.object), e21.remove(this._resources.layer), this.forEachExternalMaterial((s19) => {
      e21.remove(s19), s19.dispose();
    }), e21.removeMany(this._resources.object.geometries), this._resources.object.dispose(), this.destroyExternalResources(), this._resources = null);
  }
  updateVisibility(e21) {
    t(this._resources) || this._resources.object.setVisible(e21);
  }
};

// node_modules/@arcgis/core/views/3d/interactive/visualElements/ExtendedLineVisualElement.js
var G5 = class extends n13 {
  constructor(t24) {
    super(t24), this._ray = d3(), this._externalResources = null, this._handles = new t4(), this._isWorldDown = false, this._start = n2(), this._end = r2(1, 0, 0), this._width = 1, this._color = r11(1, 0, 1, 1), this._polygonOffset = false, this._writeDepthEnabled = true, this._innerWidth = 0, this._innerColor = r11(1, 1, 1, 1), this._stipplePattern = null, this._stippleOffColor = null, this._stipplePreferContinuous = true, this._falloff = 0, this._extensionType = V4.LINE, this._laserlineStyle = null, this._laserlineEnabled = false, this._renderOccluded = o7.OccludeAndTransparent, this._fadedExtensions = F5, this.applyProps(t24);
  }
  createExternalResources() {
    const e21 = new H5(this.materialParameters);
    this._handles.add(l3(() => this.view.state.camera, () => {
      this._updateGeometry();
    }));
    const t24 = new d12({ view: this.view, attached: this._laserlineEnabled });
    this._externalResources = { material: e21, laserline: t24 };
  }
  destroyExternalResources() {
    r(this._externalResources) && this._externalResources.laserline.destroy(), this._externalResources = null, this._handles.removeAll();
  }
  forEachExternalMaterial(e21) {
    r(this._externalResources) && e21(this._externalResources.material);
  }
  createGeometries(e21) {
    const t24 = [n2(), n2()], i21 = this.extensionType === V4.FADED;
    i21 && t24.push(n2(), n2());
    const r22 = i21 ? new Float32Array([1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]) : null, n20 = q6(t24, null, r22);
    e21.addGeometry(n20, e(this._externalResources).material), this._updateVertices(e21);
  }
  updateVisibility(e21) {
    super.updateVisibility(e21), r(this._externalResources) && (this._externalResources.laserline.visible = e21);
  }
  setStartEndFromWorldDownAtLocation(e21) {
    this._isWorldDown = true, r3(this._start, e21), this.view.renderCoordsHelper.worldUpAtPosition(e21, this._end), e2(this._end, e21, this._end), h6(this._start, this._end, this._ray), this._updateGeometry();
  }
  get start() {
    return this._start;
  }
  set start(e21) {
    this._isWorldDown = false, F(this._start, e21) || (r3(this._start, e21), h6(this._start, this._end, this._ray), this._updateGeometry());
  }
  get end() {
    return this._end;
  }
  set end(e21) {
    this._isWorldDown = false, F(this._end, e21) || (r3(this._end, e21), h6(this._start, this._end, this._ray), this._updateGeometry());
  }
  get width() {
    return this._width;
  }
  set width(e21) {
    e21 !== this._width && (this._width = e21, this._updateMaterial());
  }
  get color() {
    return this._color;
  }
  set color(e21) {
    D(e21, this._color) || (a2(this._color, e21), this._updateMaterial());
  }
  get polygonOffset() {
    return this._polygonOffset;
  }
  set polygonOffset(e21) {
    e21 !== this._polygonOffset && (this._polygonOffset = e21, this._updateMaterial());
  }
  get writeDepthEnabled() {
    return this._writeDepthEnabled;
  }
  set writeDepthEnabled(e21) {
    this._writeDepthEnabled !== e21 && (this._writeDepthEnabled = e21, this._updateMaterial());
  }
  get innerWidth() {
    return this._innerWidth;
  }
  set innerWidth(e21) {
    e21 !== this._innerWidth && (this._innerWidth = e21, this._updateMaterial());
  }
  get innerColor() {
    return this._innerColor;
  }
  set innerColor(e21) {
    D(e21, this._innerColor) || (a2(this._innerColor, e21), this._updateMaterial());
  }
  get stipplePattern() {
    return this._stipplePattern;
  }
  set stipplePattern(e21) {
    const s19 = r(e21) !== r(this._stipplePattern);
    this._stipplePattern = e21, s19 ? this.recreate() : this._updateMaterial();
  }
  get stippleOffColor() {
    return this._stippleOffColor;
  }
  set stippleOffColor(e21) {
    (t(e21) || t(this._stippleOffColor) || !D(e21, this._stippleOffColor)) && (this._stippleOffColor = r(e21) ? t13(e21) : null, this._updateMaterial());
  }
  get stipplePreferContinuous() {
    return this._stipplePreferContinuous;
  }
  set stipplePreferContinuous(e21) {
    e21 !== this._stipplePreferContinuous && (this._stipplePreferContinuous = e21, this._updateMaterial());
  }
  get falloff() {
    return this._falloff;
  }
  set falloff(e21) {
    e21 !== this._falloff && (this._falloff = e21, this._updateMaterial());
  }
  get extensionType() {
    return this._extensionType;
  }
  set extensionType(e21) {
    e21 !== this._extensionType && (this._extensionType = e21, this._updateGeometry());
  }
  get _laserlineAttached() {
    return this._laserlineEnabled && r(this._laserlineStyle);
  }
  get laserlineStyle() {
    return this._laserlineStyle;
  }
  set laserlineStyle(e21) {
    this._laserlineStyle = e21, r(this._externalResources) && (this._externalResources.laserline.attached = this._laserlineAttached, r(e21) && (this._externalResources.laserline.style = e21));
  }
  get laserlineEnabled() {
    return this._laserlineEnabled;
  }
  set laserlineEnabled(e21) {
    this._laserlineEnabled !== e21 && (this._laserlineEnabled = e21, r(this._externalResources) && (this._externalResources.laserline.attached = this._laserlineAttached));
  }
  get renderOccluded() {
    return this._renderOccluded;
  }
  set renderOccluded(e21) {
    e21 !== this._renderOccluded && (this._renderOccluded = e21, this._updateMaterial());
  }
  get fadedExtensions() {
    return this._fadedExtensions;
  }
  set fadedExtensions(e21) {
    this._fadedExtensions = i(e21, F5), this.recreateGeometry();
  }
  _updateMaterial() {
    if (t(this._externalResources))
      return;
    this._externalResources.material.setParameters(this.materialParameters);
  }
  get materialParameters() {
    return { width: this._width, color: this._color, stippleOffColor: this._stippleOffColor, stipplePattern: this._stipplePattern, stipplePreferContinuous: this._stipplePreferContinuous, innerWidth: this._innerWidth, innerColor: this._innerColor, falloff: this._falloff, hasPolygonOffset: this._polygonOffset, renderOccluded: this._renderOccluded, writeDepth: this._writeDepthEnabled };
  }
  _updateGeometry() {
    r(this.object) && this._updateVertices(this.object);
  }
  _updateVertices(e21) {
    const s19 = this._extensionType === V4.FADED ? this._updateLineSegmentFinite(T6) : this._updateLineSegmentInfinite(this._extensionType, T6);
    this._updateVertexAttributes(e21, s19), r(this._externalResources) && (this._externalResources.laserline.intersectsLine = s19);
  }
  _updateLineSegmentFinite(e21) {
    return b5(this._start, this._end, e21);
  }
  _updateLineSegmentInfinite(e21, t24) {
    const s19 = this.view.state.camera;
    switch (p7(this._ray, W2), e21) {
      case V4.LINE:
        W2.c0 = -Number.MAX_VALUE;
        break;
      case V4.RAY:
      case V4.GROUND_RAY: {
        const e22 = this._ray.origin, t25 = i(this.view.elevationProvider.getElevation(e22[0], e22[1], e22[2], this.view.renderCoordsHelper.spatialReference, "ground"), 0), s20 = this.view.renderCoordsHelper.getAltitude(e22);
        this._isWorldDown && s20 < t25 && j(W2.ray.direction, W2.ray.direction), this._extensionType === V4.GROUND_RAY && null != t25 && (W2.c1 = Math.abs(s20 - t25));
        break;
      }
    }
    if (!a12(s19.frustum, W2))
      return b5(this._start, this._end, t24);
    const i21 = v6(W2, L2), n20 = A6(W2, S5);
    return b5(i21, n20, t24);
  }
  _updateVertexAttributes(e21, t24) {
    const s19 = e21.geometries[0].getMutableAttribute(O2.POSITION).data;
    if (this.extensionType === V4.FADED) {
      const e22 = l8(t24, -this.fadedExtensions.start, L2);
      s19[0] = e22[0], s19[1] = e22[1], s19[2] = e22[2];
      const i21 = l8(t24, 0, L2);
      s19[3] = i21[0], s19[4] = i21[1], s19[5] = i21[2];
      const r22 = l8(t24, 1, L2);
      s19[6] = r22[0], s19[7] = r22[1], s19[8] = r22[2];
      const n20 = l8(t24, 1 + this.fadedExtensions.end, L2);
      s19[9] = n20[0], s19[10] = n20[1], s19[11] = n20[2];
    } else {
      const e22 = l8(t24, 0, L2);
      s19[0] = e22[0], s19[1] = e22[1], s19[2] = e22[2];
      const i21 = l8(t24, 1, L2);
      s19[3] = i21[0], s19[4] = i21[1], s19[5] = i21[2];
    }
    e21.geometryVertexAttrsUpdated(e21.geometryRecords[0]);
  }
};
var W2 = s11();
var L2 = n2();
var S5 = n2();
var T6 = v4();
var V4;
!function(e21) {
  e21[e21.LINE = 0] = "LINE", e21[e21.RAY = 1] = "RAY", e21[e21.GROUND_RAY = 2] = "GROUND_RAY", e21[e21.FADED = 3] = "FADED";
}(V4 || (V4 = {}));
var N = 1 / 3;
var F5 = { start: N, end: N };

// node_modules/@arcgis/core/views/3d/interactive/visualElements/ParallelLineVisualElement.js
var v10 = class extends n13 {
  constructor(t24) {
    super(t24), this._handles = new t4(), this._location = n2(), this._direction = r2(1, 0, 0), this._width = 1, this._offset = 1, this._length = 18, this._color = r11(1, 0, 1, 1), this._renderOccluded = o7.OccludeAndTransparent, this.applyProps(t24);
  }
  get location() {
    return this._location;
  }
  set location(e21) {
    F(this._location, e21) || (r3(this._location, e21), this._updateGeometry());
  }
  get direction() {
    return this._direction;
  }
  set direction(e21) {
    F(this._direction, e21) || (r3(this._direction, e21), this._updateGeometry());
  }
  setDirectionFromPoints(e21, t24) {
    z(this._direction, e2(this._direction, t24, e21)), this._updateGeometry();
  }
  get width() {
    return this._width;
  }
  set width(e21) {
    e21 !== this._width && (this._width = e21, this._updateMaterial());
  }
  get offset() {
    return this._offset;
  }
  set offset(e21) {
    e21 !== this._offset && (this._offset = e21, this._updateGeometry());
  }
  get length() {
    return this._length;
  }
  set length(e21) {
    e21 !== this._length && (this._length = e21, this._updateGeometry());
  }
  get color() {
    return this._color;
  }
  set color(e21) {
    D(e21, this._color) || (a2(this._color, e21), this._updateMaterial());
  }
  get renderOccluded() {
    return this._renderOccluded;
  }
  set renderOccluded(e21) {
    e21 !== this._renderOccluded && (this._renderOccluded = e21, this._updateMaterial());
  }
  createExternalResources() {
    const e21 = new H5(this.materialParameters);
    this._handles.add(l3(() => this.view.state.camera, () => {
      this._updateGeometry();
    })), this._externalResources = { material: e21 };
  }
  destroyExternalResources() {
    this._handles.removeAll(), this._externalResources = null;
  }
  createGeometries(e21) {
    const r22 = q6([n2(), n2()]), s19 = q6([n2(), n2()]), i21 = e(this._externalResources).material;
    e21.addGeometry(r22, i21), e21.addGeometry(s19, i21), this._updateVertices(e21);
  }
  forEachExternalMaterial(e21) {
    r(this._externalResources) && e21(this._externalResources.material);
  }
  _updateMaterial() {
    if (t(this._externalResources))
      return;
    this._externalResources.material.setParameters(this.materialParameters);
  }
  get materialParameters() {
    return { width: this._width, color: this._color, renderOccluded: this._renderOccluded };
  }
  _updateGeometry() {
    const e21 = this.object;
    t(e21) || this._updateVertices(e21);
  }
  _updateVertices(e21) {
    const t24 = this.view.state.camera;
    t24.projectToScreen(this.location, A9), u(V5, this.location, this.direction), t24.projectToScreen(V5, M5), v3(M5, o5(M5, M5, A9)), this._updateVertexAttributes(t24, e21, 0, A9, M5, 1), this._updateVertexAttributes(t24, e21, 1, A9, M5, -1);
  }
  _updateVertexAttributes(e21, t24, r22, s19, i21, o18) {
    const a25 = t24.geometryRecords[r22], c16 = a25.geometry.getMutableAttribute(O2.POSITION).data, d19 = l6(P6, r8(P6, i21[1] * o18, i21[0] * -o18), this.offset + this.width / 2), m21 = s6(k4, s6(k4, s6(k4, s19, l6(k4, i21, this.length / 2)), d19), d19), u15 = s6(E10, m21, l6(E10, i21, -this.length));
    e21.unprojectFromScreen(m21, V5), c16[0] = V5[0], c16[1] = V5[1], c16[2] = V5[2], e21.unprojectFromScreen(u15, V5), c16[3] = V5[0], c16[4] = V5[1], c16[5] = V5[2], t24.geometryVertexAttrsUpdated(a25);
  }
};
var V5 = n2();
var A9 = i3();
var M5 = i3();
var P6 = i3();
var k4 = i3();
var E10 = i3();

// node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElementResources.js
var u9 = class {
  constructor(e21) {
    this._resourceFactory = e21, this._resources = null, this._visible = true, this._attached = false;
  }
  destroy() {
    this._destroyResources();
  }
  get object() {
    return r(this._resources) ? this._resources.object : null;
  }
  get resources() {
    return r(this._resources) ? this._resources.external : null;
  }
  get visible() {
    return this._visible;
  }
  set visible(e21) {
    e21 !== this._visible && (this._visible = e21, this._syncVisible());
  }
  get attached() {
    return this._attached;
  }
  set attached(e21) {
    e21 !== this._attached && (this._attached = e21, this._createOrDestroyResources());
  }
  recreate() {
    this.attached && this._createResources();
  }
  recreateGeometry() {
    if (!this._resourceFactory.recreateGeometry)
      return void this.recreate();
    const e21 = this._resourceFactory.view._stage;
    if (t(this._resources) || !e21)
      return;
    const r22 = this._resources.object;
    this._resources.external.forEach((s19) => {
      s19.type === e9.Geometry && e21.remove(s19);
    }), r22.removeAllGeometries();
    const t24 = this._resourceFactory.recreateGeometry(this._resources.external, r22, this._resources.layer);
    e21.addMany(t24);
  }
  _createOrDestroyResources() {
    this._attached ? this._resources || this._createResources() : this._destroyResources();
  }
  _createResources() {
    this._destroyResources();
    const e21 = this._resourceFactory, s19 = e21.view, i21 = s19._stage;
    if (!i21)
      return;
    const u15 = new l14({ isPickable: false, updatePolicy: i8.SYNC });
    i21.add(u15);
    const n20 = new x8({ castShadow: false }), _10 = e21.createResources(n20, u15);
    _10.forEach((e22) => {
      i21.add(e22), e22 instanceof L && i21.loadImmediate(e22);
    }), i21.add(n20), u15.add(n20);
    const l21 = e21.cameraChanged ? l3(() => s19.state.camera, (s20) => e21.cameraChanged(s20), h4) : null;
    this._resources = { layer: u15, object: n20, external: _10, cameraHandle: l21 }, this._syncVisible();
  }
  _destroyResources() {
    if (t(this._resources))
      return;
    const e21 = this._resourceFactory.view._stage;
    e21 == null ? void 0 : e21.remove(this._resources.object), e21 == null ? void 0 : e21.remove(this._resources.layer), this._resources.external.forEach((s19) => {
      e21 == null ? void 0 : e21.remove(s19), "dispose" in s19 && s19.dispose();
    }), this._resources.object.dispose(), this._resources.cameraHandle && this._resources.cameraHandle.remove(), this._resources = null;
  }
  _syncVisible() {
    t(this._resources) || this._resources.object.setVisible(this._visible);
  }
};

// node_modules/@arcgis/core/views/3d/interactive/visualElements/PointVisualElement.js
var S6 = class {
  constructor(e21) {
    this.view = null, this._geometry = null, this._size = 3, this._color = r7(1, 0, 1, 1), this._pixelSnappingEnabled = true, this._primitive = "square", this._outlineSize = 1, this._outlineColor = r7(1, 1, 1, 1), this._elevationInfo = null, this._resources = new u9({ view: e21.view, createResources: (e22) => this._createResources(e22), recreateGeometry: (e22, t25) => (e22.geometry = this._recreateGeometry(t25, e22.material), r(e22.geometry) ? [e22.geometry] : []) });
    let t24 = true;
    for (const r22 in e21)
      r22 in this ? "attached" === r22 ? t24 = e21[r22] : this[r22] = e21[r22] : console.error("Cannot set unknown property", r22);
    this.attached = t24;
  }
  destroy() {
    this._resources.destroy();
  }
  get visible() {
    return this._resources.visible;
  }
  set visible(e21) {
    this._resources.visible = e21;
  }
  get attached() {
    return this._resources.attached;
  }
  set attached(e21) {
    this._resources.attached = e21;
  }
  get geometry() {
    return this._geometry;
  }
  set geometry(e21) {
    this._geometry = e21, this._resources.recreateGeometry();
  }
  get size() {
    return this._size;
  }
  set size(e21) {
    if (e21 !== this._size) {
      const t24 = this._preferredTextureSize;
      this._size = e21, t24 < this._preferredTextureSize ? r(this._resources) && this._resources.recreate() : this._updateSizeAttribute();
    }
  }
  get color() {
    return this._color;
  }
  set color(e21) {
    D(e21, this._color) || (a2(this._color, e21), this._updateMaterial());
  }
  get pixelSnappingEnabled() {
    return this._pixelSnappingEnabled;
  }
  set pixelSnappingEnabled(e21) {
    this._pixelSnappingEnabled !== e21 && (this._pixelSnappingEnabled = e21, this._updateMaterial());
  }
  get primitive() {
    return this._primitive;
  }
  set primitive(e21) {
    this._primitive !== e21 && (this._primitive = e21, r(this._resources) && this._resources.recreate());
  }
  get outlineSize() {
    return this._outlineSize;
  }
  set outlineSize(e21) {
    e21 !== this._outlineSize && (this._outlineSize = e21, this._updateMaterial());
  }
  get outlineColor() {
    return this._outlineColor;
  }
  set outlineColor(e21) {
    D(e21, this._outlineColor) || (a2(this._outlineColor, e21), this._updateMaterial());
  }
  get elevationInfo() {
    return this._elevationInfo;
  }
  set elevationInfo(e21) {
    this._elevationInfo = e21, this._resources && this._resources.recreateGeometry();
  }
  _updateMaterial() {
    const e21 = this._resources.resources;
    t(e21) || e21.material.setParameters(this._materialParameters(e21.texture.id));
  }
  _updateSizeAttribute() {
    const e21 = this._resources.resources, t24 = this._resources.object;
    if (t(e21) || t(t24))
      return;
    const r22 = e21.geometry;
    if (t(r22))
      return;
    const s19 = r22.getMutableAttribute(O2.SIZE).data, o18 = this._geometrySize;
    s19[0] = o18, s19[1] = o18, t24.geometryVertexAttrsUpdated(t24.geometryRecords[0]);
  }
  _materialParameters(e21) {
    return { color: this._color, textureIsSignedDistanceField: true, distanceFieldBoundingBox: z2, occlusionTest: false, outlineColor: this._outlineColor, outlineSize: this._outlineSize, textureId: e21, polygonOffset: false, shaderPolygonOffset: 0, drawInSecondSlot: true, depthEnabled: false, pixelSnappingEnabled: this.pixelSnappingEnabled };
  }
  get _geometrySize() {
    return this._size / b8;
  }
  _recreateGeometry(e21, t24) {
    const i21 = this._createRenderGeometry();
    return r(i21) && e21.addGeometry(i21, t24), i21;
  }
  _createResources(e21) {
    const t24 = o13(this._primitive, this._preferredTextureSize), i21 = new Q2(this._materialParameters(t24.id)), s19 = this._recreateGeometry(e21, i21);
    return { material: i21, texture: t24, geometry: s19, forEach(e22) {
      e22(t24), e22(i21), r(this.geometry) && e22(this.geometry);
    } };
  }
  get _preferredTextureSize() {
    return a3(i2(2 * this._geometrySize), 16, 128);
  }
  calculateMapBounds(e21) {
    if (t(this._resources.resources) || t(this._resources.resources.geometry))
      return false;
    const t24 = this._resources.resources.geometry.vertexAttributes.get(O2.POSITION);
    return jn(t24.data, this.view.renderCoordsHelper.spatialReference, x10, this.view.spatialReference), M(e21, x10), true;
  }
  _createRenderGeometry() {
    const e21 = this.geometry;
    if (t(e21))
      return null;
    const { renderCoordsHelper: t24, elevationProvider: r22 } = this.view, o18 = m11(e21, r22, h13.fromElevationInfo(this.elevationInfo), t24), n20 = o2(c2.get(), e21.x, e21.y, o18), a25 = c2.get();
    jn(n20, e21.spatialReference, a25, t24.spatialReference);
    const l21 = this._geometrySize;
    return b6(null, a25, null, [l21, l21], [0, 0, 0, 1]);
  }
};
var b8 = a15;
var z2 = [b8 / 2, b8 / 2, 1 - b8 / 2, 1 - b8 / 2];
var x10 = n2();

// node_modules/@arcgis/core/views/3d/interactive/visualElements/RightAngleQuadVisualElement.js
var S7 = class extends n13 {
  constructor(t24) {
    super(t24), this._handles = new t4(), this._quadMaterial = null, this._outlineMaterial = null, this._maxSize = 0, this._position = n2(), this._up = n2(), this._right = n2(), this._renderOccluded = o7.OccludeAndTransparent, this._color = r11(1, 0, 0, 1), this._outlineColor = r11(0, 0, 0, 1), this._outlineSize = 0, this._size = 32, this._outlineRenderOccluded = o7.Opaque, this.applyProps(t24);
  }
  get renderOccluded() {
    return this._renderOccluded;
  }
  set renderOccluded(e21) {
    e21 !== this._renderOccluded && (this._renderOccluded = e21, this._updateQuadMaterial());
  }
  get color() {
    return this._color;
  }
  set color(e21) {
    a2(this._color, e21), this._updateQuadMaterial();
  }
  get outlineColor() {
    return this._outlineColor;
  }
  set outlineColor(e21) {
    a2(this._outlineColor, e21), this._updateOutlineMaterial();
  }
  get outlineSize() {
    return this._outlineSize;
  }
  set outlineSize(e21) {
    const t24 = 0 === this._outlineSize != (0 === e21);
    this._outlineSize = e21, t24 ? this.recreateGeometry() : this._updateOutlineMaterial();
  }
  get size() {
    return this._size;
  }
  set size(e21) {
    e21 !== this._size && (this._size = e21, this._updateTransform());
  }
  get outlineRenderOccluded() {
    return this._outlineRenderOccluded;
  }
  set outlineRenderOccluded(e21) {
    this._outlineRenderOccluded = e21, this._updateOutlineMaterial();
  }
  set geometry({ previous: e21, center: t24, next: i21 }) {
    this._maxSize = Math.min(x(t24, e21), x(t24, i21)) / 3, z(this._up, e2(this._up, e21, t24)), z(this._right, e2(this._right, i21, t24)), r3(this._position, t24), this.recreateGeometry();
  }
  createExternalResources() {
    this._quadMaterial = new m12(this._quadMaterialParameters), this._outlineMaterial = new H5(this._outlineMaterialParameters), this._handles.add(l3(() => this.view.state.camera, () => this._updateTransform()));
  }
  destroyExternalResources() {
    this._quadMaterial = null, this._outlineMaterial = null, this._handles.removeAll();
  }
  forEachExternalMaterial(e21) {
    e21(this._quadMaterial), e21(this._outlineMaterial);
  }
  createGeometries(e21) {
    F(this._up, f) && F(this._right, f) || (this._createQuadGeometry(e21), this._createOutlineGeometry(e21), this._updateTransform(e21));
  }
  _createQuadGeometry(e21) {
    const t24 = this._quadGeometryData(this._up, this._right);
    e21.addGeometry(t24, this._quadMaterial);
  }
  _createOutlineGeometry(e21) {
    if (0 === this._outlineSize)
      return;
    const t24 = u(c2.get(), this._up, this._right), i21 = q6([this._up, t24, this._right]);
    e21.addGeometry(i21, this._outlineMaterial);
  }
  _updateTransform(e21 = this.object) {
    const i21 = this.view.state.camera, a25 = this._size * i21.computeScreenPixelSizeAt(this._position), o18 = Math.min(this._maxSize, a25);
    x3(w9, this._position), i4(w9, w9, [o18, o18, o18]), r(e21) && (e21.transformation = w9);
  }
  _quadGeometryData(e21, t24) {
    const i21 = u(c2.get(), e21, t24);
    return new d4([[O2.POSITION, { size: 3, data: [0, 0, 0, ...t24, ...e21, ...i21], exclusive: true }]], [[O2.POSITION, [0, 1, 2, 1, 2, 3]]]);
  }
  get _quadMaterialParameters() {
    return { color: this._color, transparent: true, writeDepth: false, polygonOffset: true, renderOccluded: this._renderOccluded };
  }
  _updateQuadMaterial() {
    this._quadMaterial && this._quadMaterial.setParameters(this._quadMaterialParameters);
  }
  get _outlineMaterialParameters() {
    return { color: this._outlineColor, width: this._outlineSize, renderOccluded: this._outlineRenderOccluded };
  }
  _updateOutlineMaterial() {
    this._outlineMaterial && this._outlineMaterial.setParameters(this._outlineMaterialParameters);
  }
};
var w9 = e6();

// node_modules/@arcgis/core/views/3d/interactive/SnappingVisualizer3D.js
var _6 = class extends r12 {
  visualizeIntersectionPoint(t24, o18) {
    const { coordinateHelper: r22, view: a25 } = o18;
    return t3(new S6({ view: a25, primitive: "circle", geometry: r22.vectorToPoint(t24.intersectionPoint), elevationInfo: i(t24.elevationInfo, o18.elevationInfo), size: 20, outlineSize: 2, color: [0, 0, 0, 0], outlineColor: l.toUnitRGBA(p9.orange), pixelSnappingEnabled: false }));
  }
  visualizePoint(i21, t24) {
    const { view: o18, coordinateHelper: r22 } = t24, a25 = this._alignPoint(i21.point, i21.domain, t24);
    return t3(new S6({ view: o18, primitive: "circle", geometry: r22.vectorToPoint(a25), elevationInfo: this._hintElevationInfo(i21, t24), size: 20, outlineSize: 2, color: [0, 0, 0, 0], outlineColor: l.toUnitRGBA(p9.orange), pixelSnappingEnabled: false }));
  }
  visualizeLine(e21, i21) {
    const { view: t24, coordinateHelper: o18 } = i21, r22 = this._alignPoint(e21.lineStart, e21.domain, i21), a25 = this._alignPoint(e21.lineEnd, e21.domain, i21);
    return t3(this._createLineSegmentHintFromMap(e21.type, r22, a25, o18, this._hintElevationInfo(e21, i21), t24, e21.fadeLeft, e21.fadeRight));
  }
  visualizeParallelSign(i21, t24) {
    const { view: o18, coordinateHelper: r22 } = t24, l21 = this._hintElevationInfo(i21, t24), s19 = this._alignPoint(i21.lineStart, i21.domain, t24), p23 = this._alignPoint(i21.lineEnd, i21.domain, t24), c16 = f10(s19, r22, l21, o18), m21 = f10(p23, r22, l21, o18), g16 = A(m21, c16, m21, 0.5), v16 = new v10({ view: o18, attached: false, offset: p9.parallelLineHintOffset, length: p9.parallelLineHintLength, width: p9.parallelLineHintWidth, color: l.toUnitRGBA(p9.orange), location: g16, renderOccluded: o7.Opaque });
    return v16.setDirectionFromPoints(c16, g16), v16.attached = true, t3(v16);
  }
  visualizeRightAngleQuad(i21, t24) {
    const { view: o18, coordinateHelper: r22 } = t24, a25 = this._hintElevationInfo(i21, t24), l21 = this._alignPoint(i21.previousVertex, i21.domain, t24), s19 = this._alignPoint(i21.centerVertex, i21.domain, t24), p23 = this._alignPoint(i21.nextVertex, i21.domain, t24);
    return t3(new S7({ view: o18, attached: true, color: l.toUnitRGBA(p9.orange), renderOccluded: o7.Transparent, outlineRenderOccluded: o7.Opaque, outlineColor: l.toUnitRGBA(p9.orange), outlineSize: p9.rightAngleHintOutlineSize, size: p9.rightAngleHintSize, geometry: { previous: f10(l21, r22, a25, o18), center: f10(s19, r22, a25, o18), next: f10(p23, r22, a25, o18) } }));
  }
  _createLineSegmentHintFromMap(e21, n20, i21, t24, o18, r22, a25 = true, s19 = true) {
    const p23 = n2(), c16 = n2();
    return m8(n20, i21, t24, o18, r22, p23, c16), this._createLineSegmentHint(e21, r22, p23, c16, a25, s19);
  }
  _createLineSegmentHint(n20, i21, t24, o18, r22 = true, a25 = true) {
    const l21 = new G5({ view: i21, extensionType: V4.FADED, start: t24, end: o18, color: l.toUnitRGBA(p9.orange), renderOccluded: o7.Opaque });
    switch (n20) {
      case l12.TARGET:
        l21.width = p9.lineHintWidthTarget, l21.fadedExtensions = { start: 0, end: p9.lineHintFadedExtensions };
        break;
      case l12.REFERENCE_EXTENSION:
        l21.width = p9.lineHintWidthReference, l21.fadedExtensions = { start: 0, end: 0 };
        break;
      case l12.REFERENCE:
        l21.width = p9.lineHintWidthReference, l21.fadedExtensions = { start: r22 ? p9.lineHintFadedExtensions : 0, end: a25 ? p9.lineHintFadedExtensions : 0 };
    }
    return l21.attached = true, l21;
  }
  _alignPoint(e21, n20, i21) {
    const o18 = this._getSelfSnappingZ(n20, i21);
    if (t(o18))
      return e21;
    const r22 = i21.coordinateHelper, a25 = r22.vectorToPoint(e21, H6);
    return a25.z = o18, r22.pointToVector(a25);
  }
  _hintElevationInfo(e21, n20) {
    return r(this._getSelfSnappingZ(e21.domain, n20)) ? e(n20.selfSnappingZ).elevationInfo : i(e21.elevationInfo, n20.elevationInfo);
  }
  _getSelfSnappingZ(e21, { selfSnappingZ: n20 }) {
    return e21 === E6.SELF && r(n20) ? n20.value : null;
  }
};
var H6 = new w2();

// node_modules/@arcgis/core/views/3d/interactive/editingTools/settings.js
var r16 = { main: new l([255, 127, 0]), selected: new l([255, 255, 255]), staged: new l([12, 207, 255]), outline: new l([0, 0, 0, 0.5]), selectedOutline: new l([255, 255, 255]) };
var h17 = 0.3;
function c10(t24, e21) {
  const i21 = t24.clone();
  return i21.a *= e21, i21;
}
function a19(t24, l21) {
  const o18 = t24.clone(), s19 = y4(o18);
  s19.s *= l21;
  const n20 = p6(s19);
  return o18.r = n20.r, o18.g = n20.g, o18.b = n20.b, o18;
}
function d13(t24, e21) {
  if (e21)
    for (const i21 in e21)
      t24[i21] = e21[i21];
}
var u10 = class {
  constructor(t24) {
    this.color = r16.main, this.height = 90, this.coneHeight = 40, this.coneWidth = 23, this.width = 3, this.renderOccluded = o7.Opaque, d13(this, t24);
  }
};
var p16 = class {
  constructor(t24) {
    this.size = 11, this.outlineSize = 1, this.collisionPadding = 9, this.color = r16.main, this.outlineColor = r16.outline, this.renderOccluded = o7.Opaque, this.hoverOutlineColor = r16.selectedOutline, d13(this, t24);
  }
  apply(t24, e21) {
    const i21 = this[t24];
    e21.setParameters({ color: P7(i21), transparent: "color" !== t24 || i21.a < 1, renderOccluded: this.renderOccluded });
  }
};
var g9 = class {
  constructor(t24) {
    this.size = 40, this.height = 0.2, this.offset = 0.25, this.collisionPadding = 2, this.color = c10(r16.main, 0.5), this.hoverColor = r16.main, this.renderOccluded = o7.Transparent, this.minSquaredEdgeLength = 900, d13(this, t24);
  }
  apply(t24, e21) {
    const i21 = this[t24];
    e21.setParameters({ color: P7(i21), transparent: i21.a < 1, renderOccluded: this.renderOccluded });
  }
};
var f14 = class {
  constructor(t24) {
    this.vertex = new p16({ color: r16.main, outlineColor: r16.outline }), this.edge = new p16({ color: a19(c10(r16.main, 2 / 3), 0.5), outlineColor: c10(r16.outline, 0.5), size: 8, collisionPadding: 8 }), this.selected = new p16({ color: r16.selected, outlineColor: r16.outline }), this.edgeOffset = new g9(), d13(this, t24);
  }
};
var w10 = class {
  constructor(t24) {
    this.color = r16.selected, this.width = 1.5, this.stipplePattern = r13(5), this.stippleOffColor = r16.outline, this.falloff = 0, this.innerWidth = 1.5, this.innerColor = r16.selected, this.renderOccluded = o7.OccludeAndTransparent, d13(this, t24);
  }
  apply(t24) {
    t24.color = P7(this.color), t24.width = this.width, t24.stipplePattern = this.stipplePattern, t24.stippleOffColor = P7(this.stippleOffColor), t24.falloff = this.falloff, t24.innerWidth = this.innerWidth, t24.innerColor = P7(this.innerColor), t24.renderOccluded = this.renderOccluded;
  }
};
var C7 = class {
  constructor(t24) {
    this.color = r16.selected, this.size = 4, this.outlineSize = 1, this.outlineColor = r16.outline, this.shape = "square", d13(this, t24);
  }
  apply(t24) {
    t24.color = P7(this.color), t24.size = this.size, t24.outlineSize = this.outlineSize, t24.outlineColor = P7(this.outlineColor), t24.primitive = this.shape;
  }
};
var m15 = class {
  constructor(t24) {
    this.innerColor = r16.selected, this.innerWidth = 1, this.glowColor = r16.main, this.glowWidth = 8, this.glowFalloff = 8, this.globalAlpha = h17, this.globalAlphaContrastBoost = 1.5, this.radius = 3, this.heightFillColor = r16.main, d13(this, t24);
  }
  apply(e21, i21 = 1) {
    const l21 = { glowColor: l.toUnitRGB(this.glowColor), glowFalloff: this.glowFalloff, glowWidth: this.glowWidth, innerColor: l.toUnitRGB(this.innerColor), innerWidth: this.innerWidth, globalAlpha: this.globalAlpha * i21, globalAlphaContrastBoost: this.globalAlphaContrastBoost, intersectsLineRadius: this.radius };
    "style" in e21 ? e21.style = l21 : e21.laserlineStyle = l21;
  }
};
var O3 = class {
  constructor(t24) {
    this.outline = new w10({ color: r16.outline, renderOccluded: o7.OccludeAndTransparentStencil, stippleOffColor: r16.selected, stipplePattern: r13(5), width: 1.5, innerWidth: 0 }), this.staged = new w10({ color: r16.selected, renderOccluded: o7.OccludeAndTransparentStencil, innerColor: r16.staged, stippleOffColor: r16.outline, stipplePattern: r13(5), width: 1.5 }), this.shadowStyle = new m15({ globalAlpha: h17, glowColor: r16.main, glowFalloff: 8, glowWidth: 8, innerColor: r16.selected, innerWidth: 1 }), d13(this, t24);
  }
};
var A10 = class {
  constructor(t24) {
    this.outline = new C7({ color: r16.selected, outlineColor: r16.outline, outlineSize: 1, shape: "circle", size: 4 }), this.shadowStyle = new m15({ globalAlpha: h17, glowColor: r16.main, glowFalloff: 1.5, glowWidth: 6, innerColor: r16.selected, innerWidth: 1, radius: 2 }), d13(this, t24);
  }
};
var W3 = class extends w10 {
  constructor(t24) {
    super(), this.extensionType = V4.GROUND_RAY, d13(this, t24);
  }
};
var b9 = class {
  constructor(t24) {
    this.lineGraphics = new O3(), this.pointGraphics = new A10(), this.heightPlane = new m15({ globalAlpha: h17, glowColor: r16.main, glowFalloff: 8, glowWidth: 8, innerColor: r16.selected, innerWidth: 1 }), this.heightBox = new m15({ globalAlpha: h17, glowColor: r16.main, glowFalloff: 8, glowWidth: 8, innerColor: r16.selected, innerWidth: 0, heightFillColor: r16.main }), this.zVerticalLine = new W3({ color: c10(r16.main, 5 * h17 / 3), falloff: 2, innerColor: c10(r16.selected, 0), renderOccluded: o7.OccludeAndTransparent, stipplePattern: null, width: 5, extensionType: V4.GROUND_RAY }), this.laserlineAlphaMultiplier = 1.5, this.heightPlaneAngleCutoff = 20, d13(this, t24);
  }
};
var z3 = class {
  constructor(t24) {
    this.visualElements = new b9(), this.reshapeManipulators = new f14(), this.zManipulator = new u10(), d13(this, t24);
  }
  colorToVec4(t24) {
    return P7(t24);
  }
};
function P7(e21) {
  return e4(l.toUnitRGBA(e21));
}
var y7 = new z3();

// node_modules/@arcgis/core/views/3d/interactive/visualElements/DrapedVisualElementResources.js
var h18 = class {
  constructor(e21) {
    this._resourceFactory = e21, this._resources = null, this._visible = true, this._attached = false;
  }
  destroy() {
    this._destroyResources();
  }
  get resources() {
    return r(this._resources) ? this._resources.external : null;
  }
  get visible() {
    return this._visible;
  }
  set visible(e21) {
    e21 !== this._visible && (this._visible = e21, this._syncGeometriesToRenderer());
  }
  get attached() {
    return this._attached;
  }
  set attached(e21) {
    e21 !== this._attached && (this._attached = e21, this._createOrDestroyResources());
  }
  recreate() {
    this.attached && this._createResources();
  }
  recreateGeometry() {
    this._resourceFactory.recreateGeometry ? t(this._resources) || (this._ensureRenderGeometriesRemoved(), this._resourceFactory.recreateGeometry(this._resources.external), this._syncGeometriesToRenderer()) : this.recreate();
  }
  _createOrDestroyResources() {
    this._attached ? t(this._resources) && this._createResources() : this._destroyResources();
  }
  _createResources() {
    var _a;
    this._destroyResources();
    const e21 = this._resourceFactory.createResources(), r22 = new n14({ view: this._resourceFactory.view }), s19 = (_a = this._resourceFactory.view.basemapTerrain) == null ? void 0 : _a.overlayManager;
    this._resources = { layerView: new n14({ view: this._resourceFactory.view }), external: e21, geometriesAdded: false }, s19 && (this._resources.drapeSourceRenderer = s19.registerGeometryDrapeSource(r22)), this._syncGeometriesToRenderer();
  }
  _destroyResources() {
    var _a;
    if (t(this._resources))
      return;
    this._ensureRenderGeometriesRemoved();
    const e21 = (_a = this._resourceFactory.view.basemapTerrain) == null ? void 0 : _a.overlayManager;
    e21 && e21.unregisterDrapeSource(this._resources.layerView), this._resources = null;
  }
  _syncGeometriesToRenderer() {
    this._visible ? this._ensureRenderGeometriesAdded() : this._ensureRenderGeometriesRemoved();
  }
  _ensureRenderGeometriesRemoved() {
    if (t(this._resources) || t(this._resources.drapeSourceRenderer))
      return;
    if (!this._resources.geometriesAdded)
      return;
    this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries, E9.UPDATE), this._resources.geometriesAdded = false;
  }
  _ensureRenderGeometriesAdded() {
    if (t(this._resources) || t(this._resources.drapeSourceRenderer))
      return;
    if (this._resources.geometriesAdded)
      return;
    this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries, E9.UPDATE), this._resources.geometriesAdded = true;
  }
};
var n14 = class extends s4(m2) {
  constructor(e21) {
    super(e21), this.drapeSourceType = e16.Features, this.updatePolicy = i8.SYNC;
  }
};
e3([y2({ constructOnly: true })], n14.prototype, "view", void 0), e3([y2({ readOnly: true })], n14.prototype, "drapeSourceType", void 0), n14 = e3([n4("DrapedVisualElementLayerView")], n14);

// node_modules/@arcgis/core/views/3d/interactive/visualElements/OutlineVisualElement.js
var S8 = class {
  constructor(t24) {
    this.view = null, this._attachmentOrigin = v5(0, 0, 0, null), this._attachmentOriginDirty = true, this.events = new n5(), this._isDraped = false, this._geometry = null, this._width = 1, this._color = r11(1, 0, 1, 1), this._innerWidth = 0, this._innerColor = r11(1, 1, 1, 1), this._stipplePattern = null, this._stippleOffColor = null, this._falloff = 0, this._elevationInfo = null, this._laserlineStyle = null, this._laserlineEnabled = false, this._renderOccluded = o7.OccludeAndTransparentStencil, this._resources = new u9({ view: t24.view, createResources: (e21) => this._createResources(e21), recreateGeometry: (e21, t25) => (e21.geometries.length = 0, this._recreateGeometry(t25, e21.material, e21.geometries), e21.geometries) }), this._attachmentOrigin.spatialReference = t24.view.spatialReference, this._drapedResources = new h18({ view: t24.view, createResources: () => this._createDrapedResources(), recreateGeometry: (e21) => {
      e21.geometries = this._createRenderGeometriesDraped(e21.material), this._attachmentOriginChanged();
    } });
    let r22 = true;
    this._laserline = new d12({ view: t24.view });
    for (const e21 in t24)
      e21 in this ? "attached" === e21 ? r22 = t24[e21] : this[e21] = t24[e21] : console.error("Cannot set unknown property", e21);
    this.attached = r22;
  }
  destroy() {
    this._resources.destroy(), this._drapedResources.destroy(), this._laserline.destroy();
  }
  get isDraped() {
    return this._isDraped;
  }
  set isDraped(e21) {
    e21 !== this._isDraped && (this._isDraped = e21, this._updateAttached(this.attached), this._laserline.attached = this._laserlineAttached);
  }
  get _laserlineAttached() {
    return this.attached && this.visible && r(this._laserlineStyle) && !this.isDraped && this.laserlineEnabled;
  }
  get visible() {
    return this._resources.visible;
  }
  set visible(e21) {
    this._resources.visible = e21, this._drapedResources.visible = e21, this._laserline.attached = this._laserlineAttached;
  }
  get attached() {
    return this._resources.attached || this._drapedResources.attached;
  }
  set attached(e21) {
    this._updateAttached(e21);
  }
  _updateAttached(e21) {
    this._resources.attached = !this.isDraped && e21, this._drapedResources.attached = this.isDraped && e21, this._laserline.attached = this._laserlineAttached, this.attached && this._attachmentOriginChanged();
  }
  get geometry() {
    return this._geometry;
  }
  set geometry(e21) {
    this._geometry = e21, this._resources.recreateGeometry(), this._drapedResources.recreateGeometry();
  }
  get width() {
    return this._width;
  }
  set width(e21) {
    e21 !== this._width && (this._width = e21, this._updateMaterial());
  }
  get color() {
    return this._color;
  }
  set color(e21) {
    D(e21, this._color) || (a2(this._color, e21), this._updateMaterial());
  }
  get innerWidth() {
    return this._innerWidth;
  }
  set innerWidth(e21) {
    e21 !== this._innerWidth && (this._innerWidth = e21, this._updateMaterial());
  }
  get innerColor() {
    return this._innerColor;
  }
  set innerColor(e21) {
    D(e21, this._innerColor) || (a2(this._innerColor, e21), this._updateMaterial());
  }
  get stipplePattern() {
    return this._stipplePattern;
  }
  set stipplePattern(e21) {
    const r22 = r(e21) !== r(this._stipplePattern);
    this._stipplePattern = e21, r22 ? this._resources.recreate() : this._updateMaterial();
  }
  get stippleOffColor() {
    return this._stippleOffColor;
  }
  set stippleOffColor(e21) {
    e21 && this._stippleOffColor && D(e21, this._stippleOffColor) || (this._stippleOffColor = e21 ? t13(e21) : null, this._updateMaterial());
  }
  get falloff() {
    return this._falloff;
  }
  set falloff(e21) {
    e21 !== this._falloff && (this._falloff = e21, this._updateMaterial());
  }
  get elevationInfo() {
    return this._elevationInfo;
  }
  set elevationInfo(e21) {
    this._elevationInfo = e21, this._resources.recreateGeometry();
  }
  get laserlineStyle() {
    return this._laserlineStyle;
  }
  set laserlineStyle(e21) {
    this._laserlineStyle = e21, this._laserline.attached = this._laserlineAttached, r(e21) && (this._laserline.style = e21);
  }
  get laserlineEnabled() {
    return this._laserlineEnabled;
  }
  set laserlineEnabled(e21) {
    this._laserlineEnabled !== e21 && (this._laserlineEnabled = e21, this._laserline.attached = this._laserlineAttached);
  }
  get renderOccluded() {
    return this._renderOccluded;
  }
  set renderOccluded(e21) {
    e21 !== this._renderOccluded && (this._renderOccluded = e21, this._updateMaterial());
  }
  get attachmentOrigin() {
    if (!this._attachmentOriginDirty)
      return this._attachmentOrigin;
    const e21 = r(this._resources.resources) ? this._resources.resources.geometries : null;
    if (!e21 || 0 === e21.length)
      return null;
    o2(W4, 0, 0, 0);
    let s19 = 0;
    for (const t24 of e21) {
      const e22 = t24.vertexAttributes.get(O2.POSITION), i21 = t24.indices.get(O2.POSITION), n20 = e(this._resources.resources).material.isClosed(e22.data, i21);
      f7(e22, i21, n20, T7) && (u(W4, W4, T7), s19++);
    }
    return 0 === s19 ? null : (g(W4, W4, 1 / s19), this.view.renderCoordsHelper.fromRenderCoords(W4, this._attachmentOrigin), this._attachmentOriginDirty = false, this._attachmentOrigin);
  }
  _updateMaterial() {
    r(this._resources.resources) && this._resources.resources.material.setParameters(this._materialParameters), r(this._drapedResources.resources) && this._drapedResources.resources.material.setParameters(this._materialParameters);
  }
  get _isClosed() {
    return r(this.geometry) && "polygon" === this.geometry.type;
  }
  get _materialParameters() {
    return { width: this._width, color: this._color, stippleOffColor: this._stippleOffColor, stipplePattern: this._stipplePattern, stipplePreferContinuous: false, isClosed: this._isClosed, falloff: this._falloff, innerColor: this._innerColor, innerWidth: this._innerWidth, join: "round", hasPolygonOffset: true, renderOccluded: this._normalizedRenderOccluded };
  }
  get _normalizedRenderOccluded() {
    return this.isDraped && this._renderOccluded === o7.OccludeAndTransparentStencil ? o7.OccludeAndTransparent : this._renderOccluded;
  }
  _recreateGeometry(e21, t24, r22) {
    const s19 = this._createRenderGeometries();
    for (const i21 of s19)
      e21.addGeometry(i21, t24), r22.push(i21);
    this._attachmentOriginChanged();
  }
  _attachmentOriginChanged() {
    this._attachmentOriginDirty = true, this.events.emit("attachment-origin-changed");
  }
  _createResources(e21) {
    const t24 = new H5(this._materialParameters), r22 = [];
    return this._recreateGeometry(e21, t24, r22), { material: t24, geometries: r22, forEach: (e22) => {
      e22(t24), r22.forEach(e22);
    } };
  }
  _createDrapedResources() {
    const e21 = new H5(this._materialParameters);
    return { material: e21, geometries: this._createRenderGeometriesDraped(e21) };
  }
  _createRenderGeometriesDraped(e21) {
    const t24 = this.geometry;
    if (t(t24) || t(this.view.basemapTerrain.spatialReference))
      return [];
    const r22 = s13(t24, this.view.basemapTerrain.spatialReference), i21 = [];
    for (const { position: s19 } of r22.lines) {
      const t25 = { overlayInfo: { spatialReference: this.view.basemapTerrain.spatialReference, renderCoordsHelper: this.view.renderCoordsHelper }, attributeData: { position: s19 }, removeDuplicateStartEnd: this._isClosed }, r23 = new T4(m13(t25), e21), a25 = A3(M6);
      M(a25, s19), r4(r23.boundingSphere, 0.5 * (a25[0] + a25[3]), 0.5 * (a25[1] + a25[4]), 0, 0.5 * Math.sqrt((a25[3] - a25[0]) * (a25[3] - a25[0]) + (a25[4] - a25[1]) * (a25[4] - a25[1]))), i21.push(r23);
    }
    return i21;
  }
  calculateMapBounds(e21) {
    if (t(this._resources.resources))
      return false;
    const t24 = this.view.renderCoordsHelper;
    for (const r22 of this._resources.resources.geometries) {
      const s19 = r22.vertexAttributes.get(O2.POSITION), i21 = new Float64Array(s19.data.length);
      xn(s19.data, t24.spatialReference, 0, i21, this.view.spatialReference, 0, s19.data.length / 3), M(e21, i21);
    }
    return true;
  }
  _createRenderGeometries() {
    var _a;
    const e21 = this.geometry;
    if (t(e21))
      return [];
    const t24 = i13(e21, this.view.elevationProvider, this.view.renderCoordsHelper, h13.fromElevationInfo((_a = this.elevationInfo) != null ? _a : new x4({ mode: i9(e21, null) }))), r22 = [], i21 = [];
    for (const { position: s19, mapPosition: a25 } of t24.lines) {
      const e22 = { attributeData: { position: s19, mapPosition: a25 }, removeDuplicateStartEnd: this._isClosed };
      r22.push(m13(e22)), i21.push(s19);
    }
    return this._laserline.pathVerticalPlane = i21, r22;
  }
};
var M6 = a6();
var T7 = n2();
var W4 = n2();

// node_modules/@arcgis/core/views/3d/support/renderInfoUtils/point.js
function t18(t24, e21, o18, l21, r22) {
  const i21 = new Float64Array(3 * t24.length), s19 = new Float64Array(i21.length);
  t24.forEach((n20, t25) => {
    i21[3 * t25 + 0] = n20[0], i21[3 * t25 + 1] = n20[1], i21[3 * t25 + 2] = n20.length > 2 ? n20[2] : 0;
  });
  const a25 = f11(i21, e21, 0, s19, 0, i21, 0, i21.length / 3, o18, l21, r22), c16 = null != a25;
  return { numVertices: t24.length, position: i21, mapPosition: s19, projectionSuccess: c16, sampledElevation: a25 };
}

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique.js
var g10 = class extends e10 {
  initializeProgram(e21) {
    return new o9(e21.rctx, g10.shader.get().build(this.configuration), v11);
  }
  _setPipelineState(e21) {
    const r22 = this.configuration, o18 = e21 === o8.NONE, i21 = e21 === o8.FrontFace;
    return W({ blending: r22.output !== h8.Color && r22.output !== h8.Alpha || !r22.transparent ? null : o18 ? c3 : A5(e21), culling: h11(r22.cullFace), depthTest: { func: i21 ? I2.LESS : r22.shadingEnabled ? I2.LEQUAL : I2.LESS }, depthWrite: o18 ? r22.writeDepth && a10 : E4(e21), colorWrite: _3, polygonOffset: o18 || i21 ? null : _4 });
  }
  initializePipeline() {
    return this._setPipelineState(this.configuration.transparencyPassType);
  }
};
g10.shader = new t9(h14, () => import("./ShadedColorMaterial.glsl-AF2CTBMF.js"));
var j6 = class extends s9 {
  constructor() {
    super(...arguments), this.output = h8.Color, this.cullFace = n9.None, this.transparencyPassType = o8.NONE, this.hasSlicePlane = false, this.transparent = false, this.writeDepth = true, this.screenSizeEnabled = true, this.shadingEnabled = true, this.hasMultipassTerrain = false, this.cullAboveGround = false;
  }
};
e3([e12({ count: h8.COUNT })], j6.prototype, "output", void 0), e3([e12({ count: n9.COUNT })], j6.prototype, "cullFace", void 0), e3([e12({ count: o8.COUNT })], j6.prototype, "transparencyPassType", void 0), e3([e12()], j6.prototype, "hasSlicePlane", void 0), e3([e12()], j6.prototype, "transparent", void 0), e3([e12()], j6.prototype, "writeDepth", void 0), e3([e12()], j6.prototype, "screenSizeEnabled", void 0), e3([e12()], j6.prototype, "shadingEnabled", void 0), e3([e12()], j6.prototype, "hasMultipassTerrain", void 0), e3([e12()], j6.prototype, "cullAboveGround", void 0);
var v11 = /* @__PURE__ */ new Map([[O2.POSITION, 0], [O2.NORMAL, 1], [O2.OFFSET, 2]]);

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/ShadedColorMaterial.js
var v12 = class extends d5 {
  constructor(e21) {
    super(e21, new x11()), this.supportsEdges = true, this._configuration = new j6(), this._vertexAttributeLocations = v11;
  }
  getConfiguration(e21, t24) {
    return this._configuration.output = e21, this._configuration.cullFace = this.parameters.cullFace, this._configuration.hasSlicePlane = this.parameters.hasSlicePlane, this._configuration.transparent = this.parameters.transparent, this._configuration.writeDepth = this.parameters.writeDepth, this._configuration.screenSizeEnabled = this.parameters.screenSizeEnabled, this._configuration.shadingEnabled = this.parameters.shadingEnabled, this._configuration.transparencyPassType = t24.transparencyPassType, this._configuration.hasMultipassTerrain = t24.multipassTerrain.enabled, this._configuration.cullAboveGround = t24.multipassTerrain.cullAboveGround, this._configuration;
  }
  intersect(e21, s19, a25, c16, l21, u15, h26) {
    if (this.parameters.screenSizeEnabled) {
      const a26 = e21.vertexAttributes.get(O2.OFFSET), p23 = { applyToVertex: (e22, s20, n20, o18) => {
        const l22 = o2(L3, a26.data[3 * o18 + 0], a26.data[3 * o18 + 1], a26.data[3 * o18 + 2]), u16 = o2(w11, e22, s20, n20);
        return g(l22, l22, this.parameters.screenSizeScale * c16.camera.computeRenderPixelSizeAt(l22)), u(u16, u16, l22), [u16[0], u16[1], u16[2]];
      }, applyToAabb: (e22) => {
        const t24 = p3(e22, L3);
        return Y(e22, this.parameters.screenSizeScale * c16.camera.computeRenderPixelSizeAt(t24));
      } };
      x5(e21, s19, c16, l21, u15, p23, h26);
    } else
      x5(e21, s19, c16, l21, u15, void 0, h26);
  }
  requiresSlot(e21, t24) {
    if (t24 === h8.Highlight)
      return e21 === E5.OPAQUE_MATERIAL;
    if (t24 === h8.Color || t24 === h8.Alpha || t24 === h8.ObjectAndLayerIdColor) {
      let t25 = E5.OPAQUE_MATERIAL;
      return this.parameters.transparent && (t25 = this.parameters.writeDepth ? E5.TRANSPARENT_MATERIAL : E5.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL), e21 === t25 || e21 === E5.DRAPED_MATERIAL;
    }
    return false;
  }
  createGLMaterial(e21) {
    return new j7(e21);
  }
  createBufferWriter() {
    return new O4(this.parameters.screenSizeEnabled);
  }
};
var j7 = class extends t8 {
  beginSlot(e21) {
    return this.ensureTechnique(g10, e21);
  }
};
var x11 = class extends h10 {
  constructor() {
    super(...arguments), this.color = r7(1, 1, 1, 1), this.shadingTint = r7(0, 0, 0, 0.25), this.shadingDirection = z(n2(), [0.5, -0.5, -0.5]), this.screenSizeScale = 14, this.transparent = false, this.writeDepth = true, this.hasSlicePlane = false, this.cullFace = n9.None, this.screenSizeEnabled = false, this.shadingEnabled = true;
  }
};
var O4 = class {
  constructor(e21) {
    this.screenSizeEnabled = e21;
    const t24 = T2().vec3f(O2.POSITION).vec3f(O2.NORMAL);
    this.screenSizeEnabled && t24.vec3f(O2.OFFSET), this.vertexBufferLayout = t24;
  }
  allocate(e21) {
    return this.vertexBufferLayout.createBuffer(e21);
  }
  elementCount(e21) {
    return e21.indices.get(O2.POSITION).length;
  }
  write(e21, t24, r22, i21, s19) {
    if (m6(r22, this.vertexBufferLayout, e21, t24, i21, s19), this.screenSizeEnabled) {
      if (!r22.vertexAttributes.has(O2.OFFSET))
        throw new Error(`${O2.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);
      {
        const e22 = r22.vertexAttributes.get(O2.OFFSET), a25 = r22.indices.get(O2.OFFSET);
        e8(3 === e22.size);
        const n20 = i21.getField(O2.OFFSET, i6);
        if (!n20)
          throw new Error("unable to acquire view for " + O2.OFFSET);
        y5(a25, e22.data, t24, n20, s19);
      }
    }
  }
};
var L3 = n2();
var w11 = n2();

// node_modules/@arcgis/core/views/3d/interactive/visualElements/VerticesVisualElement.js
var _7 = class extends n13 {
  constructor(e21) {
    super(e21), this.view = null, this._renderOccluded = o7.OccludeAndTransparent, this._vertices = null, this._spatialReference = null, this._color = y7.colorToVec4(y7.reshapeManipulators.vertex.color), this._size = y7.reshapeManipulators.vertex.size, this._outlineColor = y7.colorToVec4(y7.reshapeManipulators.vertex.outlineColor), this._outlineSize = y7.reshapeManipulators.vertex.outlineSize, this._elevationInfo = null, this.applyProps(e21);
  }
  get renderOccluded() {
    return this._renderOccluded;
  }
  set renderOccluded(e21) {
    e21 !== this._renderOccluded && (this._renderOccluded = e21, this._updateMaterial(), this._updateOutlineMaterial());
  }
  get vertices() {
    return this._vertices;
  }
  set vertices(e21) {
    this._vertices = e21, this.recreateGeometry();
  }
  get spatialReference() {
    return this._spatialReference;
  }
  set spatialReference(e21) {
    this._spatialReference = e21, this.recreateGeometry();
  }
  get color() {
    return this._color;
  }
  set color(e21) {
    D(e21, this._color) || (a2(this._color, e21), this._updateMaterial());
  }
  get size() {
    return this._size;
  }
  set size(e21) {
    e21 !== this._size && (this._size = e21, this._updateMaterial());
  }
  get outlineColor() {
    return this._outlineColor;
  }
  set outlineColor(e21) {
    D(e21, this._outlineColor) || (a2(this._outlineColor, e21), this._updateOutlineMaterial());
  }
  get outlineSize() {
    return this._outlineSize;
  }
  set outlineSize(e21) {
    e21 !== this._outlineSize && (this._outlineSize = e21, this._updateOutlineMaterial());
  }
  get elevationInfo() {
    return this._elevationInfo;
  }
  set elevationInfo(e21) {
    this._elevationInfo = e21, this.recreateGeometry();
  }
  get _vertexMaterialParameters() {
    return { color: this._color, transparent: this._color[3] < 1, screenSizeScale: this.size, renderOccluded: this._renderOccluded };
  }
  get _vertexOutlineMaterialParameters() {
    return { color: this._outlineColor, transparent: this._outlineColor[3] < 1, screenSizeScale: this.size + 2 * this.outlineSize, renderOccluded: this._renderOccluded };
  }
  _updateMaterial() {
    this.attached && this._vertexMaterial.setParameters(this._vertexMaterialParameters);
  }
  _updateOutlineMaterial() {
    this.attached && this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters);
  }
  _createRenderGeometries() {
    const r22 = this.vertices;
    if (t(r22) || 0 === r22.length)
      return [];
    const i21 = 0.5, s19 = 0.5, a25 = t18(r22, this.spatialReference, this.view.elevationProvider, this.view.renderCoordsHelper, h13.fromElevationInfo(this.elevationInfo)), o18 = [], c16 = a25.numVertices, h26 = a25.position;
    for (let e21 = 0; e21 < c16; ++e21) {
      const r23 = o2(p17, h26[3 * e21 + 0], h26[3 * e21 + 1], h26[3 * e21 + 2]), a26 = m16(i21, r23), l21 = m16(s19, r23);
      o18.push({ vertexGeometry: a26, vertexOutlineGeometry: l21 });
    }
    return o18;
  }
  createGeometries(e21) {
    const t24 = this._createRenderGeometries();
    for (const { vertexGeometry: r22, vertexOutlineGeometry: i21 } of t24)
      e21.addGeometry(r22, this._vertexMaterial), e21.addGeometry(i21, this._vertexOutlineMaterial);
  }
  createExternalResources() {
    this._vertexMaterial = new v12({ ...this._vertexMaterialParameters, writeDepth: true, cullFace: n9.Back, screenSizeEnabled: true }), this._vertexOutlineMaterial = new v12({ ...this._vertexOutlineMaterialParameters, transparent: true, writeDepth: true, cullFace: n9.Front, screenSizeEnabled: true, shadingEnabled: false });
  }
  destroyExternalResources() {
    this._vertexMaterial = null, this._vertexOutlineMaterial = null;
  }
  forEachExternalMaterial(e21) {
    e21(this._vertexMaterial), e21(this._vertexOutlineMaterial);
  }
};
var p17 = n2();
function m16(e21, t24) {
  return T3(e21, 16, 16, { offset: t24 });
}

// node_modules/@arcgis/core/views/3d/layers/graphics/GraphicState.js
var e19 = class extends n5.EventedAccessor {
  constructor(r22) {
    super(r22), this.tracking = false, this.displaying = false, this.isDraped = false;
  }
};
e3([y2({ constructOnly: true })], e19.prototype, "graphic", void 0), e3([y2()], e19.prototype, "tracking", void 0), e3([y2()], e19.prototype, "displaying", void 0), e3([y2()], e19.prototype, "isDraped", void 0), e19 = e3([n4("esri.views.3d.layers.graphics.GraphicState")], e19);

// node_modules/@arcgis/core/views/3d/interactive/editingTools/draw/DrawGraphicTool3D.js
var T8 = class extends Z3 {
  constructor(e21) {
    super(e21), this._activeVertexVisualElement = null, this._createGraphicState = null, this._outlineVisualElement = null, this._verticesVisualElement = null, this._verticalLineVisualElement = null, this.geometryType = null, this.type = "draw-3d";
  }
  initialize() {
    const { mode: e21, offset: t24 } = this.elevationInfo;
    this.internalGraphicsLayer.elevationInfo = new x4({ mode: e21, offset: t24 });
  }
  normalizeCtorArgs(e21) {
    var _a;
    if (!e21.elevationInfo) {
      const t24 = (_a = e21.hasZ) != null ? _a : true;
      return { ...e21, elevationInfo: s10(t24) };
    }
    return e21;
  }
  initializeGraphic(e21) {
    const i21 = this._createGraphicState = new e19({ graphic: e21 });
    return r5([this.view.maskOccludee(e21), this.view.trackGraphicState(i21), l3(() => ({ element: this._outlineVisualElement, isDraped: i21.isDraped }), ({ element: e22, isDraped: t24 }) => {
      o(e22, (e23) => e23.isDraped = t24);
    }, h4)]);
  }
  makeDrawOperation() {
    const { geometryType: e21 } = this, t24 = "circle" !== e21 && "rectangle" !== e21;
    return new C2({ view: this.view, manipulators: this.manipulators, geometryType: q5(e21), drawingMode: this.mode, hasZ: this.hasZ, defaultZ: this.defaultZ, snapToSceneEnabled: this.snapToScene, drawSurface: new c7(this.view, this.elevationInfo, [this.internalGraphicsLayer]), elevationDrawSurface: new o12(this.elevationInfo, this.defaultZ, this.view, this.internalGraphicsLayer), hasM: false, elevationInfo: this.elevationInfo, snappingManager: this.snappingManager, snappingVisualizer: new _6(), segmentLabels: t24 ? new a18() : null, labelOptions: this.labelOptions, tooltipOptions: this.tooltipOptions, isDraped: r(this._createGraphicState) ? this._createGraphicState.isDraped : "on-the-ground" === u6(this.hasZ, this.elevationInfo) });
  }
  onActiveVertexChanged(e21) {
    const { view: t24 } = this;
    return r(this._activeVertexVisualElement) ? (this._activeVertexVisualElement.vertices = [e21], this._updateVerticalLineVisualElement(e21), null) : (this._activeVertexVisualElement = new _7({ view: t24, spatialReference: t24.spatialReference, vertices: [e21], elevationInfo: this.internalGraphicsLayer.elevationInfo, renderOccluded: y7.reshapeManipulators.vertex.renderOccluded, attached: false }), this._activeVertexVisualElement.color = y7.colorToVec4(y7.reshapeManipulators.selected.color), this._activeVertexVisualElement.attached = true, this._verticalLineVisualElement = new G5({ view: t24, extensionType: y7.visualElements.zVerticalLine.extensionType, innerWidth: 1, attached: false, writeDepthEnabled: false, renderOccluded: o7.OccludeAndTransparent }), y7.visualElements.zVerticalLine.apply(this._verticalLineVisualElement), n3(() => {
      this._activeVertexVisualElement = s(this._activeVertexVisualElement), this._verticalLineVisualElement = s(this._verticalLineVisualElement);
    }));
  }
  _updateVerticalLineVisualElement(e21) {
    const t24 = this._verticalLineVisualElement;
    if (t(t24))
      return;
    const { renderCoordsHelper: i21, spatialReference: s19, elevationProvider: r22 } = this.view;
    o2(M7, e21[0], e21[1], e21[2]), b10.setFromElevationInfo(this.elevationInfo), M7[2] = m11(M7, r22, b10, i21);
    i21.toRenderCoords(M7, s19, M7) ? (t24.setStartEndFromWorldDownAtLocation(M7), t24.attached = true) : t24.attached = false;
  }
  onOutlineChanged(e21) {
    if (r(this._outlineVisualElement))
      return this._outlineVisualElement.geometry = e21, null;
    const t24 = this.internalGraphicsLayer.elevationInfo;
    return this._outlineVisualElement = new S8({ view: this.view, geometry: e21, elevationInfo: t24, isDraped: r(this._createGraphicState) ? this._createGraphicState.isDraped : "on-the-ground" === u6(this.hasZ, t24), attached: false }), y7.visualElements.lineGraphics.outline.apply(this._outlineVisualElement), y7.visualElements.lineGraphics.shadowStyle.apply(this._outlineVisualElement), this._outlineVisualElement.attached = true, this._outlineVisualElement.laserlineEnabled = true, n3(() => {
      this._outlineVisualElement = s(this._outlineVisualElement);
    });
  }
  onRegularVerticesChanged(e21) {
    return r(this._verticesVisualElement) ? (this._verticesVisualElement.vertices = e21, null) : (this._verticesVisualElement = new _7({ view: this.view, spatialReference: this.view.spatialReference, vertices: e21, elevationInfo: this.internalGraphicsLayer.elevationInfo, renderOccluded: y7.reshapeManipulators.vertex.renderOccluded, attached: false }), this._verticesVisualElement.attached = true, n3(() => {
      this._verticesVisualElement = s(this._verticesVisualElement);
    }));
  }
};
e3([y2({ constructOnly: true })], T8.prototype, "elevationInfo", void 0), e3([y2({ constructOnly: true })], T8.prototype, "geometryType", void 0), e3([y2()], T8.prototype, "type", void 0), e3([y2({ constructOnly: true })], T8.prototype, "view", void 0), T8 = e3([n4("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")], T8);
var b10 = new h13();
var M7 = n2();

// node_modules/@arcgis/core/views/3d/support/geometryUtils/ray.js
function s14(e21, n20, o18) {
  return u11(e21, e21.screenToRender(n20, p2(c2.get())), o18);
}
function u11(t24, c16, s19) {
  const u15 = p2(a8(c2.get(), c16));
  if (u15[2] = 0, !t24.unprojectFromRenderScreen(u15, s19.origin))
    return null;
  const m21 = p2(a8(c2.get(), c16));
  m21[2] = 1;
  const g16 = t24.unprojectFromRenderScreen(m21, c2.get());
  return t(g16) ? null : (e2(s19.direction, g16, s19.origin), s19);
}

// node_modules/@arcgis/core/views/3d/interactive/Manipulator3D.js
var ie = class {
  constructor(e21) {
    this._camera = new J(), this._elevation = { offset: 0, override: null }, this.collisionType = { type: "point" }, this.collisionPriority = 0, this._renderObjects = [], this.autoScaleRenderObjects = true, this._available = true, this._noDisplayCount = 0, this._radius = 10, this._worldSized = false, this.focusMultiplier = 2, this.touchMultiplier = 2.5, this.worldOriented = false, this._modelTransform = e6(), this._worldFrame = null, this._renderLocation = n2(), this._renderLocationDirty = true, this._location = new w2({ x: 0, y: 0, z: 0 }), this._elevationAlignedLocation = new w2(), this._elevationAlignedLocationDirty = true, this.interactive = true, this.selectable = false, this.grabbable = true, this.cursor = null, this.grabCursor = null, this._grabbing = false, this.dragging = false, this._hovering = false, this._selected = false, this._state = u7.None, this._focused = false, this.events = new n5.EventEmitter(), this._screenLocation = { screenPointArray: i3(), renderScreenPointArray: x2(), pixelSize: 0 }, this._screenLocationDirty = true, this._applyObjectTransform = null, this._engineResourcesAddedToStage = false, this._engineResources = null, this._attached = false, this._engineLayer = null, this._materialIdReferences = null, this._location.spatialReference = e21.view.spatialReference;
    for (const t24 in e21)
      this[t24] = e21[t24];
    this.view.state && this.view.state.camera && this._camera.copyFrom(this.view.state.camera);
  }
  destroy() {
    this._removeResourcesFromStage(), this._engineResources = null, this.view = null, this._camera = null;
  }
  get elevationInfo() {
    return this._elevationInfo;
  }
  set elevationInfo(e21) {
    this._elevationInfo = e21, this._elevationAlignedLocationDirty = true, this._renderLocationDirty = true, this._updateEngineObject();
  }
  get renderObjects() {
    return this._renderObjects;
  }
  set renderObjects(e21) {
    this._removeResourcesFromStage(), this._engineResources = null, this._renderObjects = e21.slice(), this._updateEngineObject();
  }
  set available(e21) {
    e21 !== this._available && (this._available = e21, this._updateEngineObject());
  }
  get available() {
    return this._available;
  }
  disableDisplay() {
    return this._noDisplayCount++, 1 === this._noDisplayCount && this._updateEngineObject(), { remove: h2(() => {
      this._noDisplayCount--, 0 === this._noDisplayCount && this._updateEngineObject();
    }) };
  }
  set radius(e21) {
    e21 !== this._radius && (this._radius = e21, this._updateEngineObject());
  }
  get radius() {
    return this._radius;
  }
  set worldSized(e21) {
    e21 !== this._worldSized && (this._worldSized = e21, this._updateEngineObject());
  }
  get worldSized() {
    return this._worldSized;
  }
  get modelTransform() {
    return this._modelTransform;
  }
  set modelTransform(e21) {
    se(e21) && (this._screenLocationDirty = true), n6(this._modelTransform, e21), this._updateEngineObject();
  }
  get renderLocation() {
    return this._renderLocationDirty && (this._renderLocationDirty = false, this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation, this._renderLocation), this.worldOriented ? (this._worldFrame || (this._worldFrame = e6()), oe(this.view, this._renderLocation, this._worldFrame)) : this._worldFrame && (this._worldFrame = null)), this._renderLocation;
  }
  set renderLocation(e21) {
    this.view.renderCoordsHelper.fromRenderCoords(e21, this._location), this.elevationAlignedLocation = this._location;
  }
  get location() {
    return this._location;
  }
  set location(e21) {
    k(e21, this._location), this._renderLocationDirty = true, this._screenLocationDirty = true, this._elevationAlignedLocationDirty = true, this._updateEngineObject(), this.events.emit("location-update", { location: this._location });
  }
  get elevationAlignedLocation() {
    return this._elevationAlignedLocationDirty ? (this._evaluateElevationAlignment(), this._updateElevationAlignedLocation(), this._elevationAlignedLocation) : this._elevationAlignedLocation;
  }
  set elevationAlignedLocation(e21) {
    k(e21, this._location), this._evaluateElevationAlignment(), this._location.z -= this._elevation.offset, this._updateElevationAlignedLocation(), this._updateEngineObject(), this.events.emit("location-update", { location: this._location });
  }
  _updateElevationAlignedLocation() {
    this._elevationAlignedLocation.x = this.location.x, this._elevationAlignedLocation.y = this.location.y;
    const e21 = r(this._elevation.override) ? this._elevation.override : this.location.z || 0;
    this._elevationAlignedLocation.z = e21 + this._elevation.offset, this._elevationAlignedLocation.spatialReference = Z4(this.location.spatialReference), this._renderLocationDirty = true, this._screenLocationDirty = true, this._elevationAlignedLocationDirty = false;
  }
  grabbableForEvent() {
    return true;
  }
  get grabbing() {
    return this._grabbing;
  }
  set grabbing(e21) {
    e21 !== this._grabbing && (this._grabbing = e21, this._setFocused(this._hovering || this._grabbing), this._updateEngineObject());
  }
  get hovering() {
    return this._hovering;
  }
  set hovering(e21) {
    e21 !== this._hovering && (this._hovering = e21, this._setFocused(this._hovering || this._grabbing), this._updateEngineObject());
  }
  get selected() {
    return this._selected;
  }
  set selected(e21) {
    e21 !== this._selected && (this._selected = e21, this._updateEngineObject(), this.events.emit("select-changed", { action: e21 ? "select" : "deselect" }));
  }
  get state() {
    return this._state;
  }
  set state(e21) {
    e21 !== this._state && (this._state = e21, this._updateEngineObject());
  }
  updateStateEnabled(e21, t24) {
    t24 ? this.state |= e21 : this.state &= ~e21;
  }
  _setFocused(e21) {
    e21 !== this._focused && (this._focused = e21, this.events.emit("focus-changed", { action: true === e21 ? "focus" : "unfocus" }));
  }
  get focused() {
    return this._focused;
  }
  get screenLocation() {
    return this._ensureScreenLocation(), this._screenLocation;
  }
  _ensureScreenLocation() {
    if (!this._screenLocationDirty)
      return;
    this._screenLocation.pixelSize = this._camera.computeScreenPixelSizeAt(this.renderLocation), this._screenLocationDirty = false;
    let e21;
    if (se(this._modelTransform)) {
      const t24 = this._calculateModelTransformOffset(pe2);
      e21 = u(t24, t24, this.renderLocation);
    } else
      e21 = this.renderLocation;
    this._camera.projectToRenderScreen(e21, this._screenLocation.renderScreenPointArray), this._camera.renderToScreen(this._screenLocation.renderScreenPointArray, this._screenLocation.screenPointArray);
  }
  get applyObjectTransform() {
    return this._applyObjectTransform;
  }
  set applyObjectTransform(e21) {
    this._applyObjectTransform = e21, this._screenLocationDirty = true, this._updateEngineObject();
  }
  get attached() {
    return this._attached;
  }
  intersectionDistance(t24, i21) {
    var _a;
    if (!this.available)
      return null;
    const s19 = d(t24, re), r22 = this._getCollisionRadius(i21), n20 = -1 * this.collisionPriority;
    switch (this.collisionType.type) {
      case "point":
        if (b3(this.screenLocation.screenPointArray, s19) < r22 * r22)
          return this.screenLocation.renderScreenPointArray[2] + n20;
        break;
      case "line": {
        const e21 = this.collisionType.paths, t25 = this._getWorldToScreenObjectScale(), i22 = this._calculateObjectTransform(t25, he), a25 = r22 * this.screenLocation.pixelSize, c16 = s14(this._camera, s19, ae);
        if (t(c16))
          return null;
        for (const s20 of e21) {
          if (0 === s20.length)
            continue;
          const e22 = O(_e, s20[0], i22);
          for (let t26 = 1; t26 < s20.length; t26++) {
            const o18 = O(ue2, s20[t26], i22), r23 = B(b5(e22, o18, ne), c16);
            if (null != r23 && r23 < a25 * a25) {
              const t27 = u(c2.get(), e22, o18);
              g(t27, t27, 0.5);
              const i23 = y3(c2.get());
              return this._camera.projectToRenderScreen(t27, i23), i23[2] + n20;
            }
            r3(e22, o18);
          }
        }
        break;
      }
      case "disc": {
        const e21 = this.collisionType.direction, t25 = (_a = this.collisionType.offset) != null ? _a : f, i22 = this._getWorldToScreenObjectScale(), a25 = this._calculateObjectTransform(i22, he), c16 = r22 * this.screenLocation.pixelSize, l21 = s14(this._camera, s19, ae);
        if (t(l21))
          return null;
        const h26 = a9(ce, a25), d19 = S(me, e21, h26), u15 = O(fe, t25, a25);
        _2(u15, d19, de);
        const g16 = ge;
        if (q3(de, l21, g16) && p(g16, u15) < c16 * c16)
          return this.screenLocation.renderScreenPointArray[2] + n20;
        break;
      }
      case "ribbon": {
        const { paths: e21, direction: t25 } = this.collisionType, i22 = this._getWorldToScreenObjectScale(), a25 = this._calculateObjectTransform(i22, he), c16 = r22 * this._camera.computeScreenPixelSizeAt(this.renderLocation), l21 = s14(this._camera, s19, ae);
        if (t(l21))
          return null;
        const d19 = a9(ce, a25), u15 = S(me, t25, d19), g16 = this._calculateModelTransformPosition(fe);
        _2(g16, u15, de);
        const m21 = ge;
        if (!q3(de, l21, m21))
          break;
        for (const s20 of e21) {
          if (0 === s20.length)
            continue;
          const e22 = O(_e, s20[0], a25);
          for (let t26 = 1; t26 < s20.length; t26++) {
            const i23 = O(ue2, s20[t26], a25), o18 = M3(b5(e22, i23, ne), m21);
            if (null != o18 && o18 < c16 * c16) {
              const t27 = u(c2.get(), e22, i23);
              g(t27, t27, 0.5);
              const s21 = y3(c2.get());
              return this._camera.projectToRenderScreen(t27, s21), s21[2] + n20;
            }
            r3(e22, i23);
          }
        }
        break;
      }
      default:
        n7(this.collisionType);
    }
    return null;
  }
  attach(e21 = { manipulator3D: {} }) {
    var _a;
    if (!this.view._stage)
      return;
    const t24 = e21.manipulator3D;
    if (t(t24.engineLayerId)) {
      const e22 = new l14({ isPickable: false, updatePolicy: i8.SYNC });
      this.view._stage.add(e22), t24.engineLayerId = e22.id, this._engineLayer = e22;
    } else
      ((_a = this.view._stage) == null ? void 0 : _a.getObject) && (this._engineLayer = this.view._stage.getObject(t24.engineLayerId));
    t24.engineLayerReferences = (t24.engineLayerReferences || 0) + 1, this._materialIdReferences = t24.materialIdReferences, t(this._materialIdReferences) && (this._materialIdReferences = /* @__PURE__ */ new Map(), t24.materialIdReferences = this._materialIdReferences), this._camera.copyFrom(this.view.state.camera), this._attached = true, this._updateEngineObject(), An(this._location.spatialReference, this.view.spatialReference) || (this.location = new w2({ x: 0, y: 0, z: 0, spatialReference: this.view.spatialReference }));
  }
  detach(e21 = { manipulator3D: {} }) {
    const t24 = e21.manipulator3D;
    t24.engineLayerReferences--;
    const i21 = 0 === t24.engineLayerReferences;
    i21 && (t24.engineLayerId = null), this._removeResourcesFromStage(i21), this._engineResources = null, this._engineLayer = null, this._materialIdReferences = null, this._attached = false;
  }
  onViewChange() {
    this._camera.copyFrom(this.view.state.camera), this._screenLocationDirty = true, this._updateEngineObject();
  }
  onElevationChange(e21) {
    pn(this.location, be, e21.spatialReference), F2(e21.extent, be) && (this.location = this._location);
  }
  _evaluateElevationAlignment(e21 = this.location) {
    if (t(this.elevationInfo))
      return false;
    let t24 = null, i21 = 0;
    const s19 = i(this.elevationInfo.offset, 0);
    switch (this.elevationInfo.mode) {
      case "on-the-ground":
        t24 = i(i12(this.view.elevationProvider, e21, "ground"), 0);
        break;
      case "relative-to-ground":
        i21 = i(i12(this.view.elevationProvider, e21, "ground"), 0) + s19;
        break;
      case "relative-to-scene":
        i21 = i(i12(this.view.elevationProvider, e21, "scene"), 0) + s19;
        break;
      case "absolute-height":
        i21 = s19;
    }
    return (i21 !== this._elevation.offset || t24 !== this._elevation.override) && (this._elevation.offset = i21, this._elevation.override = t24, true);
  }
  _updateEngineObject() {
    if (!this._attached)
      return;
    if (!this.available)
      return void this._removeResourcesFromStage();
    const e21 = this._getWorldToScreenObjectScale(), t24 = he;
    if (true === this.autoScaleRenderObjects) {
      const i22 = this._getFocusedSize(this._radius, this.focused) * e21;
      this._calculateObjectTransform(i22, t24);
    } else
      this._calculateObjectTransform(e21, t24);
    const { objectsByState: i21 } = this._ensureEngineResources(), s19 = (this.focused ? t12.Focused : t12.Unfocused) | (this.selected ? t12.Selected : t12.Unselected), o18 = this._noDisplayCount > 0;
    for (const { stateMask: r22, objects: n20 } of i21) {
      if (o18) {
        for (const e23 of n20)
          e23.setVisible(false);
        continue;
      }
      const e22 = (r22 & t12.All) !== t12.None, i22 = (r22 & u7.All) !== u7.None, a25 = !e22 || (s19 & r22) == (r22 & t12.All), c16 = !i22 || (this.state & r22) == (r22 & u7.All);
      if (a25 && c16)
        for (const s20 of n20)
          s20.setVisible(true), s20.transformation = t24;
      else
        for (const t25 of n20)
          t25.setVisible(false);
    }
  }
  _ensureEngineResources() {
    if (t(this._engineResources)) {
      const e21 = e(this._engineLayer), t24 = [], i21 = /* @__PURE__ */ new Set();
      this.renderObjects.forEach(({ material: e22 }) => {
        i21.has(e22) || (t24.push(e22), i21.add(e22));
      });
      const s19 = (e22, t25) => {
        const { geometry: i22, material: s20, transform: o19 } = t25;
        Array.isArray(i22) ? i22.forEach((t26) => e22.addGeometry(t26, s20, o19)) : e22.addGeometry(i22, s20, o19);
      }, o18 = /* @__PURE__ */ new Map();
      this._renderObjects.forEach((e22) => {
        const t25 = new x8({ castShadow: false });
        s19(t25, e22);
        const i22 = e22.stateMask || 0, r23 = o18.get(i22) || [];
        r23.push(t25), o18.set(i22, r23);
      });
      const r22 = [];
      o18.forEach((e22, t25) => r22.push({ stateMask: t25, objects: e22 })), this._engineResources = { objectsByState: r22, layer: e21, materials: t24 };
    }
    return this._addResourcesToStage(), this._engineResources;
  }
  _addResourcesToStage() {
    if (this._engineResourcesAddedToStage || t(this._engineResources))
      return;
    const { objectsByState: e21, layer: t24, materials: i21 } = this._engineResources;
    i21.forEach((e22) => {
      const t25 = e(this._materialIdReferences), i22 = t25.get(e22.id) || 0;
      0 === i22 && this.view._stage.add(e22), t25.set(e22.id, i22 + 1);
    }), e21.forEach(({ objects: e22 }) => {
      t24.addMany(e22), this.view._stage.addMany(e22);
    }), this._engineResourcesAddedToStage = true;
  }
  _removeResourcesFromStage(e21 = false) {
    if (!this._engineResourcesAddedToStage || t(this._engineResources) || !this.view._stage)
      return;
    const { objectsByState: t24, layer: i21, materials: s19 } = this._engineResources;
    t24.forEach(({ objects: e22 }) => {
      i21.removeMany(e22), this.view._stage.removeMany(e22);
    }), s19.forEach((e22) => {
      const t25 = e(this._materialIdReferences), i22 = t25.get(e22.id);
      1 === i22 ? (this.view._stage.remove(e22), t25.delete(e22.id)) : t25.set(e22.id, i22 - 1);
    }), e21 && this.view._stage.remove(i21), this._engineResourcesAddedToStage = false;
  }
  _getCollisionRadius(e21) {
    return this._getFocusedSize(this.radius, true) * ("touch" === e21 ? this.touchMultiplier : 1);
  }
  _getFocusedSize(e21, t24) {
    return e21 * (t24 ? this.focusMultiplier : 1);
  }
  _getWorldToScreenObjectScale() {
    return this._worldSized ? 1 : this.screenLocation.pixelSize;
  }
  _calculateModelTransformPosition(e21) {
    const t24 = this._getWorldToScreenObjectScale(), i21 = this._calculateObjectTransform(t24, le);
    return o2(e21, i21[12], i21[13], i21[14]);
  }
  _calculateModelTransformOffset(e21) {
    const t24 = this._calculateModelTransformPosition(e21);
    return e2(e21, t24, this.renderLocation);
  }
  _calculateObjectTransform(e21, t24) {
    return s5(t24, e21, 0, 0, 0, 0, e21, 0, 0, 0, 0, e21, 0, 0, 0, 0, 1), this._worldFrame && u4(t24, t24, this._worldFrame), u4(t24, t24, this._modelTransform), t24[12] += this.renderLocation[0], t24[13] += this.renderLocation[1], t24[14] += this.renderLocation[2], t24[15] = 1, r(this._applyObjectTransform) && this._applyObjectTransform(t24), t24;
  }
  get test() {
    let e21 = false;
    if (r(this._engineResources))
      for (const t24 in this._engineResources.objectsByState) {
        const i21 = this._engineResources.objectsByState[t24];
        for (const t25 of i21.objects)
          if (t25.isVisible) {
            e21 = true;
            break;
          }
        if (e21)
          break;
      }
    return { areAnyResourcesVisible: e21 };
  }
};
function se(e21) {
  return 0 !== e21[12] || 0 !== e21[13] || 0 !== e21[14];
}
function oe(e21, t24, s19) {
  switch (e21.viewingMode) {
    case "local":
      return r6(s19), true;
    case "global": {
      const o18 = u3(e21.renderCoordsHelper.spatialReference);
      return pe(t24, 0, _e, 0, o18.radius), Xn(m(_e[0]), m(_e[1]), s19), true;
    }
  }
}
var re = i3();
var ne = v4();
var ae = d3();
var ce = e5();
var le = e6();
var he = e6();
var de = p5();
var _e = n2();
var ue2 = n2();
var ge = n2();
var me = n2();
var fe = n2();
var pe2 = n2();
var be = new w2({ x: 0, y: 0, z: 0, spatialReference: null });

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterialTechnique.js
var _8 = class extends e10 {
  initializeProgram(e21) {
    return new o9(e21.rctx, _8.shader.get().build(this.configuration), E2);
  }
  _setPipelineState(e21, r22) {
    const i21 = this.configuration, s19 = e21 === o8.NONE, o18 = e21 === o8.FrontFace;
    return W({ blending: i21.output !== h8.Color && i21.output !== h8.Alpha || !i21.transparent ? null : s19 ? C8 : A5(e21), culling: h11(i21.cullFace), depthTest: { func: l10(e21) }, depthWrite: s19 ? i21.writeDepth && a10 : E4(e21), colorWrite: _3, stencilWrite: i21.hasOccludees ? e11 : null, stencilTest: i21.hasOccludees ? r22 ? o10 : f8 : null, polygonOffset: s19 || o18 ? null : a11(i21.enableOffset) });
  }
  initializePipeline() {
    return this._occludeePipelineState = this._setPipelineState(this.configuration.transparencyPassType, true), this._setPipelineState(this.configuration.transparencyPassType, false);
  }
  getPipelineState(e21, t24) {
    return t24 ? this._occludeePipelineState : super.getPipelineState(e21, t24);
  }
};
_8.shader = new t9(w7, () => import("./ImageMaterial.glsl-MAI5H4UQ.js"));
var C8 = s8(R2.ONE, R2.ONE_MINUS_SRC_ALPHA);
var w12 = class extends s9 {
  constructor() {
    super(...arguments), this.output = h8.Color, this.cullFace = n9.None, this.hasSlicePlane = false, this.transparent = false, this.enableOffset = true, this.writeDepth = true, this.hasOccludees = false, this.transparencyPassType = o8.NONE, this.hasMultipassTerrain = false, this.cullAboveGround = false;
  }
};
e3([e12({ count: h8.COUNT })], w12.prototype, "output", void 0), e3([e12({ count: n9.COUNT })], w12.prototype, "cullFace", void 0), e3([e12()], w12.prototype, "hasSlicePlane", void 0), e3([e12()], w12.prototype, "transparent", void 0), e3([e12()], w12.prototype, "enableOffset", void 0), e3([e12()], w12.prototype, "writeDepth", void 0), e3([e12()], w12.prototype, "hasOccludees", void 0), e3([e12({ count: o8.COUNT })], w12.prototype, "transparencyPassType", void 0), e3([e12()], w12.prototype, "hasMultipassTerrain", void 0), e3([e12()], w12.prototype, "cullAboveGround", void 0);

// node_modules/@arcgis/core/views/3d/webgl-engine/materials/ImageMaterial.js
var p18 = class extends d5 {
  constructor(e21) {
    super(e21, new d14()), this.supportsEdges = true, this._configuration = new w12();
  }
  getConfiguration(e21, t24) {
    return this._configuration.output = e21, this._configuration.cullFace = this.parameters.cullFace, this._configuration.hasSlicePlane = this.parameters.hasSlicePlane, this._configuration.transparent = this.parameters.transparent, this._configuration.writeDepth = this.parameters.writeDepth, this._configuration.hasOccludees = this.parameters.hasOccludees, this._configuration.transparencyPassType = t24.transparencyPassType, this._configuration.enableOffset = t24.camera.relativeElevation < S3, this._configuration.hasMultipassTerrain = t24.multipassTerrain.enabled, this._configuration.cullAboveGround = t24.multipassTerrain.cullAboveGround, this._configuration;
  }
  intersect(e21, t24, r22, a25, s19, i21, n20) {
    x5(e21, t24, a25, s19, i21, void 0, n20);
  }
  requiresSlot(t24, r22) {
    if (r22 === h8.Color || r22 === h8.Alpha || r22 === h8.Highlight) {
      if (t24 === E5.DRAPED_MATERIAL)
        return true;
      if (r22 === h8.Highlight)
        return t24 === E5.OPAQUE_MATERIAL;
      return t24 === (this.parameters.transparent ? this.parameters.writeDepth ? E5.TRANSPARENT_MATERIAL : E5.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL : E5.OPAQUE_MATERIAL);
    }
    return false;
  }
  createGLMaterial(e21) {
    return new m17(e21);
  }
  createBufferWriter() {
    return new v9(f12);
  }
};
var m17 = class extends h9 {
  constructor(e21) {
    super({ ...e21, ...e21.material.parameters });
  }
  _updateParameters(e21) {
    return this.updateTexture(this._material.parameters.textureId), this._material.setParameters(this.textureBindParameters), this.ensureTechnique(_8, e21);
  }
  _updateOccludeeState(e21) {
    e21.hasOccludees !== this._material.parameters.hasOccludees && (this._material.setParameters({ hasOccludees: e21.hasOccludees }), this._updateParameters(e21));
  }
  beginSlot(t24) {
    return this._output !== h8.Color && this._output !== h8.Alpha || this._updateOccludeeState(t24), this._updateParameters(t24);
  }
};
var d14 = class extends h10 {
  constructor() {
    super(...arguments), this.transparent = false, this.writeDepth = true, this.hasSlicePlane = false, this.cullFace = n9.None, this.hasOccludees = false, this.opacity = 1, this.textureId = null, this.initTextureTransparent = true;
  }
};

// node_modules/@arcgis/core/views/3d/interactive/manipulatorUtils.js
function A11(e21, t24 = o7.OccludeAndTransparent, r22 = true) {
  const a25 = r7(e21[0], e21[1], e21[2], e21.length > 3 ? e21[3] : 1), n20 = e21[3] < 1;
  return r22 ? new v12({ color: a25, transparent: n20, writeDepth: true, cullFace: n9.Back, renderOccluded: t24 }) : new m12({ color: a25, transparent: n20, writeDepth: true, cullFace: n9.Back, renderOccluded: t24 });
}
function I3(e21, t24 = o7.OccludeAndTransparent) {
  const r22 = r7(e21[0], e21[1], e21[2], 4 === e21.length ? e21[3] : 1);
  return new m12({ color: r22, transparent: true, writeDepth: true, cullFace: n9.Front, renderOccluded: t24 });
}
var L4 = Object.freeze({ calloutLength: 40, calloutWidth: 1, discRadius: 27, focusMultiplier: 1.1, calloutColor: r2(1, 0.5, 0) });
function R3(e21, t24) {
  const r22 = new ie({ view: e21, autoScaleRenderObjects: false, collisionPriority: 1, metadata: t24.metadata });
  return T9(r22, t24), r22;
}
function T9(e21, t24) {
  var _a, _b, _c, _d, _e3, _f, _g, _h;
  const r22 = (_b = t24.material) != null ? _b : new p18({ transparent: true, writeDepth: false, textureId: (_a = t24.texture) == null ? void 0 : _a.id, renderOccluded: o7.Opaque }), a25 = (_c = t24.focusMultiplier) != null ? _c : L4.focusMultiplier, n20 = (_d = t24.calloutLength) != null ? _d : L4.calloutLength, o18 = L4.discRadius * ((_e3 = t24.discScale) != null ? _e3 : 1), i21 = o18 * a25, c16 = (e22) => {
    const t25 = [0, 1, 2, 2, 3, 0];
    return new d4([[O2.POSITION, { size: 3, data: [n20 - e22, -e22, 0, n20 + e22, -e22, 0, n20 + e22, e22, 0, n20 - e22, e22, 0], exclusive: true }], [O2.UV0, { size: 2, data: [0, 0, 1, 0, 1, 1, 0, 1] }]], [[O2.POSITION, t25], [O2.UV0, t25]]);
  }, l21 = q6([[0, 0, 0], [n20 - o18, 0, 0]]), m21 = q6([[0, 0, 0], [n20 - i21, 0, 0]]), u15 = L4.calloutColor, d19 = (_f = t24.calloutWidth) != null ? _f : L4.calloutWidth, p23 = new (d19 > 1 ? H5 : F4)({ width: d19, color: r7(u15[0], u15[1], u15[2], (_g = t24.calloutOpacity) != null ? _g : 1), renderOccluded: o7.OccludeAndTransparent }), f18 = (_h = t24.customStateMask) != null ? _h : u7.None;
  e21.collisionType = { type: "disc", direction: [0, 0, 1], offset: [n20, 0, 0] }, e21.focusMultiplier = a25, e21.metadata = t24.metadata, e21.radius = o18, e21.renderObjects = [{ geometry: c16(o18), material: r22, stateMask: t12.Unfocused | f18 }, { geometry: l21, material: p23, stateMask: t12.Unfocused | f18 }, { geometry: c16(i21), material: r22, stateMask: t12.Focused | f18 }, { geometry: m21, material: p23, stateMask: t12.Focused | f18 }];
}
var x12 = Object.freeze({ autoScaleRenderObjects: false, worldSized: true });
function z4(e21, t24, i21, c16) {
  const s19 = e2(c2.get(), e21, i21), u15 = D5(s19, _(c2.get(), c16, s19), i21, f6.get());
  h5(u15, u15);
  const d19 = O(c2.get(), t24, u15);
  return Math.atan2(d19[1], d19[0]);
}
function D5(e21, t24, r22, a25) {
  const o18 = z(c2.get(), e21), c16 = z(c2.get(), t24), s19 = _(c2.get(), o18, c16);
  return a25[0] = o18[0], a25[1] = o18[1], a25[2] = o18[2], a25[3] = 0, a25[4] = c16[0], a25[5] = c16[1], a25[6] = c16[2], a25[7] = 0, a25[8] = s19[0], a25[9] = s19[1], a25[10] = s19[2], a25[11] = 0, a25[12] = r22[0], a25[13] = r22[1], a25[14] = r22[2], a25[15] = 1, a25;
}
function N2(t24, r22) {
  const a25 = t24.getViewForGraphic(r22);
  return r(a25) && "computeAttachmentOrigin" in a25 ? a25.computeAttachmentOrigin(r22, t24.spatialReference) : null;
}
function C9(t24, r22, a25) {
  const n20 = N2(t24, a25);
  r(n20) ? r22.elevationAlignedLocation = n20 : V6(r22, a25.geometry);
}
function V6(e21, r22) {
  if (t(r22))
    return;
  const a25 = "mesh" === r22.type ? r22.anchor : A8(r22);
  t(a25) || (e21.location = p12(a25));
}

// node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulatorUtils.js
function t19(o18, t24 = f9(o18)) {
  return "on-the-ground" !== t24.mode && !(t(o18.geometry) || !o18.geometry.hasZ);
}

// node_modules/@arcgis/core/views/3d/interactive/editingTools/GrabbingState.js
var N3;
!function(N6) {
  N6[N6.NONE = 0] = "NONE", N6[N6.ANY = 1] = "ANY", N6[N6.Z = 2] = "Z", N6[N6.XY = 4] = "XY";
}(N3 || (N3 = {}));

// node_modules/@arcgis/core/views/3d/interactive/editingTools/ManipulatorType.js
var A12;
!function(A19) {
  A19[A19.TRANSLATE_Z = 0] = "TRANSLATE_Z", A19[A19.TRANSLATE_XY = 1] = "TRANSLATE_XY", A19[A19.SCALE = 2] = "SCALE", A19[A19.ROTATE = 3] = "ROTATE", A19[A19.SCALE_ROTATE = 4] = "SCALE_ROTATE";
}(A12 || (A12 = {}));

// node_modules/@arcgis/core/views/3d/interactive/editingTools/ManipulatorState.js
var a20 = class {
  constructor() {
    this.grabbingState = N3.NONE, this.zManipulator = null, this.firstSelected = null, this.numSelected = 0, this.firstGrabbedXY = null;
  }
  update(a25) {
    this.grabbingState = N3.NONE, this.zManipulator = null, this.numSelected = 0, this.firstSelected = null, this.firstGrabbedXY = null, a25.forEachManipulator((a26, s19) => {
      if (s19 === A12.TRANSLATE_Z && (this.zManipulator = a26), a26 instanceof ie && (a26.selected && (0 === this.numSelected && (this.firstSelected = a26), this.numSelected++), t(this.firstGrabbedXY) && a26.grabbing && s19 === A12.TRANSLATE_XY && (this.firstGrabbedXY = a26)), a26.grabbing)
        switch (this.grabbingState |= N3.ANY, s19) {
          case A12.TRANSLATE_Z:
            this.grabbingState |= N3.Z;
            break;
          case A12.TRANSLATE_XY:
            this.grabbingState |= N3.XY;
        }
    });
  }
};

// node_modules/@arcgis/core/views/3d/interactive/editingTools/lineGraphicVisualElementUtils.js
function b11(t24) {
  const { view: a25, graphic: n20 } = t24, i21 = new e19({ graphic: n20 }), l21 = j8(t24, i21), r22 = [l21, S9(t24, l21.visualElement, i21), a25.maskOccludee(n20), a25.trackGraphicState(i21)];
  return { visualElement: l21.visualElement, remove: () => r5(r22).remove() };
}
function j8(a25, n20) {
  const { view: i21, graphic: r22 } = a25, o18 = new S8({ view: i21, geometry: L5(r22) ? r22.geometry : null, elevationInfo: f9(r22), attached: false });
  y7.visualElements.lineGraphics.shadowStyle.apply(o18);
  const s19 = () => {
    o18.attached = n20.displaying;
  };
  y7.visualElements.lineGraphics.outline.apply(o18);
  const p23 = [l3(() => n20.displaying, s19), l3(() => n20.isDraped, (e21) => {
    o18.isDraped = e21;
  }), n20.on("changed", () => o18.geometry = L5(r22) ? r22.geometry : null), t3(o18)];
  return s19(), { visualElement: o18, remove: () => r5(p23).remove() };
}
function S9(i21, r22, o18) {
  const { graphic: s19, view: p23 } = i21, m21 = [], d19 = f9(s19), y14 = "on-the-ground" === d19.mode || !d19.offset && "absolute-height" !== d19.mode, E14 = new a20(), b15 = new G5({ view: p23, extensionType: y7.visualElements.zVerticalLine.extensionType, innerWidth: 1, attached: false, writeDepthEnabled: false, renderOccluded: o7.OccludeAndTransparent });
  y7.visualElements.pointGraphics.shadowStyle.apply(b15);
  const j14 = m(y7.visualElements.heightPlaneAngleCutoff), S13 = new d12({ view: p23, attached: false, angleCutoff: j14 });
  y7.visualElements.heightPlane.apply(S13);
  let T14 = 1, A19 = 1;
  const D12 = () => {
    if (E14.update(i21), !o18.displaying || y14 && (o18.isDraped || !L5(s19) || !s19.geometry.hasZ))
      return r22.laserlineEnabled = false, b15.attached = false, void (S13.attached = false);
    r22.laserlineEnabled = true;
    {
      const e21 = E14.grabbingState & N3.XY ? y7.visualElements.laserlineAlphaMultiplier : 1;
      e21 !== T14 && (T14 = e21, y7.visualElements.lineGraphics.shadowStyle.apply(r22, e21), y7.visualElements.pointGraphics.shadowStyle.apply(b15, e21));
    }
    {
      const e21 = E14.grabbingState & N3.Z ? y7.visualElements.laserlineAlphaMultiplier : 1;
      e21 !== A19 && (A19 = e21, y7.visualElements.heightPlane.apply(S13, e21));
    }
    M8(b15, E14), G6(i21, r22, S13, E14);
  };
  y7.visualElements.zVerticalLine.apply(b15), m21.push(o18.on("changed", D12), l3(() => o18.displaying, D12), r22.events.on("attachment-origin-changed", D12), t3(b15), t3(S13));
  const C15 = [], O7 = () => {
    r5(C15).remove(), C15.length = 0, i21.forEachManipulator((e21) => C15.push(e21.events.on("grab-changed", D12))), i21.forEachManipulator((e21) => C15.push(e21.events.on("select-changed", D12))), D12();
  };
  return O7(), m21.push(i21.onManipulatorsChanged(O7), o3(() => r5(C15))), r5(m21);
}
function M8(e21, t24) {
  const a25 = 1 === t24.numSelected ? t24.firstSelected : t24.numSelected > 1 && r(t24.firstGrabbedXY) ? t24.firstGrabbedXY : null;
  r(a25) ? (e21.setStartEndFromWorldDownAtLocation(a25.renderLocation), e21.attached = true) : e21.attached = false;
}
function G6(e21, t24, a25, n20) {
  if (n20.numSelected > 0) {
    o2(T10, 0, 0, 0);
    let t25 = 0;
    e21.forEachManipulator((e22, a26) => {
      a26 === A12.TRANSLATE_XY && e22.selected && e22 instanceof ie && (u(T10, T10, e22.renderLocation), t25++);
    }), t25 > 0 ? (a25.heightManifoldTarget = g(T10, T10, 1 / t25), a25.attached = true) : a25.attached = false;
  } else {
    const n21 = t24.attachmentOrigin;
    r(n21) && e21.view.renderCoordsHelper.toRenderCoords(n21, T10) ? (a25.heightManifoldTarget = T10, a25.attached = true) : a25.attached = false;
  }
}
function L5(e21) {
  return r(e21.geometry) && ("polygon" === e21.geometry.type || "polyline" === e21.geometry.type);
}
var T10 = n2();

// node_modules/@arcgis/core/views/3d/interactive/editingTools/originGraphicVisualElementUtils.js
function M9(t24) {
  const { view: n20, graphic: i21 } = t24, o18 = new e19({ graphic: i21 }), a25 = [], r22 = C10(t24, o18, a25);
  return P8(t24, o18, a25, r22), a25.push(n20.trackGraphicState(o18)), { visualElement: r22, remove() {
    r5(a25).remove();
  } };
}
function P8(e21, n20, s19, p23) {
  const { view: m21, graphic: u15 } = e21, f18 = new G5({ view: m21, extensionType: y7.visualElements.zVerticalLine.extensionType, innerWidth: 1, attached: false, writeDepthEnabled: false, renderOccluded: o7.OccludeAndTransparent });
  y7.visualElements.zVerticalLine.apply(f18);
  const b15 = new d12({ view: m21, intersectsLineInfinite: true, attached: false });
  y7.visualElements.pointGraphics.shadowStyle.apply(b15);
  const A19 = m(y7.visualElements.heightPlaneAngleCutoff), M14 = new d12({ view: m21, attached: false, angleCutoff: A19 });
  y7.visualElements.heightPlane.apply(M14);
  const P12 = f9(e21.graphic), C15 = h13.fromElevationInfo(P12), R7 = "on-the-ground" === P12.mode || !P12.offset && "absolute-height" !== P12.mode, U7 = new a20();
  let D12 = 1, I7 = 1;
  const T14 = () => {
    U7.update(e21);
    const t24 = G7(u15), i21 = R7 && (n20.isDraped || t(t24) || !t24.hasZ);
    let r22 = true;
    if (!i21 && r(t24)) {
      const e22 = m11(t24, m21.elevationProvider, C15, m21.renderCoordsHelper);
      o2(V7, t24.x, t24.y, e22), jn(V7, t24.spatialReference, V7, m21.renderCoordsHelper.spatialReference), f18.setStartEndFromWorldDownAtLocation(V7), b15.intersectsWorldUpAtLocation = V7;
    } else
      r22 = false;
    const s20 = U7.grabbingState & N3.Z ? y7.visualElements.laserlineAlphaMultiplier : 1;
    s20 !== D12 && (D12 = s20, y7.visualElements.heightPlane.apply(M14, s20));
    const g16 = A3(B4);
    !i21 && n20.displaying && p23.calculateMapBounds(g16) && jn(Z2(g16, V7), m21.spatialReference, V7, m21.renderCoordsHelper.spatialReference) ? (M14.heightManifoldTarget = V7, M14.attached = true) : M14.attached = false;
    const y14 = U7.grabbingState & N3.XY ? y7.visualElements.laserlineAlphaMultiplier : 1;
    y14 !== I7 && (I7 = y14, y7.visualElements.pointGraphics.shadowStyle.apply(b15, y14));
    const j14 = r22 && n20.displaying && !i21;
    b15.attached = j14, f18.attached = j14;
  };
  s19.push(l3(() => [n20.displaying, n20.isDraped], T14), n20.on("changed", T14)), e21.forEachManipulator((e22) => {
    s19.push(e22.events.on("grab-changed", T14));
  }), s19.push(t3(b15)), s19.push(t3(f18)), s19.push(t3(M14)), T14();
}
function C10(e21, n20, i21) {
  const { view: o18, graphic: a25 } = e21, r22 = new S6({ view: o18, geometry: G7(a25), elevationInfo: f9(a25), attached: false });
  return R4(e21, r22, n20, i21), i21.push(t3(r22)), r22;
}
function G7(e21) {
  const t24 = e21.geometry;
  return t(t24) ? null : "point" === t24.type ? t24 : "mesh" === t24.type ? t24.anchor.clone() : null;
}
function R4(e21, t24, n20, i21) {
  const o18 = () => t24.attached = n20.displaying;
  U4(e21, t24, n20, i21), y7.visualElements.pointGraphics.outline.apply(t24), i21.push(l3(() => n20.displaying, o18, h4));
}
function U4(e21, t24, i21, o18) {
  const { view: r22, graphic: s19 } = e21;
  let l21 = null;
  const p23 = (e22) => {
    r(l21) && (l21.remove(), l21 = null), i21.isDraped && r(e22) && (l21 = D6(r22, e22, () => {
      t24.geometry = e22;
    }));
  }, c16 = () => {
    const e22 = G7(s19);
    p23(e22), t24.geometry = e22;
  };
  o18.push(i21.on("changed", c16), o3(() => l21)), c16();
}
function D6(e21, t24, n20) {
  const i21 = e21.elevationProvider.spatialReference;
  gn(t24, V7, i21);
  const o18 = V7[0], a25 = V7[1];
  return e21.elevationProvider.on("elevation-change", (e22) => {
    w4(e22.extent, o18, a25) && n20();
  });
}
var V7 = n2();
var B4 = a6();

// node_modules/@arcgis/core/views/3d/interactive/editingTools/visualElementUtils.js
function i15(i21) {
  switch (e(i21.graphic.geometry).type) {
    case "point":
    case "mesh":
      return M9(i21);
    case "polygon":
    case "polyline":
      return b11(i21);
    default:
      return null;
  }
}

// node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/config.js
var t20 = [1, 0.5, 0];
var a21 = 128;
var e20 = 70;
var h19 = 80;
var M10 = 0.02;
var c11 = 54;
var o15 = 100;
var I4 = Math.ceil(e20 / 3 * 2);
var P9 = 160;
var i16 = 0.5;
var l17 = 24;
var n15 = 9;
var p19 = P9 + 30;
var r17 = P9 + 53;
var s15 = 60;
var x13 = 23;
var b12 = 5 * Math.PI / 12;
var d15 = 1 * Math.PI / 3;
var f15 = 10;
var g11 = 0.2;
var j9 = 30;
var k5 = 53;
var m18 = 0.2;
var q7 = 0.3;
var u12 = 200;
var v13 = 3;
var w13 = 1e6;

// node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/Manipulation.js
var t21 = class {
  constructor() {
    this._available = true;
  }
  set location(a25) {
    this._forEachManipulator3D((t24) => t24.location = a25);
  }
  set elevationAlignedLocation(a25) {
    this._forEachManipulator3D((t24) => t24.elevationAlignedLocation = a25);
  }
  set elevationInfo(a25) {
    this._forEachManipulator3D((t24) => t24.elevationInfo = a25);
  }
  get renderLocation() {
    let a25;
    return this._forEachManipulator3D((t24) => {
      a25 || (a25 = t24.renderLocation);
    }), a25;
  }
  get available() {
    return this._available;
  }
  set available(a25) {
    this._available = a25, this._forEachManipulator3D((t24) => t24.available = a25);
  }
  get hovering() {
    return this.someManipulator((a25) => a25.hovering);
  }
  get grabbing() {
    return this.someManipulator((a25) => a25.grabbing);
  }
  get dragging() {
    return this.someManipulator((a25) => a25.dragging);
  }
  hasManipulator(a25) {
    return this.someManipulator((t24) => t24 === a25);
  }
  someManipulator(a25) {
    let t24 = false;
    return this.forEachManipulator((i21) => {
      !t24 && a25(i21) && (t24 = true);
    }), t24;
  }
  _forEachManipulator3D(t24) {
    this.forEachManipulator((i21, o18) => {
      i21 instanceof ie && t24(i21, o18);
    });
  }
};

// node_modules/@arcgis/core/views/3d/interactive/editingTools/dragEventPipeline3D.js
function C11(e21, r22) {
  return D7(e21, () => r22);
}
function T11(e21) {
  return D7(e21, (e22) => e22.plane);
}
function D7(t24, s19) {
  const c16 = n2(), l21 = n2();
  let i21 = false;
  return (a25) => {
    const u15 = s19(a25);
    if ("start" === a25.action) {
      const r22 = d(a25.screenStart, l4(t6.get())), s20 = s14(t24.state.camera, r22, L6);
      r(s20) && (i21 = q3(u15, s20, c16));
    }
    if (!i21)
      return null;
    const p23 = d(a25.screenEnd, l4(t6.get())), m21 = s14(t24.state.camera, p23, L6);
    return t(m21) ? null : q3(u15, m21, l21) ? { ...a25, renderStart: c16, renderEnd: l21, plane: u15, ray: m21 } : null;
  };
}
function M11(t24, n20, o18, c16 = null, l21 = null) {
  let i21 = null;
  return (a25) => {
    if ("start" === a25.action && (i21 = t24.sceneIntersectionHelper.intersectElevationFromScreen(i3(a25.screenStart.x, a25.screenStart.y), n20, o18, l21), r(i21) && r(c16) && !pn(i21, i21, c16)))
      return null;
    if (t(i21))
      return null;
    const u15 = t24.sceneIntersectionHelper.intersectElevationFromScreen(i3(a25.screenEnd.x, a25.screenEnd.y), n20, o18, l21);
    return r(u15) ? r(c16) && !pn(u15, u15, c16) ? null : { ...a25, mapStart: i21, mapEnd: u15 } : null;
  };
}
function N4(e21, r22, t24, n20 = null, o18 = null) {
  return M11(e21, t24, d7(r22, e21, t24), n20, o18);
}
function P10(e21, r22, t24, n20 = null, o18 = null) {
  return N4(e21, t24, f9(r22), n20, o18);
}
function h20(r22, t24, n20, o18) {
  const s19 = t24.toMap(r22.screenStart, { include: [n20] });
  return r(s19) ? P10(t24, n20, s19, o18) : null;
}
function k6(e21, r22) {
  const t24 = J2, n20 = K, o18 = p5();
  e21.renderCoordsHelper.worldUpAtPosition(r22, t24);
  const s19 = _(o18, t24, e2(n20, r22, e21.state.camera.eye));
  return _(s19, s19, t24), _2(r22, s19, o18);
}
function G8(e21, r22, t24) {
  let n20 = null;
  const o18 = new G3();
  return o18.next(C11(e21, k6(e21, r22))).next(A13(e21, r22)).next(F6(e21, t24)).next((e22) => {
    e22.mapEnd.x = e22.mapStart.x, e22.mapEnd.y = e22.mapStart.y, n20 = e22;
  }), (e22) => (n20 = null, o18.execute(e22), n20);
}
function A13(e21, r22) {
  const t24 = n2(), n20 = s2(r22);
  e21.renderCoordsHelper.worldUpAtPosition(r22, t24);
  const o18 = n2(), s19 = n2(), i21 = (o19) => {
    if (e2(o19, o19, r22), e7(t24, o19, o19), "global" === e21.viewingMode) {
      s2(o19) * Math.sign(P(t24, o19)) < 1e-3 - n20 && e2(o19, g(o19, t24, 1e-3), r22);
    }
    return u(o19, o19, r22), o19;
  };
  return (e22) => (e22.renderStart = i21(r3(o18, e22.renderStart)), e22.renderEnd = i21(r3(s19, e22.renderEnd)), e22);
}
function F6(r22, t24) {
  const n20 = r22.renderCoordsHelper;
  return (r23) => {
    const o18 = n20.fromRenderCoords(r23.renderStart, t24), s19 = n20.fromRenderCoords(r23.renderEnd, t24);
    return r(o18) && r(s19) ? { ...r23, mapStart: o18, mapEnd: s19 } : null;
  };
}
var q8;
!function(e21) {
  e21[e21.GROUND = 0] = "GROUND", e21[e21.OTHER = 1] = "OTHER";
}(q8 || (q8 = {}));
var J2 = n2();
var K = n2();
var L6 = d3();

// node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/moveUtils.js
function r18(t24, r22, a25, i21) {
  const c16 = t24.graphic, s19 = (t25, e21) => r22({ action: t25, graphic: c16, dxScreen: e21.screenDeltaX, dyScreen: e21.screenDeltaY });
  return a25((t25, r23, a26) => {
    const o18 = r23.next((t26) => ("start" === t26.action && s19("start", t26), t26)).next(h12(c16, i21)).next((t26) => {
      switch (t26.action) {
        case "start":
        case "update":
          (t26.translationX || t26.translationY || t26.translationZ) && s19("update", t26);
          break;
        case "end":
          s19("end", t26);
      }
      return t26;
    });
    return a26.next(M4(c16)).next(() => {
      s19("end", { screenDeltaX: 0, screenDeltaY: 0 });
    }), o18;
  });
}
function a22(e21) {
  if (t(e21) || "polyline" !== e21.type && "polygon" !== e21.type)
    return 0;
  const n20 = ("polyline" === e21.type ? e21.paths : e21.rings)[0];
  if (!n20 || n20.length < 2)
    return 0;
  const r22 = n20[0], a25 = n20[1];
  return Math.atan2(a25[1] - r22[1], a25[0] - r22[0]);
}
function i18(e21) {
  if (t(e21) || t(e21.axis))
    return 1;
  const { mapStart: n20, mapEnd: r22, axis: a25 } = e21, i21 = [r22.x - n20.x, r22.y - n20.y];
  return i21[0] * a25[0] + i21[1] * a25[1] > 0 ? 1 : -1;
}

// node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveXYAxisManipulation.js
var C12 = class extends t21 {
  constructor(t24) {
    super(), this._handles = new t4(), this._arrowManipulatorInfos = new Array(), this._opaqueMaterial = this._createMaterial(), this._transparentMaterial = this._createMaterial(0.5), this._angle = 0, this._scale = 1, this._radius = e20, this._updateAfterDrag = false, this.events = new n5(), this._tool = t24.tool, this._view = t24.view, null != t24.radius && (this._radius = t24.radius), this._createManipulators(), this.forEachManipulator((t25) => this._tool.manipulators.add(t25));
  }
  set orthogonalAvailable(t24) {
    this._arrowManipulatorInfos[1].manipulator.available = t24, this._arrowManipulatorInfos[3].manipulator.available = t24;
  }
  destroy() {
    this.forEachManipulator((t24) => {
      this._tool.manipulators.remove(t24), t24.destroy();
    }), this._handles = s(this._handles), this._tool = null, this._view = null, this._arrowManipulatorInfos.length = 0;
  }
  forEachManipulator(t24) {
    for (const { manipulator: a25 } of this._arrowManipulatorInfos)
      t24(a25, A12.TRANSLATE_XY);
  }
  createGraphicDragPipeline(t24, a25, r22) {
    const e21 = a25.graphic, i21 = f9(e21), s19 = e(e21.geometry).spatialReference;
    return r18(a25, r22, (a26) => this.createDragPipeline((r23, e22, i22, o18, s20) => a26(r23, t24(r23, e22, i22, o18, s20), i22), i21, s19, e21), this._view.state.viewingMode);
  }
  createDragPipeline(t24, a25, r22, i21) {
    return r5(this._arrowManipulatorInfos.map(({ manipulator: e21 }, o18) => d10(e21, (e22, s19, n20, l21, p23) => {
      const u15 = s19.next((t25) => ({ ...t25, manipulatorType: A12.TRANSLATE_XY })).next(C(this._view, e22.elevationAlignedLocation)).next(N4(this._view, e22.elevationAlignedLocation, a25, r22, i21)).next(g7(e22.location, this.angle + (o18 + 1) * Math.PI * 0.5)).next(U3());
      t24(e22, u15, n20, l21, p23);
    })));
  }
  get angle() {
    return this._angle;
  }
  set angle(t24) {
    this._angle = t24, this.dragging ? this._updateAfterDrag = true : this._updateManipulatorTransform();
  }
  get displayScale() {
    return this._scale;
  }
  set displayScale(t24) {
    this._scale = t24, this._updateManipulatorTransform();
  }
  get radius() {
    return this._radius;
  }
  set radius(t24) {
    this._radius !== t24 && (this._radius = t24, this._updateManipulators());
  }
  _updateManipulators() {
    for (let t24 = 0; t24 < this._arrowManipulatorInfos.length; t24++)
      this._updateArrowManipulator(this._arrowManipulatorInfos[t24], t24);
    this._updateManipulatorTransform();
  }
  _updateArrowManipulator({ manipulator: t24, transform: a25 }, r22) {
    const e21 = this._radius / e20, i21 = c11 * e21, o18 = i21 * Math.sqrt(3) / 2, s19 = Z5(o18, i21 / 2, i21 / 2, M10);
    B3(s19, x3(f6.get(), o2(c2.get(), 0, -o18 / 3, 0))), t24.renderObjects = [{ geometry: s19, material: this._opaqueMaterial, stateMask: t12.Focused }, { geometry: s19, material: this._transparentMaterial, stateMask: t12.Unfocused }], t24.radius = o18 / 3 * 2 * 1.2;
    const u15 = R(f6.get(), r22 * Math.PI / 2), h26 = x3(f6.get(), o2(c2.get(), 0, o15 * e21, 0));
    u4(a25, u15, h26);
  }
  _createManipulators() {
    for (let t24 = 0; t24 < 4; t24++) {
      const a25 = this._createArrowManipulator(t24);
      this._arrowManipulatorInfos.push(a25);
    }
    this._updateManipulatorTransform();
  }
  _updateManipulatorTransform() {
    const t24 = this.angle, a25 = g2(f6.get(), t24, r2(0, 0, 1));
    if (t(a25))
      return;
    const r22 = q2(f6.get(), o2(c2.get(), this.displayScale, this.displayScale, this.displayScale)), e21 = u4(f6.get(), r22, a25);
    for (const i21 of this._arrowManipulatorInfos) {
      const t25 = u4(f6.get(), e21, i21.transform);
      i21.manipulator.modelTransform = t25;
    }
  }
  _createArrowManipulator(t24) {
    const a25 = new ie({ view: this._view, autoScaleRenderObjects: false, worldOriented: true, focusMultiplier: 1, touchMultiplier: 1, collisionType: { type: "disc", direction: r2(0, 0, 1) } }), r22 = { manipulator: a25, transform: e6() };
    return this._updateArrowManipulator(r22, t24), this._handles.add(a25.events.on("drag", (t25) => {
      this._updateAfterDrag && "end" === t25.action && !this.dragging && (this._updateManipulatorTransform(), this._updateAfterDrag = false);
    })), r22;
  }
  _createMaterial(a25 = 1) {
    const r22 = l.toUnitRGBA(r16.main);
    return r22[3] *= a25, new m12({ color: r22, transparent: 1 !== a25, cullFace: n9.Back, renderOccluded: o7.Transparent });
  }
  get test() {
    return { arrowManipulators: this._arrowManipulatorInfos.map(({ manipulator: t24 }) => t24) };
  }
};

// node_modules/@arcgis/core/views/3d/interactive/editingTools/snapping/SnapToScene.js
var a23 = class {
  constructor() {
    this._view = null, this._elevationInfo = null, this._lastDragEvent = null, this.next = new G3(), this._enabled = false;
  }
  get enabled() {
    return this._enabled;
  }
  set enabled(e21) {
    if (this._enabled !== e21 && r(this._lastDragEvent)) {
      const n20 = this._lastDragEvent.mapEnd, a25 = this._snap(this._lastDragEvent.screenEnd);
      if (r(a25)) {
        const t24 = { action: "update", mapStart: this._lastDragEvent.mapStart, mapEnd: true === e21 ? a25 : n20, screenStart: this._lastDragEvent.screenEnd, screenEnd: this._lastDragEvent.screenEnd };
        this.next.execute(t24);
      }
    }
    this._enabled = e21;
  }
  _snap(n20) {
    const a25 = r(this._view) ? this._view.toMap(n20, { exclude: [] }) : null;
    return r(a25) && r(this._view) && (a25.z = d7(a25, this._view, this._elevationInfo)), a25;
  }
  createDragEventPipelineStep(e21, n20) {
    return this._view = e21, this._elevationInfo = n20, this._lastDragEvent = null, (e22) => {
      if (this._lastDragEvent = "end" !== e22.action ? { ...e22 } : null, this._enabled) {
        const n21 = this._snap(e22.screenEnd);
        return r(n21) ? { action: e22.action, mapStart: e22.mapStart, mapEnd: n21, screenStart: e22.screenStart, screenEnd: e22.screenEnd } : null;
      }
      return { action: e22.action, mapStart: e22.mapStart, mapEnd: e22.mapEnd, screenStart: e22.screenStart, screenEnd: e22.screenEnd };
    };
  }
};

// node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveXYDiscManipulation.js
var E11 = class extends t21 {
  constructor(t24) {
    super(), this._snapToScene = new a23(), this._discMaterial = this._createMaterial(), this._discMaterialTransparent = this._createMaterial(0.5), this._scale = 1, this._radius = e20, this._view = t24.view, this._tool = t24.tool, null != t24.snapToScene && (this.snapToScene = t24.snapToScene), null != t24.radius && (this._radius = t24.radius), this._createManipulator(), this.forEachManipulator((t25) => this._tool.manipulators.add(t25));
  }
  destroy() {
    this.forEachManipulator((t24) => {
      this._tool.manipulators.remove(t24), t24.destroy();
    }), this._tool = null, this._view = null, this._manipulator = null;
  }
  forEachManipulator(t24) {
    t24(this._manipulator, A12.TRANSLATE_XY);
  }
  get displayScale() {
    return this._scale;
  }
  set displayScale(t24) {
    this._scale = t24, this._updateManipulatorTransform();
  }
  get snapToScene() {
    return this._snapToScene.enabled;
  }
  set snapToScene(t24) {
    this._snapToScene.enabled = t24;
  }
  get radius() {
    return this._radius;
  }
  set radius(t24) {
    t24 !== this._radius && (this._radius = t24, this._updateManipulator());
  }
  createGraphicDragPipeline(t24, i21, a25) {
    const r22 = i21.graphic, s19 = f9(r22), o18 = e(r22.geometry).spatialReference;
    return r18(i21, a25, (e21) => this.createDragPipeline((i22, a26, r23, s20, o19) => e21(i22, t24(i22, a26, r23, s20, o19), r23), s19, o18, r22), this._view.state.viewingMode);
  }
  createDragPipeline(t24, e21, i21, a25) {
    const r22 = this._view;
    return d10(this._manipulator, (s19, o18, n20, l21, p23) => {
      const u15 = o18.next(C(r22, s19.elevationAlignedLocation)).next(N4(r22, s19.elevationAlignedLocation, e21, i21, a25)).next(this._snapToScene.createDragEventPipelineStep(r22, e21), this._snapToScene.next).next((t25) => ({ ...t25, manipulatorType: A12.TRANSLATE_XY })).next(U3());
      t24(s19, u15, n20, l21, p23);
    });
  }
  _updateManipulatorTransform() {
    const t24 = q2(f6.get(), o2(c2.get(), this.displayScale, this.displayScale, this.displayScale));
    this._manipulator.modelTransform = t24;
  }
  _createManipulator() {
    const t24 = this._view;
    this._manipulator = new ie({ view: t24, worldSized: false, autoScaleRenderObjects: false, focusMultiplier: 1, touchMultiplier: 1, collisionType: { type: "disc", direction: r2(0, 0, 1) }, worldOriented: true }), this._updateManipulator();
  }
  _updateManipulator() {
    const t24 = E8(M10, 1, a21, r2(0, 0, 1), r2(0, 0, 0)), e21 = q2(e6(), r2(this._radius, this._radius, this._radius));
    this._manipulator.renderObjects = [{ geometry: t24, material: this._discMaterial, transform: e21, stateMask: t12.Focused }, { geometry: t24, material: this._discMaterialTransparent, transform: e21, stateMask: t12.Unfocused }], this._manipulator.radius = h19 * (this._radius / e20);
  }
  _createMaterial(e21 = 1) {
    const i21 = l.toUnitRGBA(r16.main);
    return i21[3] *= e21, new m12({ color: i21, transparent: 1 !== e21, cullFace: n9.Back, renderOccluded: o7.Transparent });
  }
  get test() {
    return { discManipulator: this._manipulator };
  }
};

// node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveZManipulation.js
var T12 = class extends t21 {
  constructor(t24) {
    super(), this._radius = e20, this.events = new n5(), this._tool = t24.tool, this._view = t24.view, null != t24.radius && (this._radius = t24.radius), this._createManipulator(), this.forEachManipulator((t25) => this._tool.manipulators.add(t25));
  }
  destroy() {
    this.forEachManipulator((t24) => {
      this._tool.manipulators.remove(t24), t24.destroy();
    });
  }
  forEachManipulator(t24) {
    t24(this._manipulator, A12.TRANSLATE_Z);
  }
  createGraphicDragPipeline(t24, e21, r22) {
    const i21 = e(e21.graphic.geometry).spatialReference;
    return r18(e21, r22, (e22) => this.createDragPipeline((r23, a25, i22, o18, s19) => e22(r23, t24(r23, a25, i22, o18, s19), i22), i21), this._view.state.viewingMode);
  }
  createDragPipeline(t24, e21) {
    const r22 = this._view;
    return d10(this._manipulator, (a25, i21, o18, s19, n20) => {
      const l21 = i21.next((t25) => ({ ...t25, manipulatorType: A12.TRANSLATE_Z })).next(G8(r22, a25.renderLocation, e21)).next(U3());
      t24(a25, l21, o18, s19, n20);
    });
  }
  get radius() {
    return this._radius;
  }
  set radius(t24) {
    t24 !== this._radius && (this._radius = t24, this._updateManipulator());
  }
  _updateManipulator() {
    const e21 = this._radius / e20, r22 = y7.zManipulator.height * e21, a25 = y7.zManipulator.coneHeight * e21, l21 = y7.zManipulator.coneWidth * e21, m21 = y7.zManipulator.width * e21, p23 = [r2(0, 0, 0), r2(0, 0, r22)], u15 = X3(p23, m21 / 2, 16, false), c16 = C4(a25, l21 / 2, 16, false), d19 = [r2(0, 0, 0), r2(0, 0, r22 + a25)], h26 = (t24) => {
      const e22 = e6();
      if (c(e22, e22, [0, 0, r22]), b2(e22, e22, Math.PI / 2), t24) {
        const r23 = 1 + 2 * t24 / l21;
        i4(e22, e22, [r23, r23, r23]);
      }
      return e22;
    }, M14 = h26(0), g16 = (e22, r23) => {
      const a26 = q4(y7.zManipulator.color, r23);
      return [a26.r / 255, a26.g / 255, a26.b / 255, y7.zManipulator.color.a * e22];
    }, j14 = A11(g16(1, 0.25), o7.Occlude), w18 = A11(g16(1, 0), o7.Occlude), k10 = A11(g16(0.7, 0), y7.zManipulator.renderOccluded), P12 = A11(g16(0.85, 0), y7.zManipulator.renderOccluded);
    this._manipulator.renderObjects = [{ geometry: c16, transform: M14, material: j14, stateMask: t12.Unfocused }, { geometry: u15, material: j14, stateMask: t12.Unfocused }, { geometry: c16, transform: M14, material: w18, stateMask: t12.Focused }, { geometry: u15, material: w18, stateMask: t12.Focused }, { geometry: c16, transform: M14, material: k10, stateMask: t12.Unfocused }, { geometry: u15, material: k10, stateMask: t12.Unfocused }, { geometry: c16, transform: M14, material: P12, stateMask: t12.Focused }, { geometry: u15, material: P12, stateMask: t12.Focused }], this._manipulator.radius = m21 / 2 + 2, this._manipulator.collisionType = { type: "line", paths: [d19] };
  }
  _createManipulator() {
    const t24 = new ie({ view: this._view, autoScaleRenderObjects: false, worldSized: false, selectable: false, cursor: "ns-resize", elevationInfo: this.elevationInfo, worldOriented: true, collisionPriority: 1.6 });
    t24.applyObjectTransform = (t25) => {
      const e21 = this._view.state.camera, a25 = A14;
      this._view.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation, a25);
      const i21 = U(e21.eye, a25), o18 = e21.computeRenderPixelSizeAtDist(i21), s19 = e2(x15, a25, e21.eye);
      z(s19, s19);
      const n20 = D8;
      this._view.renderCoordsHelper.worldUpAtPosition(A14, n20);
      const h26 = Math.abs(P(s19, n20)), f18 = _(x15, s19, n20), M14 = _(x15, f18, n20), _10 = a3(h26, 0.01, 1), g16 = 1 - Math.sqrt(1 - _10 * _10) / _10 / e21.fullWidth, j14 = this._radius / e20, w18 = y7.zManipulator.width * j14;
      g(M14, z(M14, M14), (1 / g16 - 1) * i21 + o18 * w18), t25[12] -= x15[0], t25[13] -= x15[1], t25[14] -= x15[2];
    }, this._manipulator = t24, this._updateManipulator();
  }
  get test() {
    return { manipulator: this._manipulator };
  }
};
var A14 = n2();
var x15 = n2();
var D8 = n2();

// node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveManipulation.js
var u13 = class extends t21 {
  constructor(a25) {
    super(), this._handles = new t4(), this._interactive = true;
    const { tool: t24, view: n20, snapToScene: e21, radius: s19 } = a25;
    this._view = n20, this.xyManipulation = new E11({ tool: t24, view: n20, snapToScene: e21, radius: s19 }), this.xyAxisManipulation = new C12({ tool: t24, view: n20, radius: s19 }), this.zManipulation = new T12({ tool: t24, view: n20, radius: s19 }), this.xyManipulation.available = a25.xyAvailable, this.xyAxisManipulation.available = a25.xyAxisAvailable, this.zManipulation.available = a25.zAvailable, this._autoHideXYAxis(), this.forEachManipulator((i21) => {
      this._handles.add(i21.events.on("grab-changed", () => this._updateManipulatorInteractivity()));
    });
  }
  destroy() {
    this._handles.destroy(), this.xyManipulation.destroy(), this.xyAxisManipulation.destroy(), this.zManipulation.destroy();
  }
  createGraphicDragPipeline(i21, t24, n20) {
    return r5([this.xyManipulation.createGraphicDragPipeline((a25, t25, n21, e21, s19) => i21(M12.XY, a25, t25, n21, e21, s19), t24, n20), this.xyAxisManipulation.createGraphicDragPipeline((a25, t25, n21, e21, s19) => i21(M12.XY_AXIS, a25, t25, n21, e21, s19), t24, n20), this.zManipulation.createGraphicDragPipeline((a25, t25, n21, e21, s19) => i21(M12.Z, a25, t25, n21, e21, s19), t24, n20)]);
  }
  createDragPipeline(i21, t24, n20, e21) {
    return r5([this.xyManipulation.createDragPipeline((a25, t25, n21, e22, s19) => i21(M12.XY, a25, t25, n21, e22, s19), t24, n20, e21), this.xyAxisManipulation.createDragPipeline((a25, t25, n21, e22, s19) => i21(M12.XY_AXIS, a25, t25, n21, e22, s19), t24, n20, e21), this.zManipulation.createDragPipeline((a25, t25, n21, e22, s19) => i21(M12.Z, a25, t25, n21, e22, s19), n20)]);
  }
  set snapToScene(i21) {
    this.xyManipulation.snapToScene = i21;
  }
  set angle(i21) {
    this.xyAxisManipulation.angle = i21;
  }
  set interactive(i21) {
    this._interactive !== i21 && (this._interactive = i21, this._updateManipulatorInteractivity());
  }
  set radius(i21) {
    this.xyAxisManipulation.radius = i21, this.xyManipulation.radius = i21, this.zManipulation.radius = i21;
  }
  set displayScale(i21) {
    this.xyManipulation.displayScale = i21, this.xyAxisManipulation.displayScale = i21;
  }
  forEachManipulator(i21) {
    this.xyManipulation.forEachManipulator((a25) => i21(a25, A12.TRANSLATE_XY)), this.xyAxisManipulation.forEachManipulator((a25) => i21(a25, A12.TRANSLATE_XY)), this.zManipulation.forEachManipulator((a25) => i21(a25, A12.TRANSLATE_Z));
  }
  get _xyAxisVisible() {
    const i21 = this.xyManipulation.someManipulator((i22) => i22.focused) || this.xyAxisManipulation.someManipulator((i22) => i22.focused);
    return this._view.inputManager && "touch" === this._view.inputManager.latestPointerType || i21;
  }
  _autoHideXYAxis() {
    const i21 = this.xyAxisManipulation, a25 = this.xyManipulation;
    if (has("esri-mobile"))
      return;
    const t24 = [];
    a25.forEachManipulator((i22) => t24.push(i22)), i21.forEachManipulator((i22) => t24.push(i22));
    const e21 = () => {
      const a26 = [];
      this._xyAxisVisible || i21.forEachManipulator((i22) => a26.push(i22.disableDisplay())), this._handles.remove(c12), this._handles.add(a26, c12);
    };
    for (const n20 of t24)
      this._handles.add(n20.events.on("focus-changed", e21));
    this._view.inputManager && this._handles.add(f3(() => {
      var _a;
      return (_a = this._view.inputManager) == null ? void 0 : _a.latestPointerType;
    }, e21)), e21();
  }
  _updateManipulatorInteractivity() {
    const i21 = this.grabbing;
    this.forEachManipulator((a25) => {
      a25.interactive = !i21 && this._interactive || a25.grabbing;
    });
  }
  static radiusForSymbol(i21) {
    const a25 = r(i21) && "point-3d" === i21.type && i21.symbolLayers;
    return !!a25 && a25.length > 0 && a25.some((i22) => "icon" === i22.type) ? I4 : e20;
  }
};
var c12 = "disable-xy-axis-display";
var M12;
!function(i21) {
  i21[i21.XY = 0] = "XY", i21[i21.XY_AXIS = 1] = "XY_AXIS", i21[i21.Z = 2] = "Z";
}(M12 || (M12 = {}));

// node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveXYGraphicManipulation.js
var l18 = class extends t21 {
  constructor(t24) {
    super(), this._view = t24.view, this._tool = t24.tool, this._graphicState = t24.graphicState, this._createManipulator(), this.forEachManipulator((t25) => this._tool.manipulators.add(t25));
  }
  destroy() {
    this.forEachManipulator((t24) => {
      this._tool.manipulators.remove(t24), t24.destroy();
    }), this._tool = null, this._view = null, this._manipulator = null, this._graphicState = null;
  }
  forEachManipulator(t24) {
    t24(this._manipulator, A12.TRANSLATE_XY);
  }
  createGraphicDragPipeline(t24) {
    return r18(this._graphicState, t24, (t25) => this.createDragPipeline(t25), this._view.state.viewingMode);
  }
  createDragPipeline(e21) {
    const r22 = this._view, a25 = this._graphicState.graphic, p23 = r(a25.geometry) ? a25.geometry.spatialReference : null;
    return d10(this._manipulator, (t24, o18, l21, h26, c16) => {
      const m21 = o18.next(h20(c16, r22, a25, p23)).next(P3()).next(U3());
      e21(t24, m21, l21, h26, c16);
    });
  }
  _createManipulator() {
    const t24 = this._view, i21 = this._graphicState.graphic;
    this._manipulator = new C5({ graphic: i21, view: t24, selectable: true, cursor: "move" });
  }
};

// node_modules/@arcgis/core/views/3d/interactive/editingTools/moveGraphic/GraphicMoveTool.js
var L7 = class {
  constructor(t24) {
    this.allGraphics = t24, this.type = "graphic-move-start";
  }
};
var N5 = class {
  constructor(t24, i21, e21) {
    this.dx = t24, this.dy = i21, this.allGraphics = e21, this.type = "graphic-move";
  }
};
var q9 = class {
  constructor(t24) {
    this.allGraphics = t24, this.type = "graphic-move-stop";
  }
};
var B5 = class extends a7(n5.EventedMixin(p11)) {
  constructor(t24) {
    super(t24), this.graphics = new j2(), this.enableZ = true, this.tooltipOptions = new p8(), this.type = "move-3d", this._snappingPipeline = new u8(), this._tooltip = null;
  }
  initialize() {
    const { graphics: t24, view: i21 } = this;
    this.addHandles([t24.on("change", () => this._refreshManipulators()), l3(() => this.tooltipOptions.enabled, (t25) => {
      this._tooltip = t25 ? new m9({ view: i21 }) : s(this._tooltip);
    }, w3)]), this._refreshManipulators(), this.finishToolCreation();
  }
  destroy() {
    this._tooltip = s(this._tooltip), this._moveManipulation = s(this._moveManipulation), this.graphics.removeAll(), this._set("view", null);
  }
  get updating() {
    return this.updatingHandles.updating;
  }
  reset() {
  }
  _refreshManipulators() {
    this.handles.removeAll(), this._moveManipulation && this._moveManipulation.destroy(), this.manipulators.removeAll();
    const t24 = this.graphics.toArray().filter((t25) => i10(t25) === P2.SUPPORTED).map((t25) => new J3(t25));
    t24.length && (this._createManipulators(t24), this._createVisualElements(t24), this.handles.add(t24.map((t25) => this.view.trackGraphicState(t25.state))), this._updateMoveManipulation(t24));
  }
  _createManipulators(t24) {
    for (const i21 of t24) {
      const e21 = i21.state;
      i21.manipulationXY = new l18({ tool: this, view: this.view, graphicState: e21 }), i21.manipulationXY.forEachManipulator((t25) => this.handles.add([t25.events.on("immediate-click", (t26) => {
        this.emit("immediate-click", { ...t26, graphic: e21.graphic }), t26.stopPropagation();
      }), t25.events.on("grab-changed", ({ action: t26 }) => {
        const { tooltipOptions: i22, _tooltip: e22 } = this;
        t(e22) || ("start" === t26 ? e22.info = new r14({ tooltipOptions: i22 }) : e22.clear());
      })])), this.handles.add(i21.manipulationXY.createDragPipeline((i22, e22, o18, a25) => this._buildDragEventPipeline(t24, M12.XY, i22, e22, o18, a25)));
    }
    this._createMoveManipulation(t24);
  }
  _createMoveManipulation(t24) {
    const i21 = new u13({ tool: this, view: this.view, snapToScene: false, xyAvailable: true, xyAxisAvailable: true, zAvailable: true, radius: 1 === t24.length ? u13.radiusForSymbol(t24[0].graphic.symbol) : e20 });
    this._moveManipulation = i21, i21.elevationInfo = { mode: "absolute-height", offset: 0 }, i21.forEachManipulator((t25) => {
      this.handles.add(t25.events.on("immediate-click", (e22) => {
        i21.zManipulation.hasManipulator(t25) || 1 !== this.graphics.length || this.emit("immediate-click", { ...e22, graphic: this.graphics.getItemAt(0) }), e22.stopPropagation();
      }));
    });
    const e21 = (i22) => (e22) => {
      this.handles.add(e22.events.on("focus-changed", ({ action: e23 }) => {
        const o19 = this._tooltip;
        t(o19) || ("focus" === e23 ? this._updateMoveTooltip(t24, i22) : o19.clear());
      }));
    };
    this._moveManipulation.xyManipulation.forEachManipulator(e21(M12.XY)), this._moveManipulation.xyAxisManipulation.forEachManipulator(e21(M12.XY_AXIS)), this._moveManipulation.zManipulation.forEachManipulator(e21(M12.Z));
    const o18 = () => this._updateMoveManipulation(t24);
    for (const n20 of t24)
      this.handles.add([n20.state.on("changed", o18), l3(() => n20.state.displaying, o18)]);
    const a25 = t24[t24.length - 1];
    this.handles.add(a25.state.on("changed", () => this._updateMoveManipulationAngle(a25))), this.handles.add(i21.createDragPipeline((i22, e22, o19, a26, n20) => this._buildDragEventPipeline(t24, i22, e22, o19, a26, n20), f9(a25.graphic), e(a25.graphic.geometry).spatialReference, a25.graphic)), this._updateMoveManipulationAngle(a25);
  }
  _createVisualElements(t24) {
    for (const i21 of t24) {
      const e21 = i21.graphic, o18 = i15({ view: this.view, graphic: e21, forEachManipulator: (t25) => {
        i21.manipulationXY.forEachManipulator(t25), this._moveManipulation.forEachManipulator(t25);
      }, onManipulatorsChanged: () => n3() });
      t(o18) || (i21.geometryRepresentation = o18.visualElement, i21.geometryRepresentation instanceof S8 && this.handles.add([i21.geometryRepresentation.events.on("attachment-origin-changed", () => {
        i21.state.isDraped || this._updateMoveManipulation(t24);
      }), l3(() => i21.state.isDraped, () => this._updateMoveManipulation(t24))]), this.handles.add(o18));
    }
  }
  _updateMoveManipulationAngle(t24) {
    this._moveManipulation.angle = a22(t24.graphic.geometry);
  }
  _updateMoveManipulation(t24) {
    const i21 = v5(0, 0, 0, this.view.spatialReference);
    let e21 = 0, o18 = false;
    const a25 = this._moveManipulation;
    for (const n20 of t24) {
      if (!n20.state.displaying)
        continue;
      const t25 = n20.state.graphic;
      this.enableZ && t19(t25) && (o18 = true);
      const a26 = n20.geometryRepresentation instanceof S8 && !n20.state.isDraped ? n20.geometryRepresentation.attachmentOrigin : N2(this.view, t25);
      r(a26) && (i21.x += a26.x, i21.y += a26.y, i21.z += a26.z, e21++);
    }
    e21 > 0 ? (i21.x /= e21, i21.y /= e21, i21.z /= e21, a25.location = i21, a25.xyManipulation.available = true, a25.xyAxisManipulation.available = true, a25.zManipulation.available = o18) : a25.available = false;
  }
  _buildDragEventPipeline(t24, i21, e21, o18, a25, n20) {
    const s19 = [], r22 = [];
    let p23 = null, l21 = null;
    const h26 = () => {
      for (const t25 of s19)
        t25.dragging = false;
      s19.length = 0, r22.length = 0, p23 = null, l21 = null, this._moveManipulation.interactive = true;
    };
    if (a25 = a25.next((t25) => l21(t25)).next(() => {
      if (this.emit("graphic-move-stop", new q9(r22)), this.destroyed)
        return null;
      h26();
    }), 1 === t24.length && i21 === M12.XY) {
      const i22 = t24[0].graphic;
      o18 = this._buildSnappingPipelineSteps(i22, f9(i22), o18, a25, n20);
    }
    return o18.next((i22) => {
      if ("start" === i22.action) {
        s19.length = 0, r22.length = 0;
        for (const i23 of t24)
          i23.dragging || !i23.manipulationXY.hasManipulator(e21) && i23.manipulationXY.grabbing || (s19.push(i23), r22.push(i23.graphic), i23.dragging = true);
        if (0 !== r22.length && (this._moveManipulation.interactive = false, p23 = v8(r22, this.view.state.viewingMode), l21 = D3(r22), this.emit("graphic-move-start", new L7(r22)), this.destroyed))
          return null;
      }
      return 0 !== r22.length ? i22 : null;
    }).next((t25) => p23(t25)).next((e22) => (this._updateMoveTooltip(t24, i21, e22), e22)).next((t25) => {
      switch (t25.action) {
        case "start":
        case "update":
          if (t25.translationX || t25.translationY || t25.translationZ) {
            const i22 = this.view.toScreen(t25.mapStart), e22 = this.view.toScreen(t25.mapEnd), o19 = e22.x - i22.x, a26 = e22.y - i22.y;
            if (this.emit("graphic-move", new N5(o19, a26, r22)), this.destroyed)
              return null;
          }
          break;
        case "end":
          if (this.emit("graphic-move-stop", new q9(r22)), this.destroyed)
            return null;
          h26();
      }
    });
  }
  _updateMoveTooltip(t24, i21, e21) {
    const { tooltipOptions: o18, _tooltip: a25 } = this;
    if (t(a25))
      return;
    a25.clear();
    const n20 = 0 === t24.length ? "absolute-height" : t24[0].state.isDraped ? "on-the-ground" : "absolute-height";
    switch (i21) {
      case M12.XY:
        a25.info = new r14({ tooltipOptions: o18 }), this._updateMoveTooltipDistance(a25.info, e21, (t25, i22) => a14(t25, i22, n20));
        break;
      case M12.XY_AXIS:
        a25.info = new a16({ tooltipOptions: o18 }), this._updateMoveTooltipDistance(a25.info, e21, (t25, i22) => {
          const o19 = a14(t25, i22, n20);
          return y6(o19, i18(e21));
        });
        break;
      case M12.Z:
        a25.info = new p13({ tooltipOptions: o18 }), this._updateMoveTooltipDistance(a25.info, e21, v7);
    }
  }
  _updateMoveTooltipDistance(t24, i21, e21) {
    if (r(i21) && "end" !== i21.action) {
      const { mapStart: o18, mapEnd: a25 } = i21, n20 = e21(o18, a25);
      t24.distance = r(n20) ? n20 : j5;
    }
  }
  _buildSnappingPipelineSteps(t24, i21, e21, o18, a25) {
    const n20 = t24.geometry;
    if (t(n20) || "point" !== n20.type && "mesh" !== n20.type)
      return e21;
    const r22 = ("point" === n20.type ? n20 : n20.anchor).clone(), p23 = new e15({ elevationInfo: i21, pointer: a25, editGeometryOperations: V.fromGeometry(r22, this.view.state.viewingMode), visualizer: new _6(), excludeFeature: t24 }), l21 = this.snappingManager;
    return e21.next((i22) => {
      r22.z = g5(this.view, r22, f9(t24), { mode: "absolute-height", offset: 0 });
      return { ...i22, snapOrigin: p23.coordinateHelper.pointToVector(r22) };
    }).next(this._snappingPipeline.createSnapDragEventPipelineStep({ snappingContext: p23, snappingManager: l21, cancel: o18, updatingHandles: this.updatingHandles }), this._snappingPipeline.next);
  }
  get test() {
    return { tooltip: this._tooltip };
  }
};
e3([y2({ constructOnly: true, nonNullable: true })], B5.prototype, "view", void 0), e3([y2()], B5.prototype, "graphics", void 0), e3([y2({ constructOnly: true, nonNullable: true })], B5.prototype, "enableZ", void 0), e3([y2({ constructOnly: true, type: p8 })], B5.prototype, "tooltipOptions", void 0), e3([y2({ constructOnly: true })], B5.prototype, "snappingManager", void 0), e3([y2()], B5.prototype, "type", void 0), e3([y2()], B5.prototype, "updating", null), B5 = e3([n4("esri.views.3d.interactive.editingTools.graphicMove3D.GraphicMoveTool")], B5);
var J3 = class {
  constructor(t24) {
    this.state = null, this.geometryRepresentation = null, this.manipulationXY = null, this.dragging = false, this.state = new e19({ graphic: t24 });
  }
  get graphic() {
    return this.state.graphic;
  }
};

// node_modules/@arcgis/core/views/3d/interactive/editingTools/reshapeGraphic/edgeOffsetUtils.js
function j11(e21, r22, o18) {
  const n20 = "on-the-ground" === o18.mode ? A7.XY : A7.XYZ;
  return new P4(e21, n20, r22, 0);
}
function h21(r22, o18, n20) {
  const s19 = n2();
  if (!r22.renderCoordsHelper.toRenderCoords(o18, s19))
    return null;
  const c16 = y8(r22, o18, Y2(n20.plane)), i21 = y8(r22, o18, n20.edgeDirection);
  if (t(c16) || t(i21))
    return null;
  const u15 = _(n2(), c16, i21);
  return _2(s19, u15, p5());
}
function y8(e21, r22, o18) {
  const n20 = v5(r22.x + o18[0], r22.y + o18[1], r22.z + o18[2], r22.spatialReference), t24 = n2(), c16 = n2();
  return e21.renderCoordsHelper.toRenderCoords(r22, t24) && e21.renderCoordsHelper.toRenderCoords(n20, c16) ? H(c16, t24, c16) : null;
}
function C13(e21, r22, o18) {
  const c16 = Y2(e21), i21 = H(n2(), r22, o18), p23 = _(n2(), i21, c16), m21 = _(n2(), i21, p23);
  return t5(i21[0], i21[1], i21[2], 0, p23[0], p23[1], p23[2], 0, m21[0], m21[1], m21[2], 0, 0, 0, 0, 1);
}
function R5(e21, n20, t24) {
  const s19 = t24.projectToRenderScreen(e21, x2()), d19 = t24.projectToRenderScreen(n20, x2());
  return r(s19) && r(d19) ? v(e2(s19, s19, d19)) : 0;
}

// node_modules/@arcgis/core/views/interactive/tooltip/ReshapeTooltipInfos.js
var p20 = class extends e13 {
  constructor(o18) {
    super(o18), this.type = "reshape-edge-offset", this.distance = j5, this.area = null, this.totalLength = null;
  }
};
e3([y2()], p20.prototype, "type", void 0), e3([y2()], p20.prototype, "distance", void 0), e3([y2()], p20.prototype, "area", void 0), e3([y2()], p20.prototype, "totalLength", void 0), p20 = e3([n4("esri.views.interactive.tooltip.ReshapeEdgeOffsetTooltipInfo")], p20);

// node_modules/@arcgis/core/views/3d/interactive/editingTools/reshapeGraphic/ReshapeOperation.js
var Ue = class extends n5.EventedMixin(d2) {
  constructor(e21) {
    super(e21), this._vertexManipulatorMaterial = A11(y7.colorToVec4(y7.reshapeManipulators.vertex.color), y7.reshapeManipulators.vertex.renderOccluded), this._vertexManipulatorOutlineMaterial = I3(y7.colorToVec4(y7.reshapeManipulators.vertex.outlineColor), y7.reshapeManipulators.vertex.renderOccluded), this._vertexManipulatorHoverOutlineMaterial = I3(y7.colorToVec4(y7.reshapeManipulators.vertex.hoverOutlineColor), y7.reshapeManipulators.vertex.renderOccluded), this._edgeManipulatorMaterial = A11(y7.colorToVec4(y7.reshapeManipulators.edge.color), y7.reshapeManipulators.edge.renderOccluded), this._edgeManipulatorOutlineMaterial = I3(y7.colorToVec4(y7.reshapeManipulators.edge.outlineColor), y7.reshapeManipulators.edge.renderOccluded), this._edgeOffsetManipulatorMaterial = A11(y7.colorToVec4(y7.reshapeManipulators.edgeOffset.color), y7.reshapeManipulators.edgeOffset.renderOccluded, false), this._edgeOffsetManipulatorHoverMaterial = A11(y7.colorToVec4(y7.reshapeManipulators.edgeOffset.hoverColor), y7.reshapeManipulators.edgeOffset.renderOccluded, false), this._selectedManipulatorMaterial = A11(y7.colorToVec4(y7.reshapeManipulators.selected.color), y7.reshapeManipulators.selected.renderOccluded), this._selectedManipulatorOutlineMaterial = I3(y7.colorToVec4(y7.reshapeManipulators.selected.outlineColor), y7.reshapeManipulators.selected.renderOccluded), this._selectedManipulatorHoverOutlineMaterial = I3(y7.colorToVec4(y7.reshapeManipulators.selected.hoverOutlineColor), y7.reshapeManipulators.selected.renderOccluded), this._selectedIndex = 0, this._vertexManipulatorGeometry = null, this._vertexManipulatorOutlineGeometry = null, this._edgeManipulatorGeometry = null, this._edgeManipulatorOutlineGeometry = null, this._edgeOffsetManipulatorGeometryInside = null, this._edgeOffsetManipulatorGeometryOutside = null, this._manipulatorHandles = new t4(), this._manipulatorInfos = [], this._editGeometryOperations = null, this._numGrabbing = 0, this._numDragging = 0, this._reshapeEventState = Xe.NONE, this._outlineVisualElement = null, this._segmentLabels = null, this.outputGeometry = null, this._snappingPipeline = new u8(), this._snappingPipelineHandle = new u8(), this._vertexLaserLineVisualElement = null;
  }
  initialize() {
    const { graphic: e21, view: t24 } = this, i21 = this._graphicState = new e19({ graphic: e21 });
    this._tooltip = new m9({ view: t24 }), this.addHandles([l3(() => i21.displaying, (e22) => {
      for (const t25 of this._manipulatorInfos)
        t25.manipulator.available = e22;
    }), l3(() => ({ labels: this._segmentLabels, enabled: this._labelOptions.enabled, edgeOffsetEnabled: this.enableEdgeOffset }), ({ labels: e22, enabled: t25, edgeOffsetEnabled: i22 }) => {
      r(e22) && (e22.visible = t25, e22.edgeDistance = i22 ? "far" : "default");
    }, h4), f3(() => !this._tooltipOptions.enabled, () => this._tooltip.clear(), h4), this.view.trackGraphicState(i21)]);
  }
  destroy() {
    this._segmentLabels = s(this._segmentLabels), this._tooltip = s(this._tooltip), this._removeManipulators();
  }
  get inputGeometry() {
    return r(this._editGeometryOperations) ? this._editGeometryOperations.data.geometry : null;
  }
  set inputGeometry(e21) {
    this._recreateEditGeometryAndManipulators(e21);
  }
  get updating() {
    return this.updatingHandles.updating;
  }
  get manipulators() {
    return this.tool.manipulators;
  }
  get view() {
    return this.tool.view;
  }
  get graphic() {
    return this.tool.graphic;
  }
  get enableZShape() {
    return this.tool.enableZShape;
  }
  get enableZVertex() {
    return this.tool.enableZVertex;
  }
  get enableMoveGraphic() {
    return this.tool.enableMoveGraphic;
  }
  get enableMidpoints() {
    return this.tool.enableMidpoints;
  }
  get enableEdgeOffset() {
    return this.tool.enableEdgeOffset;
  }
  get _labelOptions() {
    return this.tool.labelOptions;
  }
  get _tooltipOptions() {
    return this.tool.tooltipOptions;
  }
  removeSelectedVertices() {
    const e21 = this._manipulatorInfos.filter((e22) => e22.manipulator.selected && "vertex" === e22.type);
    this._removeVertices(e21);
  }
  onManipulatorSelectionChanged() {
    this.emit("manipulators-changed");
  }
  _removeManipulators() {
    this._manipulatorHandles.removeAll(), this._moveManipulation = s(this._moveManipulation), this._graphicMoveManipulation = s(this._graphicMoveManipulation), this.manipulators.removeAll(), this._manipulatorInfos = [], this._numGrabbing = 0, this._numDragging = 0;
  }
  _createManipulators() {
    if (t(this._editGeometryOperations))
      return;
    const e21 = f9(this.graphic);
    for (const t24 of this._editGeometryOperations.data.components) {
      for (const i21 of t24.vertices)
        this._createVertexOrEdgeManipulator(i21, e21);
      for (const i21 of t24.edges)
        this._createVertexOrEdgeManipulator(i21, e21);
    }
    this._createGraphicMoveManipulation(), this._createMoveManipulation(e21), this._createVisualElements();
  }
  get canRedo() {
    return r(this._editGeometryOperations) && this._editGeometryOperations.canRedo;
  }
  get canUndo() {
    return r(this._editGeometryOperations) && this._editGeometryOperations.canUndo;
  }
  redo() {
    if (t(this._editGeometryOperations))
      return null;
    const e21 = this._editGeometryOperations.redo();
    return r(e21) && (this.outputGeometry = this._editGeometryOperations.data.geometry, this._recreateManipulators()), e21;
  }
  undo() {
    if (t(this._editGeometryOperations))
      return null;
    this.emit("undo");
    const e21 = this._editGeometryOperations.undo();
    return r(e21) && (this.outputGeometry = this._editGeometryOperations.data.geometry, this._recreateManipulators()), e21;
  }
  _recreateManipulators() {
    this._removeManipulators(), this._tooltip.clear(), this._createManipulators();
  }
  _recreateEditGeometryAndManipulators(e21 = this.inputGeometry) {
    this._removeManipulators(), this._tooltip.clear(), t(e21) || (s(this._editGeometryOperations), this._editGeometryOperations = V.fromGeometry(e21, this.view.state.viewingMode), this._createManipulators(), s(this._segmentLabels), this._segmentLabels = new a18({ context: { view: this.view, editGeometryOperations: this._editGeometryOperations, elevationInfo: f9(this.graphic), labelOptions: this._labelOptions, graphic: this.graphic, graphicState: this._graphicState }, visible: this._labelOptions.enabled }));
  }
  _perGraphicManipulatorDragAction(e21, t24) {
    if ("end" === t24.action)
      return t24;
    let i21 = 0;
    const a25 = [], o18 = this._manipulatorInfos.some((e22) => "vertex" === e22.type && e22.manipulator.selected), n20 = e21 === Ze.SELECTED_OR_ALL && o18;
    for (const r22 of this._manipulatorInfos)
      "vertex" === r22.type && (r22.manipulator.grabbing || n20 && !r22.manipulator.selected || a25.push(r22), i21++);
    if (0 === a25.length)
      return t24;
    this._moveVertices(a25, t24);
    if (a25.length === i21) {
      if (this._updateEventState(Xe.MOVING), this.destroyed)
        return t24;
      this.emit("move", { type: "move", dx: t24.screenDeltaX, dy: t24.screenDeltaY, mover: this.graphic });
    } else {
      if (this._updateEventState(Xe.RESHAPING), this.destroyed)
        return t24;
      this.emit("reshape", { type: "reshape", mover: this.graphic });
    }
    return t24;
  }
  _isMultiVertexSelection() {
    let e21 = 0;
    for (const t24 of this._manipulatorInfos)
      "vertex" === t24.type && t24.manipulator.selected && e21++;
    return e21 > 1;
  }
  _perVertexManipulatorDragAction(e21) {
    if (this._updateEventState(Xe.RESHAPING), this.destroyed)
      return;
    const { mapDeltaX: t24, mapDeltaY: i21, mapDeltaZ: a25 } = e21;
    if (!t24 && !i21 && !a25)
      return;
    const o18 = [];
    for (const n20 of this._manipulatorInfos)
      "vertex" === n20.type && (n20.manipulator.selected && !n20.manipulator.grabbing || n20 === e21.info) && o18.push(n20);
    this._moveVertices(o18, e21, E7.ACCUMULATE_STEPS), this.emit("reshape", { type: "reshape", mover: this.graphic });
  }
  _updateEventState(e21) {
    if (e21 === this._reshapeEventState)
      return false;
    switch (e21) {
      case Xe.NONE:
        if (0 !== this._numGrabbing || 0 !== this._numDragging)
          return false;
        switch (this._reshapeEventState) {
          case Xe.MOVING:
            this.emit("move", { type: "move-stop", dx: 0, dy: 0, mover: this.graphic });
            break;
          case Xe.RESHAPING:
            this.emit("reshape", { type: "reshape-stop", mover: this.graphic });
        }
        break;
      case Xe.MOVING:
        switch (this._reshapeEventState) {
          case Xe.NONE:
            this.emit("move", { type: "move-start", dx: 0, dy: 0, mover: this.graphic });
            break;
          case Xe.RESHAPING:
            this.emit("reshape", { type: "reshape-stop", mover: this.graphic }), this.destroyed || this.emit("move", { type: "move-start", dx: 0, dy: 0, mover: this.graphic });
        }
        break;
      case Xe.RESHAPING:
        switch (this._reshapeEventState) {
          case Xe.NONE:
            this.emit("reshape", { type: "reshape-start", mover: this.graphic });
            break;
          case Xe.MOVING:
            this.emit("move", { type: "move-stop", dx: 0, dy: 0, mover: this.graphic }), this.destroyed || this.emit("reshape", { type: "reshape-start", mover: this.graphic });
        }
    }
    if (this.destroyed)
      return false;
    const t24 = this._reshapeEventState !== e21;
    return this._reshapeEventState = e21, t24;
  }
  _createGraphicMoveManipulation() {
    const { tool: e21, view: t24 } = this, i21 = this._graphicState;
    if (this._graphicMoveManipulation = new l18({ tool: e21, view: t24, graphicState: i21 }), this.enableMoveGraphic) {
      let e22 = null;
      this._manipulatorHandles.add(this._graphicMoveManipulation.createDragPipeline((t25, i22, a25) => {
        i22.next((e23) => this._trackNumDragging(e23)).next((t26) => ("start" === t26.action && (e22 = e(this._editGeometryOperations).createUndoGroup()), t26)).next((e23) => this._perGraphicManipulatorDragAction(Ze.ALL, e23)).next((e23) => (this._updateTranslateGraphicTooltip(M12.XY, e23), e23)).next((t26) => {
          "end" === t26.action && (this._tooltip.clear(), e22 = h(e22));
        }), a25.next(() => this._onDragCancel(true, () => e22 = h(e22)));
      })), this._graphicMoveManipulation.forEachManipulator((e23) => this._manipulatorHandles.add(this._watchAndUpdateGrabState(e23, false)));
    } else
      this._graphicMoveManipulation.forEachManipulator((e22) => {
        e22.grabbable = false, e22.cursor = null;
      });
    this._graphicMoveManipulation.forEachManipulator((e22) => this._manipulatorHandles.add(e22.events.on("immediate-click", (e23) => {
      this._manipulatorInfos.some((e24) => e24.manipulator.selected) ? this._clearSelection() : this.emit("immediate-click", { ...e23, graphic: this.graphic }), e23.stopPropagation();
    })));
  }
  _createMoveManipulation(e21) {
    const { graphic: t24, handles: i21, tool: a25, view: o18 } = this, n20 = this._graphicState;
    this._moveManipulation = new u13({ tool: a25, view: o18, xyAvailable: true, xyAxisAvailable: true, zAvailable: this.enableZShape && t19(t24), snapToScene: false, radius: u13.radiusForSymbol(t24.symbol) }), this._moveManipulation.forEachManipulator((e22) => i21.add([e22.events.on("immediate-click", (i22) => {
      this._moveManipulation.zManipulation.hasManipulator(e22) || this._manipulatorInfos.some((e23) => e23.manipulator.selected) || this.emit("immediate-click", { ...i22, graphic: t24 }), i22.stopPropagation();
    }), this._watchAndUpdateGrabState(e22, false)]));
    const r22 = (e22) => (t25) => {
      i21.add(t25.events.on("focus-changed", ({ action: t26 }) => {
        "focus" === t26 && this._tooltipOptions.enabled ? this._updateTranslateTooltip(e22) : this._tooltip.clear();
      }));
    };
    this._moveManipulation.xyManipulation.forEachManipulator(r22(M12.XY)), this._moveManipulation.xyAxisManipulation.forEachManipulator(r22(M12.XY_AXIS)), this._moveManipulation.zManipulation.forEachManipulator(r22(M12.Z)), this._moveManipulation.elevationInfo = { mode: "absolute-height", offset: 0 };
    const s19 = e(t24.geometry).spatialReference;
    i21.add([this._moveManipulation.createDragPipeline((i22, o19, n21, r23, s20) => {
      r23 = r23.next((e22) => (this._onDragCancel(), e22));
      return n21.next((e22) => this._trackNumDragging(e22)).next((e22) => {
        const t25 = this._manipulatorInfos.filter((e23) => "vertex" === e23.type && e23.manipulator.selected);
        return e22.manipulatorType === A12.TRANSLATE_XY && 1 === t25.length ? { ...e22, info: t25[0], snapOrigin: t25[0].handle.pos } : e22;
      }).next(X2(this.view, e21, t24)).next(this._snappingPipelineHandle.createSnapDragEventPipelineStep({ predicate: (e22) => !!e22.info, cancel: r23, snappingManager: a25.snappingManager, snappingContext: new e15({ editGeometryOperations: e(this._editGeometryOperations), elevationInfo: e21, pointer: s20, excludeFeature: t24, visualizer: new _6() }), updatingHandles: this.updatingHandles, useZ: false }), this._snappingPipelineHandle.next).next(P3()).next((e22) => this._perGraphicManipulatorDragAction(Ze.SELECTED_OR_ALL, e22)).next((e22) => (this._updateTranslateTooltip(i22, e22), e22));
    }, e21, s19, t24), l3(() => n20.displaying, () => {
      this._updateMoveManipulationPosition();
    }, h4), n20.on("changed", () => this._updateMoveManipulationPosition()), l3(() => n20.isDraped, (e22) => {
      this._updateMoveManipulationPosition();
      const t25 = "align-move-manipulation";
      e22 ? i21.add(this.view.elevationProvider.on("elevation-change", () => this._updateMoveManipulationPosition()), t25) : i21.remove(t25);
    }, h4)]);
  }
  _createVisualElements() {
    const { graphic: e21, view: t24 } = this, i21 = i15({ view: t24, graphic: e21, forEachManipulator: (e22) => {
      if (!this.destroyed) {
        this._graphicMoveManipulation.forEachManipulator(e22), this._moveManipulation.forEachManipulator(e22);
        for (const t25 of this._manipulatorInfos)
          e22(t25.manipulator, A12.TRANSLATE_XY);
      }
    }, onManipulatorsChanged: (e22) => this.on("manipulators-changed", e22) });
    r(i21) && (this._outlineVisualElement = i21.visualElement instanceof S8 ? i21.visualElement : null), r(this._outlineVisualElement) && this._manipulatorHandles.add(this._outlineVisualElement.events.on("attachment-origin-changed", () => {
      this._graphicState.isDraped || this._updateMoveManipulationPosition();
    })), this._manipulatorHandles.add(i21);
  }
  _createEdgeOffsetManipulator(e21, t24 = f9(this.graphic)) {
    const i21 = y7.reshapeManipulators.edgeOffset, a25 = i21.size / 2, o18 = a25 + i21.collisionPadding;
    if (t(this._edgeOffsetManipulatorGeometryInside) || t(this._edgeOffsetManipulatorGeometryOutside)) {
      const e22 = a25 / o18, t25 = e22 * Math.sqrt(3) / 2;
      this._edgeOffsetManipulatorGeometryInside = Z5(t25, e22 / 2, e22 / 2, i21.height, i21.offset), this._edgeOffsetManipulatorGeometryOutside = Z5(-t25, e22 / 2, e22 / 2, i21.height, -i21.offset);
    }
    const r22 = [{ geometry: this._edgeOffsetManipulatorGeometryInside, material: this._edgeOffsetManipulatorMaterial, stateMask: t12.Unfocused }, { geometry: this._edgeOffsetManipulatorGeometryInside, material: this._edgeOffsetManipulatorHoverMaterial, stateMask: t12.Focused }, { geometry: this._edgeOffsetManipulatorGeometryOutside, material: this._edgeOffsetManipulatorMaterial, stateMask: t12.Unfocused }, { geometry: this._edgeOffsetManipulatorGeometryOutside, material: this._edgeOffsetManipulatorHoverMaterial, stateMask: t12.Focused }], s19 = new ie({ view: this.view, renderObjects: r22, elevationInfo: "on-the-ground" !== t24.mode || d6(this.graphic.symbol) ? { mode: "absolute-height", offset: 0 } : t24, worldOriented: false, focusMultiplier: 1, radius: o18, available: !(!this.graphic.visible || !this.graphic.layer.visible), collisionType: { type: "disc", direction: r2(0, 0, 1) }, collisionPriority: 1, metadata: { deleting: false } }), h26 = new ie({ view: this.view, renderObjects: [], worldSized: true, worldOriented: false, available: !(!this.graphic.visible || !this.graphic.layer.visible), collisionPriority: -10, cursor: this.enableMoveGraphic ? "move" : "default", metadata: { deleting: false } }), d19 = { manipulator: s19, handle: e21, locationUpdateHandle: null, type: "edge", selectedIndex: 0, edgeManipulator: h26, elevationInfo: t24, visibilityHandle: null };
    this._autoHideEdgeOffsetManipulator(d19, i21.minSquaredEdgeLength), this._updateEdgeOffsetManipulator(d19);
    const u15 = [];
    for (const n20 of [d19.handle.leftVertex, d19.handle.rightVertex]) {
      const e22 = this._getManipulatorInfoFromHandle(n20);
      r(e22) && u15.push(e22.manipulator.events.on("location-update", () => this._updateEdgeOffsetManipulator(d19)));
    }
    d19.locationUpdateHandle = r5(u15), this._manipulatorHandles.add(d19.locationUpdateHandle, s19), this._manipulatorHandles.add([this._watchAndUpdateGrabState(s19, true), this._watchAndUpdateGrabState(h26, true)], s19), this._manipulatorHandles.add(d10(s19, this._createEdgeOffsetPipeline(d19, t24)), s19), this._manipulatorHandles.add(d10(h26, (e22, i22, a26, o19) => {
      if ("touch" === o19) {
        this._createEdgeOffsetPipeline(d19, t24)(e22, i22, a26);
      } else if (this.enableMoveGraphic) {
        const o20 = this.graphic, n20 = r(o20.geometry) ? o20.geometry.spatialReference : null;
        i22.next((e23) => this._trackNumDragging(e23)).next(C(this.view, e22.elevationAlignedLocation)).next(N4(this.view, e22.elevationAlignedLocation, t24, n20, o20)).next(U3()).next(P3()).next((e23) => this._perGraphicManipulatorDragAction(Ze.ALL, e23)).next((e23) => (this._updateTranslateGraphicTooltip(M12.XY, e23), e23)).next((e23) => {
          "end" === e23.action && this._tooltip.clear();
        }), a26.next(() => this._onDragCancel(!e22.metadata.deleting));
      }
    }), s19);
    const c16 = (e22) => {
      this._manipulatorInfos.some((e23) => e23.manipulator.selected) ? this._clearSelection() : this.emit("immediate-click", { ...e22, graphic: this.graphic }), e22.stopPropagation();
    };
    return this._manipulatorHandles.add([s19.events.on("immediate-click", c16), h26.events.on("immediate-click", c16), s19.events.on("focus-changed", ({ action: e22 }) => {
      const t25 = this._tooltipOptions;
      if ("focus" === e22 && t25.enabled) {
        const e23 = this._tooltip.info = new p20({ tooltipOptions: t25 });
        this._updateTooltipAreaOrTotalLength(e23);
      } else
        this._tooltip.clear();
    })], s19), this._manipulatorInfos.push(d19), this.manipulators.add(s19), this.manipulators.add(h26), this.emit("manipulators-changed"), d19;
  }
  _autoHideEdgeOffsetManipulator(e21, t24) {
    const i21 = e21.manipulator, a25 = e21.edgeManipulator, o18 = () => {
      e21.visibilityHandle = h(e21.visibilityHandle);
      const o19 = this._getManipulatorInfoFromHandle(e21.handle.leftVertex), r22 = this._getManipulatorInfoFromHandle(e21.handle.rightVertex), s19 = r(o19) && r(r22) && R5(o19.manipulator.renderLocation, r22.manipulator.renderLocation, this.view.state.camera) < t24;
      (!i21.focused && !a25.focused || s19) && (i21.grabbable = !s19, a25.grabbable = !s19, e21.visibilityHandle = r5([i21.disableDisplay(), { remove: () => {
        i21.grabbable = true, a25.grabbable = this.enableMoveGraphic;
      } }]));
    };
    this._manipulatorHandles.add([i21.events.on("focus-changed", o18), a25.events.on("focus-changed", o18), { remove: () => {
      h(e21.visibilityHandle), a25.metadata.deleting = true, this.manipulators.remove(a25);
    } }], i21), o18();
  }
  _updateEdgeOffsetManipulator(e21) {
    this._updateManipulatorPosition(e21);
    const { coordinateHelper: t24 } = e(this._editGeometryOperations).data, i21 = h21(this.view, e21.manipulator.elevationAlignedLocation, j11(t24, e21.handle, e(e21.manipulator.elevationInfo))), a25 = this._getManipulatorInfoFromHandle(e21.handle.leftVertex), o18 = this._getManipulatorInfoFromHandle(e21.handle.rightVertex);
    if (t(a25) || t(o18))
      return;
    const n20 = a25.manipulator.renderLocation, r22 = o18.manipulator.renderLocation, s19 = r(i21) ? C13(i21, n20, r22) : o4;
    e21.manipulator.modelTransform = s19, e21.edgeManipulator.elevationAlignedLocation = e21.manipulator.elevationAlignedLocation, e21.edgeManipulator.modelTransform = s19;
    const d19 = s2(e2(Re, n20, r22)) / 2;
    e21.edgeManipulator.collisionType = { type: "line", paths: [[[-d19, 0, 0], [d19, 0, 0]]] };
  }
  _createEdgeOffsetPipeline(e21, t24) {
    return (i21, a25, o18) => {
      this._clearSelection();
      const { step: n20, cleanup: r22 } = this._initializeEdgeOffset(e21, t24);
      a25.next((e22) => this._trackNumDragging(e22)).next(C(this.view, i21.elevationAlignedLocation)).next(n20).next(T11(this.view)).next(F6(this.view, e(this._editGeometryOperations).data.spatialReference)).next(P3()).next(this._applyComputeEdgeOffsetDistanceStep()).next(this._applyEdgeOffsetStep(e21)).next(this._showEdgeOffsetTooltip()).next((e22) => {
        "end" === e22.action && r22();
      }), o18.next(() => {
        i21.metadata.deleting || (r22(), this._onDragCancel());
      });
    };
  }
  _initializeEdgeOffset(e21, t24) {
    const i21 = e(this._editGeometryOperations), a25 = j11(i21.data.coordinateHelper, e21.handle, t24), o18 = i21.createUndoGroup(), s19 = h21(this.view, e21.manipulator.elevationAlignedLocation, a25);
    if (a25.requiresSplitEdgeLeft) {
      const t25 = this._getManipulatorInfoFromHandle(e21.handle.leftVertex.leftEdge);
      r(t25) && this._splitEdgeManipulator(t25, 1);
    }
    if (a25.requiresSplitEdgeRight) {
      const t25 = this._getManipulatorInfoFromHandle(e21.handle.rightVertex.rightEdge);
      r(t25) && this._splitEdgeManipulator(t25, 0);
    }
    const u15 = () => new m3({ paths: [[e21.handle.leftVertex.pos, e21.handle.rightVertex.pos]], spatialReference: i21.data.spatialReference }), c16 = new S8({ view: this.view, isDraped: this._graphicState.isDraped, geometry: u15(), elevationInfo: e21.elevationInfo, width: y7.visualElements.lineGraphics.outline.width, color: y7.colorToVec4(r16.main), attached: true });
    let m21;
    const _10 = () => {
      this._cleanEdgeOffsetCollapsedEdges(e21), m21 = h(m21);
    }, f18 = this.on("undo", _10);
    return m21 = r5([t3(c16), l3(() => this._graphicState.isDraped, (e22) => c16.isDraped = e22), this._graphicState.on("changed", () => c16.geometry = u15()), o18, f18]), { step: (e22) => t(a25) || t(s19) ? (_10(), null) : { ...e22, operation: a25, plane: s19 }, cleanup: _10 };
  }
  _applyEdgeOffsetStep(e21) {
    return (t24) => {
      if (this.destroyed || t(t24.operation))
        return t24;
      this._updateEventState(Xe.RESHAPING);
      const { mapDeltaX: i21, mapDeltaY: a25, mapDeltaZ: o18 } = t24;
      return (i21 || a25 || o18) && (this._offsetEdge(e21, t24), this.emit("reshape", { type: "reshape", mover: this.graphic })), t24;
    };
  }
  _applyComputeEdgeOffsetDistanceStep() {
    return (e21) => {
      const { operation: t24, mapEnd: i21 } = e21;
      return t(t24) || t(i21) ? e21 : ("start" === e21.action && t24.selectArrowFromStartPoint(i21), { ...e21, signedDistance: t24.signedDistanceToPoint(i21) });
    };
  }
  _showEdgeOffsetTooltip() {
    return (e21) => {
      const { mapEnd: t24, signedDistance: i21, operation: a25 } = e21, o18 = this._tooltip, n20 = this._tooltipOptions;
      if (!n20.enabled || t(i21))
        return o18.clear(), e21;
      let r22 = o18.info;
      (t(r22) || "reshape-edge-offset" !== r22.type) && (r22 = o18.info = new p20({ tooltipOptions: n20 }));
      const { coordinateHelper: s19 } = e(this._editGeometryOperations).data;
      return r22.distance = "end" === e21.action ? j5 : Ne(this._graphicState.isDraped, i21 * a25.selectedArrow, t24, a25.plane, s19), this._updateTooltipAreaOrTotalLength(r22), e21;
    };
  }
  _cleanEdgeOffsetCollapsedEdges(e21) {
    var _a, _b;
    const t24 = (_a = e21.handle.leftVertex.leftEdge) == null ? void 0 : _a.leftVertex, i21 = e21.handle.leftVertex, a25 = (_b = e21.handle.rightVertex.rightEdge) == null ? void 0 : _b.rightVertex, o18 = e21.handle.rightVertex, n20 = e(this._editGeometryOperations).data.coordinateHelper, r22 = [];
    if (t24 && n20.distance(t24.pos, i21.pos) < Fe) {
      const e22 = this._getManipulatorInfoFromHandle(i21);
      r(e22) && r22.push(e22);
    }
    if (n20.distance(i21.pos, o18.pos) < Fe || a25 && n20.distance(a25.pos, o18.pos) < Fe) {
      const e22 = this._getManipulatorInfoFromHandle(o18);
      r(e22) && r22.push(e22);
    }
    r22.length && this._removeVertices(r22);
  }
  _computeVertexManipulatorSizeAndOutline(e21) {
    const t24 = e21.size / 2, i21 = t24 + e21.collisionPadding;
    return { size: t24 / i21, outlineSize: (t24 + e21.outlineSize) / i21 };
  }
  _createVertexOrEdgeManipulator(e21, t24 = f9(this.graphic)) {
    if ("edge" === e21.type) {
      if (this.enableEdgeOffset)
        return this._createEdgeOffsetManipulator(e21, t24);
      if (!this.enableMidpoints)
        return null;
    }
    if (t(this._vertexManipulatorGeometry) || t(this._vertexManipulatorOutlineGeometry)) {
      const { size: e22, outlineSize: t25 } = this._computeVertexManipulatorSizeAndOutline(y7.reshapeManipulators.vertex);
      this._vertexManipulatorGeometry = T3(e22, 16, 16), this._vertexManipulatorOutlineGeometry = T3(t25, 16, 16);
    }
    if (t(this._edgeManipulatorGeometry) || t(this._edgeManipulatorOutlineGeometry)) {
      const { size: e22, outlineSize: t25 } = this._computeVertexManipulatorSizeAndOutline(y7.reshapeManipulators.edge);
      this._edgeManipulatorGeometry = T3(e22, 16, 16), this._edgeManipulatorOutlineGeometry = T3(t25, 16, 16);
    }
    const i21 = r(this.graphic.geometry) && "point" === this.graphic.geometry.type ? [] : [{ geometry: this._vertexManipulatorGeometry, material: this._vertexManipulatorMaterial, stateMask: ze.Vertex | t12.Unselected }, { geometry: this._vertexManipulatorOutlineGeometry, material: this._vertexManipulatorOutlineMaterial, stateMask: ze.Vertex | t12.Unfocused | t12.Unselected }, { geometry: this._vertexManipulatorOutlineGeometry, material: this._vertexManipulatorHoverOutlineMaterial, stateMask: ze.Vertex | t12.Focused | t12.Unselected }, { geometry: this._vertexManipulatorGeometry, material: this._selectedManipulatorMaterial, stateMask: t12.Selected }, { geometry: this._vertexManipulatorOutlineGeometry, material: this._selectedManipulatorOutlineMaterial, stateMask: t12.Selected | t12.Unfocused }, { geometry: this._vertexManipulatorOutlineGeometry, material: this._selectedManipulatorHoverOutlineMaterial, stateMask: t12.Selected | t12.Focused }];
    this.enableMidpoints && i21.push({ geometry: this._edgeManipulatorGeometry, material: this._vertexManipulatorMaterial, stateMask: ze.Edge | t12.Focused | t12.Unselected }, { geometry: this._edgeManipulatorOutlineGeometry, material: this._vertexManipulatorHoverOutlineMaterial, stateMask: ze.Edge | t12.Focused | t12.Unselected }, { geometry: this._edgeManipulatorGeometry, material: this._edgeManipulatorMaterial, stateMask: ze.Edge | t12.Unfocused | t12.Unselected }, { geometry: this._edgeManipulatorOutlineGeometry, material: this._edgeManipulatorOutlineMaterial, stateMask: ze.Edge | t12.Unfocused | t12.Unselected });
    const a25 = new ie({ view: this.view, renderObjects: i21, elevationInfo: t24, focusMultiplier: 1, touchMultiplier: 1, available: !(!this.graphic.visible || !this.graphic.layer.visible), metadata: { deleting: false } });
    this._setTypeSpecificManipulatorSettings(a25, e21, t24);
    const o18 = "edge" === e21.type ? { manipulator: a25, handle: e21, locationUpdateHandle: null, type: "edge", selectedIndex: 0 } : { manipulator: a25, handle: e21, type: "vertex", selectedIndex: 0 };
    if (this._manipulatorInfos.push(o18), this.manipulators.add(a25), this._updateManipulatorPosition(o18), "edge" === o18.type) {
      const e22 = [];
      for (const t25 of [o18.handle.leftVertex, o18.handle.rightVertex]) {
        const i22 = this._getManipulatorInfoFromHandle(t25);
        r(i22) && e22.push(i22.manipulator.events.on("location-update", () => this._updateManipulatorPosition(o18)));
      }
      o18.locationUpdateHandle = r5(e22), this._manipulatorHandles.add(o18.locationUpdateHandle, a25);
    }
    this._manipulatorHandles.add(this._watchAndUpdateGrabState(a25, true), a25);
    const r22 = d10(a25, (e22, i22, a26, n20) => {
      let r23 = null;
      a26 = a26.next((t25) => (this._onDragCancel(!e22.metadata.deleting, () => r23 = h(r23)), t25)), i22.next((e23) => this._trackNumDragging(e23)).next((e23) => {
        if ("start" === e23.action && (r23 = e(this._editGeometryOperations).createUndoGroup()), "edge" === o18.type) {
          const t25 = this._splitEdgeManipulator(o18);
          return { ...e23, info: t25, snapOrigin: t25.handle.pos };
        }
        return { ...e23, info: o18, snapOrigin: o18.handle.pos };
      }).next(C(this.view, e22.elevationAlignedLocation)).next(P10(this.view, this.graphic, e22.elevationAlignedLocation, e22.location.spatialReference, this.graphic)).next(X2(this.view, t24, this.graphic)).next(this._snappingPipeline.createSnapDragEventPipelineStep({ predicate: () => !this._isMultiVertexSelection(), cancel: a26, snappingManager: this.tool.snappingManager, snappingContext: new e15({ editGeometryOperations: e(this._editGeometryOperations), elevationInfo: t24, pointer: n20, excludeFeature: this.graphic, visualizer: new _6() }), updatingHandles: this.updatingHandles, useZ: false }), this._snappingPipeline.next).next(P3()).next((t25) => {
        this._perVertexManipulatorDragAction(t25), "end" === t25.action && (r23 = h(r23)), this._updateTranslateVertexTooltip(e22, M12.XY, t25);
      });
    });
    return this._manipulatorHandles.add([r22, a25.events.on("immediate-click", (e22) => this._manipulatorClickCallback(e22, o18)), a25.events.on("select-changed", () => {
      o18.selectedIndex = ++this._selectedIndex, this._updateMoveManipulationPosition();
    }), a25.events.on("focus-changed", ({ action: e22 }) => {
      "focus" === e22 && "edge" !== o18.type ? this._updateTranslateVertexTooltip(a25, M12.XY) : this._tooltip.clear();
    })], a25), this.emit("manipulators-changed"), o18;
  }
  _trackNumDragging(e21) {
    switch (e21.action) {
      case "start":
        this._numDragging++;
        break;
      case "end":
        this._numDragging--;
    }
    return e21;
  }
  _onDragCancel(e21 = true, t24) {
    switch (this._numDragging--, e21 && (this.undo(), this.outputGeometry = r(this._editGeometryOperations) ? this._editGeometryOperations.data.geometry : null), r(this.tool.snappingManager) && this.tool.snappingManager.doneSnapping(), this._tooltip.clear(), this._reshapeEventState) {
      case Xe.NONE:
        break;
      case Xe.MOVING:
        this.emit("move", { type: "move", dx: 0, dy: 0, mover: this.graphic });
        break;
      case Xe.RESHAPING:
        this.emit("reshape", { type: "reshape", mover: this.graphic });
    }
    t24 && t24(), this.destroyed || this._updateEventState(Xe.NONE);
  }
  _setTypeSpecificManipulatorSettings(e21, t24, i21) {
    switch (t24.type) {
      case "vertex":
        e21.state = ze.Vertex, e21.selectable = true, e21.cursor = "move", e21.collisionPriority = 2, e21.radius = y7.reshapeManipulators.vertex.size / 2 + y7.reshapeManipulators.vertex.collisionPadding, e21.elevationInfo = i21, e21.interactive = r(this.graphic.geometry) && "point" !== this.graphic.geometry.type;
        break;
      case "edge":
        e21.state = ze.Edge, e21.selectable = false, e21.cursor = "copy", e21.collisionPriority = -1, e21.radius = y7.reshapeManipulators.edge.size / 2 + y7.reshapeManipulators.edge.collisionPadding, e21.elevationInfo = "on-the-ground" !== i21.mode || d6(this.graphic.symbol) ? { mode: "absolute-height", offset: 0 } : i21;
    }
  }
  _watchAndUpdateGrabState(e21, t24) {
    return e21.events.on("grab-changed", (i21) => this._onGrabStateChanged(e21, t24, i21.action, i21.pointerType));
  }
  _onGrabStateChanged(e21, t24, i21, a25 = "mouse") {
    if ("start" === i21)
      t24 && this._updateSelection(e21), this._numGrabbing++;
    else if (this._numGrabbing--, this._updateEventState(Xe.NONE), this.destroyed)
      return;
    this._moveManipulation.interactive = !this._numGrabbing, ("touch" !== a25 || this.enableEdgeOffset) && (this._manipulatorInfos.forEach((e22) => {
      e22.manipulator.interactive = e22.manipulator.grabbing || !this._numGrabbing && r(this.graphic.geometry) && "point" !== this.graphic.geometry.type, "edgeManipulator" in e22 && (e22.edgeManipulator.interactive = e22.edgeManipulator.grabbing || !this._numGrabbing);
    }), this._graphicMoveManipulation.forEachManipulator((e22) => {
      e22.interactive = e22.grabbing || !this._numGrabbing;
    }));
  }
  _clearSelection() {
    for (const e21 of this._manipulatorInfos)
      e21.manipulator.grabbing || (e21.manipulator.selected = false);
  }
  _updateSelection(e21) {
    e21.grabbing && !e21.selected && e21.selectable && (this._clearSelection(), e21.selected = true, this.emit("manipulators-changed"));
  }
  _removeManipulator(e21) {
    t(e21) || (e21.manipulator.metadata.deleting = true, this.manipulators.remove(e21.manipulator), this._manipulatorHandles.remove(e21.manipulator), v2(this._manipulatorInfos, e21), this.emit("manipulators-changed"));
  }
  _getManipulatorInfoFromHandle(e21) {
    if (e21) {
      for (const t24 of this._manipulatorInfos)
        if (e21 === t24.handle)
          return t24;
    }
    return null;
  }
  _updateManipulatorPosition(e21) {
    if (t(e21))
      return;
    const t24 = e(this._editGeometryOperations);
    if ("vertex" === e21.type)
      e21.manipulator.location = t24.data.coordinateHelper.vectorToDehydratedPoint(e21.handle.pos, Ce), e21.manipulator.grabbing && r(this._vertexLaserLineVisualElement) && (this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation = e21.manipulator.renderLocation);
    else if ("edge" === e21.type) {
      const i21 = this._getManipulatorInfoFromHandle(e21.handle.leftVertex), a25 = this._getManipulatorInfoFromHandle(e21.handle.rightVertex);
      if (t(i21) || t(a25))
        return;
      const o18 = i21.manipulator, n20 = a25.manipulator;
      if (r(e21.manipulator.elevationInfo) && "on-the-ground" === e21.manipulator.elevationInfo.mode) {
        const i22 = o18.location, a26 = n20.location, r22 = 0.5, s19 = i22.x + r22 * (a26.x - i22.x), l21 = i22.y + r22 * (a26.y - i22.y), p23 = i22.hasZ && a26.hasZ ? 0 : void 0;
        e21.manipulator.location = v5(s19, l21, p23, t24.data.spatialReference);
      } else
        A(Re, o18.renderLocation, n20.renderLocation, 0.5), e21.manipulator.renderLocation = Re;
    }
  }
  _splitEdgeManipulator(e21, t24 = 0.5) {
    const i21 = e(this._editGeometryOperations), a25 = e(i21.splitEdge(e21.handle, t24).createdVertex);
    e21.locationUpdateHandle.remove(), e21.locationUpdateHandle = void 0;
    const o18 = f9(this.graphic);
    let n20;
    this.enableEdgeOffset ? (this._removeManipulator(e21), n20 = this._createVertexOrEdgeManipulator(a25)) : (n20 = e21, n20.handle = a25, n20.type = "vertex", this._setTypeSpecificManipulatorSettings(e21.manipulator, e21.handle, o18)), a25.leftEdge && this._createVertexOrEdgeManipulator(a25.leftEdge), a25.rightEdge && this._createVertexOrEdgeManipulator(a25.rightEdge), this.outputGeometry = i21.data.geometry, this._updateManipulatorPosition(n20), this.enableEdgeOffset || this._updateTranslateVertexTooltip(n20.manipulator, M12.XY), this._updateSelection(e21.manipulator);
    const r22 = this._updateEventState(Xe.RESHAPING), s19 = i21.data.coordinateHelper.vectorToArray(n20.handle.pos), l21 = i21.data.components.indexOf(a25.component);
    return this.emit("vertex-add", { type: "vertex-add", vertices: [{ coordinates: s19, componentIndex: l21, vertexIndex: e(a25.index) }], added: s19 }), r22 && this._updateEventState(Xe.NONE), n20;
  }
  _updateMoveManipulationPosition() {
    const e21 = o2(Re, 0, 0, 0);
    let t24 = 0, i21 = false, a25 = null, o18 = null;
    for (const n20 of this._manipulatorInfos)
      "vertex" === n20.type && (n20.manipulator.selected ? (t24++, u(e21, e21, n20.manipulator.renderLocation), t(a25) || n20.selectedIndex > a25.selectedIndex ? (o18 = a25, a25 = n20) : (t(o18) || n20.selectedIndex > o18.selectedIndex) && (o18 = n20)) : i21 = true);
    if (0 !== t24) {
      const e22 = this._graphicState.displaying;
      this._moveManipulation.xyManipulation.available = e22, this._moveManipulation.xyAxisManipulation.available = e22, this._moveManipulation.zManipulation.available = e22 && this.enableZVertex && t19(this.graphic), this._moveManipulation.xyAxisManipulation.orthogonalAvailable = e22 && 1 !== t24;
    } else {
      const e22 = this._graphicState.displaying && this.enableMoveGraphic;
      this._moveManipulation.xyManipulation.available = e22, this._moveManipulation.xyAxisManipulation.available = e22, this._moveManipulation.xyAxisManipulation.orthogonalAvailable = e22, this._moveManipulation.zManipulation.available = e22 && this.enableZShape && t19(this.graphic);
    }
    if (0 !== t24) {
      let e22 = 0;
      if (r(a25)) {
        const t25 = a25.handle.pos, i22 = r(o18) ? o18.handle.pos : a25.handle.leftEdge && a25.handle.leftEdge.leftVertex ? a25.handle.leftEdge.leftVertex.pos : null, n20 = t(o18) && a25.handle.rightEdge && a25.handle.rightEdge.rightVertex ? a25.handle.rightEdge.rightVertex.pos : null;
        i22 && n20 ? this._moveManipulation.xyAxisManipulation.available = false : i22 ? e22 = ke(i22, t25) : n20 && (e22 = ke(t25, n20));
      }
      this._moveManipulation.angle = e22, this._moveManipulation.radius = I4;
    } else
      this._moveManipulation.angle = a22(e(this.graphic.geometry)), this._moveManipulation.radius = u13.radiusForSymbol(this.graphic.symbol);
    0 !== t24 && i21 ? (g(e21, e21, 1 / t24), Ce.spatialReference = e(this._editGeometryOperations).data.spatialReference, Ce.hasZ = true, this.view.renderCoordsHelper.fromRenderCoords(e21, Ce), this._moveManipulation.elevationAlignedLocation = Ce) : r(this._outlineVisualElement) && !this._graphicState.isDraped && r(this._outlineVisualElement.attachmentOrigin) ? this._moveManipulation.elevationAlignedLocation = this._outlineVisualElement.attachmentOrigin : C9(this.view, this._moveManipulation, this.graphic);
  }
  _removeVertices(e21) {
    const t24 = [], i21 = e(this._editGeometryOperations);
    for (const a25 of e21)
      if ("vertex" === a25.type && i21.canRemoveVertex()) {
        t24.push(a25.handle), this._removeManipulator(a25), this._removeManipulator(this._getManipulatorInfoFromHandle(a25.handle.leftEdge)), this._removeManipulator(this._getManipulatorInfoFromHandle(a25.handle.rightEdge));
        const e22 = e(i21.removeVertices([a25.handle]).removedVertices[0].createdEdge);
        e22 && this._createVertexOrEdgeManipulator(e22);
      }
    if (t24.length > 0) {
      const e22 = t24.map((e23) => {
        const t25 = i21.data.components.indexOf(e23.component);
        return { coordinates: i21.data.coordinateHelper.vectorToArray(e23.pos), componentIndex: t25, vertexIndex: e(e23.index) };
      });
      this.outputGeometry = i21.data.geometry;
      const a25 = this._updateEventState(Xe.RESHAPING);
      if (this.destroyed)
        return;
      if (this.emit("vertex-remove", { type: "vertex-remove", removed: e22.map((e23) => e23.coordinates), vertices: e22 }), this.destroyed)
        return;
      if (a25 && (this._updateEventState(Xe.NONE), this.destroyed))
        return;
      this._updateMoveManipulationPosition();
    }
  }
  _moveVertices(e21, t24, i21 = "start" === t24.action ? E7.NEW_STEP : E7.ACCUMULATE_STEPS) {
    const a25 = e(this._editGeometryOperations);
    a25.moveVertices(e21.map((e22) => e22.handle), t24.mapDeltaX, t24.mapDeltaY, t24.mapDeltaZ, i21), this.outputGeometry = a25.data.geometry;
    for (const o18 of e21)
      this._updateManipulatorPosition(o18);
  }
  _offsetEdge(e21, t24) {
    if (t(t24.operation) || t(t24.signedDistance))
      return;
    const i21 = e(this._editGeometryOperations), a25 = t24.operation.clone();
    a25.distance = t24.signedDistance, i21.updateVertices([e21.handle.leftVertex, e21.handle.rightVertex], a25), this.outputGeometry = i21.data.geometry, this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e21.handle.leftVertex)), this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e21.handle.rightVertex));
  }
  _manipulatorClickCallback(e21, t24) {
    e21.shiftKey || this._clearSelection(), "vertex" === t24.type && (t24.manipulator.selected = !t24.manipulator.selected, e21.button === t11.Right && this._removeVertices([t24])), "edge" === t24.type && e21.button === t11.Left && this._splitEdgeManipulator(t24), e21.stopPropagation();
  }
  _updateTranslateTooltip(e21, t24) {
    const i21 = this._manipulatorInfos.filter((e22) => "vertex" === e22.type && e22.manipulator.selected);
    1 === i21.length ? this._updateTranslateVertexTooltip(i21[0].manipulator, e21, t24) : this._updateTranslateGraphicTooltip(e21, t24);
  }
  _updateTranslateGraphicTooltip(e21, t24) {
    const i21 = this._tooltipOptions;
    if (!i21.enabled)
      return;
    const a25 = this._graphicState.isDraped ? "on-the-ground" : "absolute-height";
    switch (e21) {
      case M12.XY:
        this._tooltip.info = new r14({ tooltipOptions: i21 }), this._updateTranslateTooltipDistance(this._tooltip.info, t24, (e22, t25) => a14(e22, t25, a25));
        break;
      case M12.XY_AXIS:
        this._tooltip.info = new a16({ tooltipOptions: i21 }), this._updateTranslateTooltipDistance(this._tooltip.info, t24, (e22, i22) => {
          const o18 = a14(e22, i22, a25);
          return y6(o18, i18(t24));
        });
        break;
      case M12.Z:
        this._tooltip.info = new p13({ tooltipOptions: i21 }), this._updateTranslateTooltipDistance(this._tooltip.info, t24, v7);
    }
  }
  _updateTranslateVertexTooltip(e21, t24, i21) {
    const a25 = this._tooltipOptions;
    if (!a25.enabled)
      return;
    let o18;
    const n20 = this._graphicState.isDraped ? "on-the-ground" : "absolute-height";
    switch (t24) {
      case M12.XY:
        o18 = new n10({ tooltipOptions: a25 }), this._updateTranslateTooltipDistance(o18, i21, (e22, t25) => a14(e22, t25, n20)), this._updateTooltipAreaOrTotalLength(o18);
        break;
      case M12.XY_AXIS:
        o18 = new c8({ tooltipOptions: a25 }), this._updateTranslateTooltipDistance(o18, i21, (e22, t25) => {
          const a26 = a14(e22, t25, n20);
          return y6(a26, i18(i21));
        }), this._updateTooltipAreaOrTotalLength(o18);
        break;
      case M12.Z:
        o18 = new l15({ tooltipOptions: a25 }), this._updateTranslateTooltipDistance(o18, i21, v7);
    }
    const r22 = x7(e21.elevationAlignedLocation);
    r(r22) && (o18.elevation = { mode: "absolute-height", ...r22 }), this._tooltip.info = o18;
  }
  _updateTranslateTooltipDistance(e21, t24, i21) {
    if (r(t24) && "end" !== t24.action) {
      const { mapStart: a25, mapEnd: o18 } = t24, n20 = i21(a25, o18);
      e21.distance = r(n20) ? n20 : j5;
    }
  }
  _updateTooltipAreaOrTotalLength(e21) {
    const { geometry: t24 } = this.graphic;
    if (t(t24))
      return;
    const i21 = this._graphicState.isDraped ? "on-the-ground" : "absolute-height";
    e21.area = "polygon" === t24.type ? i11(t24, i21) : null, e21.totalLength = "polyline" === t24.type ? m10(t24, i21) : null;
  }
  get test() {
    return { segmentLabels: this._segmentLabels, tooltip: this._tooltip };
  }
};
function ke(e21, t24) {
  return Math.atan2(t24[1] - e21[1], t24[0] - e21[0]) + Math.PI / 2;
}
function Ne(e21, t24, i21, a25, o18) {
  if (e21) {
    const e22 = o18.toXYZ(o18.pointToVector(i21)), n20 = H2(a25, e22, c2.get()), r22 = l13(n20, e22, o18.spatialReference);
    if (r(r22))
      return a13(r22.value * Math.sign(t24), r22.unit);
  }
  return a13(t24 * $(i21.spatialReference), "meters");
}
e3([y2()], Ue.prototype, "_segmentLabels", void 0), e3([y2({ constructOnly: true })], Ue.prototype, "tool", void 0), e3([y2()], Ue.prototype, "_tooltip", void 0), e3([y2()], Ue.prototype, "inputGeometry", null), e3([y2()], Ue.prototype, "outputGeometry", void 0), e3([y2({ readOnly: true })], Ue.prototype, "updating", null), e3([y2()], Ue.prototype, "manipulators", null), e3([y2()], Ue.prototype, "view", null), e3([y2()], Ue.prototype, "graphic", null), e3([y2()], Ue.prototype, "enableZShape", null), e3([y2()], Ue.prototype, "enableZVertex", null), e3([y2()], Ue.prototype, "enableMoveGraphic", null), e3([y2()], Ue.prototype, "enableMidpoints", null), e3([y2()], Ue.prototype, "enableEdgeOffset", null), e3([y2()], Ue.prototype, "_labelOptions", null), e3([y2()], Ue.prototype, "_tooltipOptions", null), Ue = e3([n4("esri.views.3d.interactive.editingTools.reshapeGraphic.ReshapeOperation")], Ue);
var Ce = v5(0, 0, null, null);
var Re = n2();
var Fe = 1e-6;
var ze;
var Xe;
var Ze;
!function(e21) {
  e21.Vertex = u7.Custom1, e21.Edge = u7.Custom2;
}(ze || (ze = {})), function(e21) {
  e21[e21.NONE = 0] = "NONE", e21[e21.MOVING = 1] = "MOVING", e21[e21.RESHAPING = 2] = "RESHAPING";
}(Xe || (Xe = {})), function(e21) {
  e21[e21.ALL = 0] = "ALL", e21[e21.SELECTED_OR_ALL = 1] = "SELECTED_OR_ALL";
}(Ze || (Ze = {}));

// node_modules/@arcgis/core/views/3d/interactive/editingTools/reshapeGraphic/GraphicReshapeTool.js
var v14 = class extends n5.EventedMixin(p11) {
  constructor(e21) {
    super(e21), this._handles = new t4(), this._internalGeometryUpdate = false, this.enableZShape = true, this.enableZVertex = true, this.enableMoveGraphic = true, this.enableMidpoints = true, this.enableEdgeOffset = false, this.type = "reshape-3d", this.labelOptions = new c4(), this.tooltipOptions = new p8(), this.snappingManager = null, this.automaticManipulatorSelection = false;
  }
  initialize() {
    const e21 = this._reshapeOperation = new Ue({ tool: this });
    this.addHandles([e21.on("reshape", (e22) => {
      "reshape" === e22.type && this._onReshapeGeometryChanged(), this.emit("reshape", e22);
    }), e21.on("move", (e22) => {
      "move" === e22.type && this._onReshapeGeometryChanged(), this.emit("move", e22);
    }), e21.on("vertex-add", (e22) => {
      this._onReshapeGeometryChanged(), this.emit("vertex-add", e22);
    }), e21.on("vertex-remove", (e22) => {
      this._onReshapeGeometryChanged(), this.emit("vertex-remove", e22);
    }), e21.on("immediate-click", (e22) => this.emit("immediate-click", e22)), this.view.on("pointer-down", ["Shift"], (e22) => {
      e22.stopPropagation();
    }), l3(() => this.graphic, () => this._updateGraphic(), w3)]), this.finishToolCreation();
  }
  destroy() {
    this._handles = s(this._handles), this._reshapeOperation = s(this._reshapeOperation);
  }
  get updating() {
    var _a, _b;
    return (_b = (_a = this._reshapeOperation) == null ? void 0 : _a.updating) != null ? _b : false;
  }
  _updateGeometry() {
    const e21 = m7(this.graphic);
    this._reshapeOperation.inputGeometry = r(e21) ? e21.clone() : null;
  }
  _updateGraphic() {
    if (this._handles.remove("onGraphicGeometryChange"), this._updateGeometry(), l11(this.graphic) !== P2.SUPPORTED)
      return;
    const e21 = l3(() => {
      var _a;
      return (_a = this.graphic) == null ? void 0 : _a.geometry;
    }, () => {
      false === this._internalGeometryUpdate && this._updateGeometry();
    }, U2);
    this._handles.add(e21, "onGraphicGeometryChange");
  }
  onManipulatorSelectionChanged() {
    this._reshapeOperation && this._reshapeOperation.onManipulatorSelectionChanged();
  }
  _updateGeometryInternally(e21) {
    this._internalGeometryUpdate = true, this.graphic.geometry = e21, this._internalGeometryUpdate = false;
  }
  _onReshapeGeometryChanged() {
    t(this.graphic) || this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone());
  }
  get canUndo() {
    var _a;
    return (_a = this._reshapeOperation.canUndo) != null ? _a : false;
  }
  undo() {
    r(this.snappingManager) && this.snappingManager.doneSnapping(), r(this._reshapeOperation.undo()) && this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone());
  }
  get canRedo() {
    var _a;
    return (_a = this._reshapeOperation.canRedo) != null ? _a : false;
  }
  redo() {
    r(this.snappingManager) && this.snappingManager.doneSnapping(), r(this._reshapeOperation.redo()) && this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone());
  }
  onInputEvent(e21) {
    "key-down" !== e21.type || "Delete" !== e21.key && "Backspace" !== e21.key || this._reshapeOperation.removeSelectedVertices();
  }
  reset() {
  }
  get test() {
    return { snappingManager: this.snappingManager, reshapeOperation: this._reshapeOperation };
  }
};
e3([y2()], v14.prototype, "_reshapeOperation", void 0), e3([y2({ constructOnly: true, nonNullable: true })], v14.prototype, "view", void 0), e3([y2({ constructOnly: true })], v14.prototype, "graphic", void 0), e3([y2({ constructOnly: true, nonNullable: true })], v14.prototype, "enableZShape", void 0), e3([y2({ constructOnly: true, nonNullable: true })], v14.prototype, "enableZVertex", void 0), e3([y2({ constructOnly: true, nonNullable: true })], v14.prototype, "enableMoveGraphic", void 0), e3([y2({ constructOnly: true, nonNullable: true })], v14.prototype, "enableMidpoints", void 0), e3([y2({ constructOnly: true, nonNullable: true })], v14.prototype, "enableEdgeOffset", void 0), e3([y2()], v14.prototype, "type", void 0), e3([y2({ constructOnly: true, type: c4 })], v14.prototype, "labelOptions", void 0), e3([y2({ constructOnly: true, type: p8 })], v14.prototype, "tooltipOptions", void 0), e3([y2({ constructOnly: true })], v14.prototype, "snappingManager", void 0), e3([y2()], v14.prototype, "updating", null), e3([y2()], v14.prototype, "automaticManipulatorSelection", void 0), v14 = e3([n4("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")], v14);

// node_modules/@arcgis/core/views/interactive/tooltip/TransformTooltipInfos.js
var r19 = class extends e13 {
  constructor(o18) {
    super(o18), this.type = "transform-rotate", this.rotationType = "geographic";
  }
};
e3([y2()], r19.prototype, "type", void 0), e3([y2()], r19.prototype, "rotation", void 0), e3([y2()], r19.prototype, "rotationPrecision", void 0), e3([y2()], r19.prototype, "orientation", void 0), e3([y2()], r19.prototype, "orientationPrecision", void 0), e3([y2()], r19.prototype, "rotationType", void 0), r19 = e3([n4("esri.views.interactive.tooltip.TransformRotateTooltipInfo")], r19);
var s16 = class extends e13 {
  constructor(o18) {
    super(o18), this.type = "transform-scale", this.sizeUnit = null, this.sizePrecision = null;
  }
};
e3([y2()], s16.prototype, "type", void 0), e3([y2()], s16.prototype, "scale", void 0), e3([y2()], s16.prototype, "size", void 0), e3([y2()], s16.prototype, "sizeUnit", void 0), e3([y2()], s16.prototype, "sizePrecision", void 0), s16 = e3([n4("esri.views.interactive.tooltip.TransformScaleTooltipInfo")], s16);
var p21 = class extends e13 {
  constructor(o18) {
    super(o18), this.type = "transform-absolute", this.orientationEnabled = true, this.orientationPrecision = null, this.rotationType = "geographic", this.sizeUnit = null, this.sizeEnabled = true, this.sizePrecision = null;
  }
};
e3([y2()], p21.prototype, "type", void 0), e3([y2()], p21.prototype, "orientation", void 0), e3([y2()], p21.prototype, "orientationEnabled", void 0), e3([y2()], p21.prototype, "orientationPrecision", void 0), e3([y2()], p21.prototype, "rotationType", void 0), e3([y2()], p21.prototype, "size", void 0), e3([y2()], p21.prototype, "sizeUnit", void 0), e3([y2()], p21.prototype, "sizeEnabled", void 0), e3([y2()], p21.prototype, "sizePrecision", void 0), p21 = e3([n4("esri.views.interactive.tooltip.TransformAbsoluteTooltipInfo")], p21);

// node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/GraphicScaleRotateTransform.js
var yt;
var bt;
!function(t24) {
  t24.ScaleIn = u7.Custom2, t24.ScaleOut = u7.Custom3, t24.RotateLeft = u7.Custom4, t24.RotateRight = u7.Custom5, t24.Unlocked = u7.Custom7, t24.DelayedFocused = u7.Custom8, t24.TouchInput = u7.Custom12;
}(yt || (yt = {}));
var Tt = class {
  constructor({ adapter: t24, tooltipOptions: i21, mode: o18, tool: r22 }) {
    this._mode = null, this._handles = new t4(), this._scaleRotateDragData = null, this._activeAnimation = null, this.events = new n5(), this.getFocused = () => this._ringManipulator.focused, this.getScale = () => r(this._scaleRotateDragData) && "scale" === this._scaleRotateDragData.mode ? this._adapter.scale : 1, this.tool = r22, this._mode = o18, this._adapter = t24, this._tooltipOptions = i21, this._tooltip = new m9({ view: r22.view }), this._createManipulator(), this._updateDragState(), this._updateManipulatorTransform(), this._handles.add(f3(() => !this._tooltipOptions.enabled, () => this._tooltip.clear(), h4));
  }
  get angle() {
    return this._adapter.angle;
  }
  get scale() {
    return this._adapter.scale;
  }
  set location(t24) {
    this._ringManipulator.location = t24;
  }
  set elevationAlignedLocation(t24) {
    this._ringManipulator.elevationAlignedLocation = t24;
  }
  get grabbing() {
    return this._ringManipulator.grabbing;
  }
  set interactive(t24) {
    this._ringManipulator.interactive = t24;
  }
  destroy() {
    r(this._activeAnimation) && (this._activeAnimation.frameTask.remove(), this._activeAnimation = null), this._handles = s(this._handles), this.tool.manipulators.remove(this._ringManipulator), this._ringManipulator = null, this._tooltip = s(this._tooltip);
  }
  startAnimation(t24) {
    this.cancelActiveAnimation(), t24.start();
    const e21 = A2({ update: ({ deltaTime: e22 }) => {
      t24.update(e22) && this.cancelActiveAnimation();
    } });
    this._activeAnimation = { ...t24, frameTask: e21 };
  }
  cancelActiveAnimation() {
    r(this._activeAnimation) && (this._activeAnimation.frameTask.remove(), this._activeAnimation = s(this._activeAnimation));
  }
  forEachManipulator(t24) {
    t24(this._ringManipulator, A12.SCALE_ROTATE);
  }
  _createManipulator() {
    const e21 = this._createRingManipulator();
    this._ringManipulator = e21, this.tool.manipulators.add(e21);
    const a25 = this.tool.graphicState.graphic, r22 = d10(e21, (e22, r23, n20) => {
      this._scaleRotateDragData = null;
      const l21 = this._adapter.startInteraction(), c16 = { mode: "none", origin: t2(e22.renderLocation), initialAngle: this._adapter.angle, angle: 0, angleDir: 0, scaleDir: 0 };
      this._scaleRotateDragData = c16, this._updateDragState();
      const h26 = c2.get();
      this.tool.view.renderCoordsHelper.worldUpAtPosition(e22.renderLocation, h26), r23.next(C11(this.tool.view, _2(e22.renderLocation, h26, p5()))).next((e23) => {
        const r24 = Y2(e23.plane), n21 = z4(e23.renderStart, e23.renderEnd, c16.origin, r24), h27 = r9.shortestSignedDiff(c16.angle, n21);
        c16.angleDir = a3(c16.angleDir + h27, -q7, q7), c16.angle = n21;
        const p23 = Rt(c16, e23), u15 = p23 - this._adapter.scale;
        if (c16.scaleDir = a3(c16.scaleDir + u15, -m18, m18), this._onScaleChanged(), "none" === c16.mode) {
          const t24 = this._mode || kt(e23, e23.plane, c16.origin, this.tool.view.state.camera);
          if (r(t24)) {
            switch (t24) {
              case "rotate":
                this.tool.emit("graphic-rotate-start", { graphic: a25, angle: 0 }), this.tool.emit("record-undo", { record: this._adapter.createUndoRecord() });
                break;
              case "scale":
                this.tool.emit("graphic-scale-start", { graphic: a25, xScale: 1, yScale: 1 }), this.tool.emit("record-undo", { record: this._adapter.createUndoRecord() });
            }
            c16.mode = t24;
          }
        }
        switch (c16.mode) {
          case "rotate":
            l21.state.angle = c16.initialAngle + n21;
            break;
          case "scale":
            l21.state.scale = p23, this._onScaleChanged();
        }
        switch (this._updateDragState(), this._updateManipulatorTransform(), e23.action) {
          case "start":
          case "update":
            switch (c16.mode) {
              case "rotate":
                this.tool.emit("graphic-rotate", { graphic: a25, angle: b(c16.angle) });
                break;
              case "scale":
                this.tool.emit("graphic-scale", { graphic: a25, xScale: p23, yScale: p23 });
            }
            break;
          case "end":
            switch (c16.mode) {
              case "rotate":
                this.tool.emit("graphic-rotate-stop", { graphic: a25, angle: b(c16.angle) });
                break;
              case "scale":
                this.tool.emit("graphic-scale-stop", { graphic: a25, xScale: p23, yScale: p23 });
            }
        }
        return "end" === e23.action && (this.startAnimation(wt(this, () => this._onScaleChanged())), this._scaleRotateDragData = null, this._updateDragState(), l21.done()), e23;
      }).next(this._updateTooltipPipelineStep(c16)), n20.next(() => {
        if (l21.cancel(), r(this._scaleRotateDragData)) {
          switch (this._scaleRotateDragData.mode) {
            case "none":
              break;
            case "rotate":
              this.tool.emit("graphic-rotate-stop", { graphic: a25, angle: 0 });
              break;
            case "scale":
              this.tool.emit("graphic-scale-stop", { graphic: a25, xScale: 1, yScale: 1 });
          }
          this.startAnimation(wt(this, () => this._onScaleChanged())), this._scaleRotateDragData = null, this._updateDragState();
        }
        this._updateFocusTooltip();
      });
    });
    this._handles.add([r22, e21.events.on("focus-changed", (t24) => {
      "focus" === t24.action ? this.startAnimation(Ot(this, () => this._updateDelayedFocusedState())) : this._updateDelayedFocusedState();
    }), e21.events.on("immediate-click", (t24) => {
      t24.stopPropagation();
    }), l3(() => {
      var _a;
      return (_a = this.tool.graphicState) == null ? void 0 : _a.displaying;
    }, (t24) => this._ringManipulator.available = t24, h4)]);
  }
  _updateTooltipPipelineStep(t24) {
    return (e21) => {
      const a25 = this._tooltipOptions;
      if (!a25.enabled)
        return e21;
      if ("end" === e21.action)
        return this._updateFocusTooltip(), e21;
      const i21 = this._tooltip, o18 = this._tooltipOptions.visualVariables, r22 = r(o18) ? o18.size : null, l21 = r(o18) ? o18.rotation : null;
      switch (t24.mode) {
        case "scale":
          i21.info = new s16({ tooltipOptions: a25, scale: { value: this._adapter.scale }, size: a13(i(this._adapter.size, -1), "meters"), sizeUnit: r(r22) ? r22.unit : null, sizePrecision: r(r22) ? At(r22.valueType) : null });
          break;
        case "rotate": {
          const t25 = r(l21) ? At(l21.valueType) : null, e22 = r(l21) ? l21.rotationType : "geographic";
          i21.info = new r19({ tooltipOptions: a25, rotation: c5(i(-this._adapter.relativeAngle, 0), "radians", "geographic"), rotationPrecision: t25, orientation: c5(-this._adapter.angle, "radians", "geographic"), orientationPrecision: t25, rotationType: e22 });
        }
      }
      return e21;
    };
  }
  _updateFocusTooltip() {
    if (!this._tooltipOptions.enabled)
      return;
    if (this.getFocused()) {
      const t24 = this._tooltipOptions.visualVariables, e21 = r(t24) ? t24.rotation : null, a25 = r(t24) ? t24.size : null;
      this._tooltip.info = new p21({ tooltipOptions: this._tooltipOptions, orientation: c5(-this._adapter.angle, "radians", "geographic"), orientationEnabled: null == this._mode || "rotate" === this._mode, orientationPrecision: r(e21) ? At(e21.valueType) : null, rotationType: r(e21) ? e21.rotationType : "geographic", size: a13(i(this._adapter.size, -1), "meters"), sizeUnit: r(a25) ? a25.unit : null, sizeEnabled: null == this._mode || "scale" === this._mode, sizePrecision: r(a25) ? At(a25.valueType) : null });
    } else
      this._tooltip.clear();
  }
  _onScaleChanged() {
    this.events.emit("scale-changed"), this._updateManipulatorTransform();
  }
  _updateDelayedFocusedState() {
    this._ringManipulator.updateStateEnabled(yt.DelayedFocused, this.getFocused()), this._updateFocusTooltip();
  }
  _updateDragState() {
    if (this._ringManipulator.updateStateEnabled(yt.Unlocked, !(r(this._scaleRotateDragData) && "none" !== this._scaleRotateDragData.mode)), r(this._scaleRotateDragData))
      switch (this._scaleRotateDragData.mode) {
        case "rotate":
          this._ringManipulator.updateStateEnabled(yt.ScaleIn | yt.ScaleOut, false), this._ringManipulator.updateStateEnabled(yt.RotateLeft, this._scaleRotateDragData.angleDir < 0), this._ringManipulator.updateStateEnabled(yt.RotateRight, this._scaleRotateDragData.angleDir >= 0);
          break;
        case "scale":
          this._ringManipulator.updateStateEnabled(yt.RotateLeft | yt.RotateRight, false), this._ringManipulator.updateStateEnabled(yt.ScaleIn, this._scaleRotateDragData.scaleDir < 0), this._ringManipulator.updateStateEnabled(yt.ScaleOut, this._scaleRotateDragData.scaleDir >= 0);
      }
    else
      this._ringManipulator.updateStateEnabled(yt.ScaleIn | yt.ScaleOut | yt.RotateLeft | yt.RotateRight, false);
  }
  _updateManipulatorTransform() {
    const t24 = g2(f6.get(), this._adapter.angle, r2(0, 0, 1));
    if (t(t24))
      return;
    const e21 = this.getScale(), a25 = q2(f6.get(), o2(c2.get(), e21, e21, e21));
    this._ringManipulator.modelTransform = u4(f6.get(), a25, t24);
  }
  _createRingManipulator() {
    const t24 = (t25, e22, a26) => {
      const i22 = [], o19 = Math.ceil(a21 * (e22 - t25) / (2 * Math.PI));
      for (let s20 = 0; s20 < o19 + 1; s20++) {
        const r23 = t25 + s20 * (e22 - t25) / o19;
        i22.push(r2(a26 * Math.cos(r23), a26 * Math.sin(r23), 0));
      }
      return i22;
    }, e21 = (e22) => t24(0, 2 * Math.PI, e22), a25 = (t25) => [[-t25 / 2, 0], [t25 / 2, 0], [t25 / 2, i16 / 2], [-t25 / 2, i16 / 2]], i21 = (t25, e22) => k2(a25(e22), t25, [], [], false), o18 = e21(P9), s19 = i21(o18, l17), r22 = { left: [], right: [] }, n20 = [];
    for (let k10 = 0; k10 < 2; k10++) {
      const e22 = k10 * Math.PI - Math.PI / 4, a26 = Math.PI / 2 - b12, o19 = e22 + a26, s20 = e22 + Math.PI / 2 - a26, l22 = t24(o19, s20, p19), c17 = i21(l22, n15);
      n20.push(l22), n20.push(t24(o19, s20, r17 - l17 / 2)), r22.left.push(c17), r22.right.push(c17);
      for (let t25 = 0; t25 < 2; t25++) {
        const e23 = 0 === t25, a27 = e6();
        if (e23) {
          i4(a27, a27, [1, -1, 1]), f4(a27, a27, -o19, [0, 0, 1]);
          const t26 = Math.round(g11 * (l22.length - 1));
          a27[12] = l22[t26][0], a27[13] = l22[t26][1], a27[14] = l22[t26][2];
        } else {
          f4(a27, a27, s20, [0, 0, 1]);
          const t26 = Math.round((1 - g11) * (l22.length - 1));
          a27[12] = l22[t26][0], a27[13] = l22[t26][1], a27[14] = l22[t26][2];
        }
        const i22 = Z5(s15, 0, x13, i16);
        B3(i22, a27), (e23 ? r22.left : r22.right).push(i22);
      }
    }
    const l21 = [];
    for (let D12 = 0; D12 < 2; D12++) {
      const e22 = D12 * Math.PI - Math.PI / 4, a26 = Math.PI / 2 - d15, o19 = e22 + a26, s20 = e22 + Math.PI / 2 - a26, r23 = t24(o19, s20, r17);
      l21.push(i21(r23, n15));
    }
    const c16 = e21(P9 + j9), h26 = e21(P9 + k5), p23 = i21(c16, n15), u15 = i21(h26, n15), d19 = e21(P9 - j9), g16 = e21(P9 - k5), m21 = i21(d19, n15), _10 = i21(g16, n15), f18 = this._createMaterial(), M14 = this._createMaterial(0.66), y14 = this._createMaterial(0.5), b15 = this._createMaterial(0.33);
    let T14 = [{ geometry: s19, material: f18, stateMask: yt.DelayedFocused }, { geometry: s19, material: y14, stateMask: t12.None }];
    this._mode && "scale" !== this._mode || (T14 = T14.concat([{ geometry: l21, material: f18, stateMask: yt.DelayedFocused | yt.Unlocked }, { geometry: p23, material: M14, stateMask: yt.DelayedFocused | yt.ScaleIn }, { geometry: u15, material: b15, stateMask: yt.DelayedFocused | yt.ScaleIn }, { geometry: m21, material: M14, stateMask: yt.DelayedFocused | yt.ScaleOut }, { geometry: _10, material: b15, stateMask: yt.DelayedFocused | yt.ScaleOut }])), this._mode && "rotate" !== this._mode || (T14 = T14.concat([{ geometry: r22.right, material: f18, stateMask: yt.DelayedFocused | yt.Unlocked }, { geometry: r22.left, material: f18, stateMask: yt.DelayedFocused | yt.RotateLeft }, { geometry: r22.right, material: f18, stateMask: yt.DelayedFocused | yt.RotateRight }]));
    const R7 = [o18, ...n20];
    return new ie({ view: this.tool.view, renderObjects: T14, autoScaleRenderObjects: false, worldOriented: true, radius: l17, focusMultiplier: 1, touchMultiplier: 1.5, elevationInfo: f9(this.tool.graphicState.graphic), collisionType: { type: "ribbon", paths: R7, direction: r2(0, 0, 1) } });
  }
  _createMaterial(t24 = 1) {
    const e21 = e4([...t20, t24]);
    return new m12({ color: e21, transparent: 1 !== t24, cullFace: n9.Back, renderOccluded: o7.Transparent });
  }
  get test() {
    return { ringManipulator: this._ringManipulator, tooltip: this._tooltip };
  }
};
function Rt(t24, e21) {
  const a25 = e2(c2.get(), e21.renderStart, t24.origin), i21 = e2(c2.get(), e21.renderEnd, t24.origin), o18 = s2(a25), s19 = s2(i21);
  return 0 === o18 ? 0 : s19 / o18;
}
function kt(t24, e21, a25, i21) {
  const { renderStart: o18, renderEnd: s19 } = t24, r22 = jt(o18, i21, c2.get()), n20 = jt(s19, i21, c2.get());
  if (p(r22, n20) < f15 * f15)
    return null;
  const l21 = e2(c2.get(), o18, a25), c16 = _(c2.get(), l21, Y2(e21)), h26 = o18, p23 = u(c2.get(), h26, c16), u15 = jt(a25, i21, c2.get()), d19 = r22, g16 = jt(p23, i21, c2.get()), m21 = e2(c2.get(), g16, d19), _10 = e2(c2.get(), r22, u15), f18 = p4(d19, m21), M14 = p4(u15, _10);
  return b4(f18, n20) < b4(M14, n20) ? "rotate" : "scale";
}
function jt(t24, e21, a25) {
  return e21.projectToScreen(t24, It), o2(a25, It[0], It[1], 0);
}
function wt(t24, e21) {
  let a25 = null, i21 = 1;
  const o18 = () => i21;
  return { start: () => {
    i21 = t24.getScale(), a25 = t24.getScale, t24.getScale = o18, e21();
  }, update: (t25) => (i21 += ((i21 + 1) / 2 - i21) * Math.min(t25 * v13, 1), e21(), Math.abs(i21 - 1) < 0.01 ? bt.STOP : bt.CONTINUE), destroy: () => {
    t24.getScale = a25, e21();
  } };
}
function Ot(t24, e21) {
  let a25 = 0, i21 = null;
  const o18 = () => false;
  return { start: () => {
    i21 = t24.getFocused, t24.getFocused = o18, a25 = 0, e21();
  }, update: (t25) => (a25 += t25, !i21() || a25 > u12 ? bt.STOP : bt.CONTINUE), destroy: () => {
    t24.getFocused = i21, e21();
  } };
}
function At(t24) {
  switch (t24) {
    case "integer":
    case "long":
      return 0;
    default:
      return null;
  }
}
!function(t24) {
  t24[t24.CONTINUE = 0] = "CONTINUE", t24[t24.STOP = 1] = "STOP";
}(bt || (bt = {}));
var It = i3();

// node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/undoRecords.js
function r20(t24) {
  return r(t24.geometry) && "mesh" === t24.geometry.type ? o16(t24.geometry) : n16(t24);
}
function o16(t24) {
  return r(t24.transform) ? m19(t24, t24.transform) : i19(t24);
}
function n16(e21) {
  let r22 = e21.geometry, o18 = n;
  return { undo(e22) {
    o18 = e22.geometry, e22.geometry = r22;
  }, redo(e22) {
    r22 = e22.geometry, e22.geometry = o18;
  } };
}
function m19(t24, r22) {
  let o18 = r22.clone(), n20 = null;
  return { undo: (r23) => {
    n20 = r(t24.transform) ? t24.transform.clone() : null, t24.transform = o18, r23.notifyGeometryChanged();
  }, redo: (r23) => {
    o18 = r(t24.transform) ? t24.transform.clone() : null, t24.transform = n20, r23.notifyGeometryChanged();
  } };
}
function i19(e21) {
  let t24, r22 = e21.vertexAttributes.clonePositional();
  return { undo: (o18) => {
    t24 = e21.vertexAttributes.clonePositional(), e21.vertexAttributes = r22, o18.notifyGeometryChanged();
  }, redo: (o18) => {
    r22 = e21.vertexAttributes.clonePositional(), e21.vertexAttributes = t24, o18.notifyGeometryChanged();
  } };
}

// node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/ScaleRotateMeshAdapter.js
var d16 = class extends d2 {
  constructor(t24) {
    super(t24), this._interactionState = null;
  }
  initialize() {
    this.addHandles([f3(() => r(this._interactionState) && this._interactionState.angle !== this._interactionState.previousAngle ? { interactionState: this._interactionState, angle: this._interactionState.state.angle } : null, ({ interactionState: t24 }) => {
      this._updateMeshRotation(t24);
    }, U2), f3(() => r(this._interactionState) && this._interactionState.scale !== this._interactionState.previousScale ? { interactionState: this._interactionState, scale: this._interactionState.state.scale } : null, ({ interactionState: t24 }) => {
      this._updateMeshSize(t24);
    }, U2)]);
  }
  get angle() {
    const t24 = this.geometry.transform;
    if (t(t24))
      return 0;
    const e21 = g3(t24.rotation)[2];
    return Math.abs(e21) > 0.999999 ? m(l5(t24.rotation)) * Math.sign(e21) : 0;
  }
  get scale() {
    return r(this._interactionState) ? this._interactionState.scale : 1;
  }
  startInteraction() {
    const t24 = new y9({ angle: this.angle });
    this._interactionState = t24;
    const e21 = () => this._interactionState = null;
    return { state: t24, done: e21, cancel: () => {
      t24.cancel(), e21();
    } };
  }
  createUndoRecord() {
    return r20(this.graphic);
  }
  _updateMeshRotation(t24) {
    const e21 = this.geometry.anchor, i21 = this.viewingMode === l7.Global, { angle: o18, previousAngle: a25 } = t24;
    this.geometry.rotate(0, 0, b(o18 - a25), { origin: e21, geographic: i21 }), t24.previousAngle = o18, r(this.geometry.transform) && this.graphic.notifyMeshTransformChanged(), this.graphic.notifyGeometryChanged();
  }
  _updateMeshSize(t24) {
    const e21 = this.geometry.anchor, i21 = this.viewingMode === l7.Global, { scale: o18, previousScale: r22 } = t24;
    this.geometry.scale(o18 / r22, { origin: e21, geographic: i21 }), t24.previousScale = o18, r(this.geometry.transform) && this.graphic.notifyMeshTransformChanged(), this.graphic.notifyGeometryChanged();
  }
};
e3([y2({ constructOnly: true })], d16.prototype, "graphic", void 0), e3([y2({ constructOnly: true })], d16.prototype, "geometry", void 0), e3([y2({ constructOnly: true })], d16.prototype, "viewingMode", void 0), e3([y2()], d16.prototype, "angle", null), e3([y2()], d16.prototype, "scale", null), e3([y2()], d16.prototype, "_interactionState", void 0), d16 = e3([n4("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")], d16);
var y9 = class extends m2 {
  constructor(t24) {
    super(t24), this.angle = 0, this.initialAngle = 0, this.previousAngle = 0, this.previousScale = 1, this.scale = 1, this.initialAngle = t24.angle, this.previousAngle = t24.angle;
  }
  get state() {
    const { angle: t24, scale: e21 } = this;
    return { angle: t24, scale: e21 };
  }
  cancel() {
    this.angle = this.initialAngle, this.scale = 1;
  }
};
e3([y2()], y9.prototype, "angle", void 0), e3([y2()], y9.prototype, "initialAngle", void 0), e3([y2()], y9.prototype, "previousAngle", void 0), e3([y2()], y9.prototype, "previousScale", void 0), e3([y2()], y9.prototype, "scale", void 0), e3([y2()], y9.prototype, "state", null), y9 = e3([n4("InteractionState")], y9);

// node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/ScaleRotateObjectSymbol3DAdapter.js
var y10 = class extends d2 {
  constructor(t24) {
    super(t24), this.sizeAxis = null, this._interactionState = null;
  }
  initialize() {
    this.addHandles(f3(() => r(this._interactionState) ? this._interactionState.state : null, (t24) => {
      this._updateSymbol(t24);
    }, U2));
  }
  get angle() {
    return r(this._interactionState) ? this._interactionState.angle : r(this._orientationReferenceSymbolLayer) ? g12(this._orientationReferenceSymbolLayer.heading) : 0;
  }
  get scale() {
    return r(this._interactionState) ? this._interactionState.scale : 1;
  }
  get relativeAngle() {
    return this.angle - this.initialAngle;
  }
  get initialAngle() {
    return r(this._interactionState) ? this._interactionState.initialAngle : 0;
  }
  get size() {
    const t24 = this._sizeReferenceSymbolLayer;
    if (t(t24))
      return null;
    const e21 = this.findLayerView(), i21 = this._graphicSymbol;
    if (t(e21) || t(i21) || "point-3d" !== i21.type)
      return null;
    const o18 = e21.getSymbolLayerSize(i21, t24);
    if ("size" in o18 && r(o18.size))
      return o18.size;
    const r22 = this.sizeAxis;
    return "width" in o18 && r(o18.width) && (t(r22) || "width" === r22 || "all" === r22 || "width-and-depth" === r22) ? o18.width : "depth" in o18 && r(t24.depth) && (t(r22) || "depth" === r22 || "all" === r22 || "width-and-depth" === r22) ? o18.depth : "height" in o18 && r(t24.height) && (t(r22) || "height" === r22 || "all" === r22) ? o18.height : null;
  }
  get _sizeReferenceSymbolLayer() {
    const t24 = this._graphicSymbol;
    return t(t24) || 0 === t24.symbolLayers.length ? null : t24.symbolLayers.find((t25) => "object" === t25.type);
  }
  get _orientationReferenceSymbolLayer() {
    const t24 = this._graphicSymbol;
    return t(t24) || 0 === t24.symbolLayers.length ? null : t24.symbolLayers.find((t25) => "object" === t25.type && r(t25.heading));
  }
  get _graphicSymbol() {
    return r(this.graphic) && r(this.graphic.symbol) && "point-3d" === this.graphic.symbol.type ? this.graphic.symbol : null;
  }
  set _graphicSymbol(t24) {
    this.graphic.symbol = t24;
  }
  startInteraction() {
    const t24 = this._graphicSymbol, e21 = this.findLayerView();
    if (r(this._interactionState) || t(t24) || t(e21))
      return m20;
    const i21 = t24.symbolLayers.map((i22) => "object" === i22.type ? e21.getSymbolLayerSize(t24, i22) : null).toArray(), o18 = t24.clone(), r22 = this.angle, s19 = new d17({ originalSymbol: o18, angle: r22, initialSizes: i21 });
    this._interactionState = s19;
    const a25 = () => this._interactionState = null;
    return { state: s19, done: a25, cancel: () => {
      this._graphicSymbol = o18, a25();
    } };
  }
  createUndoRecord() {
    let t24 = this.graphic.symbol, e21 = null;
    return { undo: (i21) => {
      e21 = i21.symbol, i21.symbol = t24;
    }, redo: (i21) => {
      t24 = i21.symbol, i21.symbol = e21;
    } };
  }
  _updateSymbol({ scale: t24, angle: e21, originalSymbol: i21, initialSizes: r22 }) {
    const a25 = this._graphicSymbol;
    if (t(a25) || "point-3d" !== a25.type)
      return;
    const c16 = a25.clone(), h26 = -b(e21 - this.initialAngle);
    let p23 = false;
    this._forEachObjectSymbolLayerPair(i21, c16, (e22, i22, o18) => {
      const l21 = i(e22.heading, 0) + h26;
      i22.heading !== l21 && (i22.heading = l21, p23 = true);
      const a26 = r22[o18];
      if (r(a26) && "width" in a26) {
        a26.width = this.sizeFilter(a26.width), a26.height = this.sizeFilter(a26.height), a26.depth = this.sizeFilter(a26.depth);
        const e23 = a26.width * t24;
        i22.width !== e23 && (i22.width = e23, p23 = true);
        const o19 = a26.depth * t24;
        i22.depth !== o19 && (i22.depth = o19, p23 = true);
        const r23 = a26.height * t24;
        i22.height !== r23 && (i22.height = r23, p23 = true);
      }
    }), p23 && (this._graphicSymbol = c16);
  }
  _forEachObjectSymbolLayerPair(t24, e21, i21) {
    t24.symbolLayers.forEach((t25, o18) => {
      const r22 = e21.symbolLayers.getItemAt(o18);
      "object" === t25.type && "object" === r22.type && i21(t25, r22, o18);
    });
  }
};
function g12(t24) {
  return -m(t24);
}
e3([y2()], y10.prototype, "angle", null), e3([y2()], y10.prototype, "scale", null), e3([y2()], y10.prototype, "relativeAngle", null), e3([y2()], y10.prototype, "initialAngle", null), e3([y2()], y10.prototype, "size", null), e3([y2()], y10.prototype, "sizeAxis", void 0), e3([y2({ constructOnly: true })], y10.prototype, "graphic", void 0), e3([y2()], y10.prototype, "_interactionState", void 0), e3([y2({ constructOnly: true })], y10.prototype, "findLayerView", void 0), e3([y2({ constructOnly: true })], y10.prototype, "sizeFilter", void 0), e3([y2()], y10.prototype, "_sizeReferenceSymbolLayer", null), e3([y2()], y10.prototype, "_orientationReferenceSymbolLayer", null), e3([y2()], y10.prototype, "_graphicSymbol", null), y10 = e3([n4("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")], y10);
var m20 = { state: { angle: 0, scale: 0 }, done: () => {
}, cancel: () => {
} };
var d17 = class extends m2 {
  constructor(t24) {
    super(t24), this.angle = 0, this.initialAngle = 0, this.scale = 1, this.initialAngle = t24.angle;
  }
  get state() {
    const { originalSymbol: t24, angle: e21, initialAngle: i21, scale: o18, initialSizes: r22 } = this;
    return { originalSymbol: t24, angle: e21, initialAngle: i21, scale: o18, initialSizes: r22 };
  }
};
e3([y2()], d17.prototype, "originalSymbol", void 0), e3([y2()], d17.prototype, "angle", void 0), e3([y2()], d17.prototype, "initialAngle", void 0), e3([y2()], d17.prototype, "initialSizes", void 0), e3([y2()], d17.prototype, "scale", void 0), e3([y2()], d17.prototype, "state", null), d17 = e3([n4("InteractionState")], d17);

// node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/GraphicTransformTool.js
var V8 = class extends a7(n5.EventedMixin(p11)) {
  constructor(t24) {
    super(t24), this.enableZ = true, this.enableRotation = true, this.enableScaling = true, this.tooltipOptions = new p8(), this.type = "transform-3d", this._scaleRotate = null, this._snappingPipeline = new u8(), this._tooltip = null;
  }
  initialize() {
    const { graphic: t24, view: e21 } = this;
    this.graphicState = new e19({ graphic: t24 }), this.addHandles(l3(() => this.tooltipOptions.enabled, (t25) => {
      this._tooltip = t25 ? new m9({ view: e21 }) : s(this._tooltip);
    }, w3)), this._moveManipulation = new u13({ tool: this, view: e21, snapToScene: this.snapToScene, xyAvailable: true, xyAxisAvailable: true, zAvailable: this.enableZ && t19(t24), radius: u13.radiusForSymbol(t24.symbol) }), this._moveManipulation.forEachManipulator((e22) => this.handles.add(e22.events.on("immediate-click", (e23) => {
      this.emit("immediate-click", { ...e23, graphic: t24 }), e23.stopPropagation();
    })));
    const i21 = (t25) => (e22) => {
      this.handles.add(e22.events.on("focus-changed", ({ action: e23 }) => {
        const i22 = this._tooltip;
        t(i22) || ("focus" === e23 ? this._updateMoveTooltip(t25) : i22.clear());
      }));
    };
    this._moveManipulation.xyManipulation.forEachManipulator(i21(M12.XY)), this._moveManipulation.xyAxisManipulation.forEachManipulator(i21(M12.XY_AXIS)), this._moveManipulation.zManipulation.forEachManipulator(i21(M12.Z)), this._moveManipulation.elevationInfo = f9(t24);
    const r22 = t24.geometry;
    if (this._moveManipulation.createGraphicDragPipeline((i22, a25, n20, s19, p23) => (r(r22) && i22 === M12.XY && (n20 = n20.next(this._snappingPipeline.createSnapDragEventPipelineStep({ snappingContext: new e15({ elevationInfo: f9(t24), pointer: p23, editGeometryOperations: V.fromGeometry(new w2({ spatialReference: r22.spatialReference }), e21.state.viewingMode), visualizer: new _6(), excludeFeature: t24 }), snappingManager: this.snappingManager, updatingHandles: this.updatingHandles, cancel: s19, useZ: false }), this._snappingPipeline.next)), n20 = n20.next((t25) => (this._updateMoveTooltip(i22, t25), t25))), this.graphicState, (t25) => {
      const { action: e22, graphic: i22, dxScreen: a25, dyScreen: o18 } = t25, n20 = { graphic: i22, dxScreen: a25, dyScreen: o18 };
      switch (e22) {
        case "start":
          this.emit("graphic-translate-start", n20), this.emit("record-undo", { record: this._createGeometryUndoRecord() });
          break;
        case "update":
          this.emit("graphic-translate", n20);
          break;
        case "end":
          this.emit("graphic-translate-stop", n20);
      }
    }), this._moveManipulation.angle = r(this._scaleRotate) ? this._scaleRotate.angle : 0, this._scaleRotateAdapter = this._createScaleRotateAdapter(), this.handles.add(l3(() => this._scaleRotateAdapter.angle, () => this._updateMoveAngle())), this.enableScaling || this.enableRotation) {
      const t25 = this.enableScaling && this.enableRotation ? null : this.enableScaling ? "scale" : "rotate";
      this._scaleRotate = new Tt({ tool: this, mode: t25, adapter: this._scaleRotateAdapter, tooltipOptions: this.tooltipOptions }), this.handles.add(this._scaleRotate.events.on("scale-changed", () => this._onScaleChanged()));
    }
    this.handles.add([i15({ view: this.view, graphic: this.graphic, forEachManipulator: (t25) => this._forEachManipulator(t25), onManipulatorsChanged: () => n3() }), this.graphicState.on("changed", () => this._onGeometryChanged()), this._hideManipulatorsForGraphicState(), l3(() => e21.scale, () => this._updateMoveAngle())]), this.handles.add(this.view.trackGraphicState(this.graphicState)), this._onGeometryChanged(), this._updateMoveAngle(), this._forEachManipulator((t25) => {
      t25 instanceof ie && this.handles.add(t25.events.on("grab-changed", () => this._updateManipulatorsInteractive()));
    }), this.finishToolCreation();
  }
  destroy() {
    this._tooltip = s(this._tooltip), this._moveManipulation.destroy(), this._scaleRotate = s(this._scaleRotate), this._scaleRotateAdapter = s(this._scaleRotateAdapter), this._set("view", null), this._set("graphic", null);
  }
  _updateManipulatorsInteractive() {
    t(this._scaleRotate) || (this._scaleRotate.interactive = !this._moveManipulation.grabbing, this._moveManipulation.interactive = !this._scaleRotate.grabbing);
  }
  _createScaleRotateAdapter() {
    return r(this.graphic.geometry) && "mesh" === this.graphic.geometry.type ? new d16({ graphic: this.graphic, geometry: this.graphic.geometry, viewingMode: this.view.state.viewingMode }) : new y10({ graphic: this.graphic, sizeFilter: (t24) => this._enforceNonZeroSize(t24), findLayerView: () => this.view.allLayerViews.find((t24) => t24.layer === this.graphic.layer), sizeAxis: r(this.tooltipOptions.visualVariables) && r(this.tooltipOptions.visualVariables.size) ? this.tooltipOptions.visualVariables.size.axis : null });
  }
  _forEachManipulator(t24) {
    this._moveManipulation.forEachManipulator(t24), r(this._scaleRotate) && this._scaleRotate.forEachManipulator(t24);
  }
  _hideManipulatorsForGraphicState() {
    return l3(() => this.graphicState.displaying, (t24) => {
      this._forEachManipulator((e21) => e21.available = t24), this._moveManipulation.zManipulation.available = t24 && this.enableZ && t19(this.graphic);
    });
  }
  _createGeometryUndoRecord() {
    return r20(this.graphic);
  }
  set snapToScene(t24) {
    this._moveManipulation && (this._moveManipulation.snapToScene = t24), this._set("snapToScene", t24);
  }
  get updating() {
    return this.updatingHandles.updating;
  }
  set location(t24) {
    this._moveManipulation.location = t24, r(this._scaleRotate) && (this._scaleRotate.location = t24);
  }
  set elevationAlignedLocation(t24) {
    this._moveManipulation.elevationAlignedLocation = t24, r(this._scaleRotate) && (this._scaleRotate.elevationAlignedLocation = t24);
  }
  reset() {
  }
  onHide() {
    r(this._scaleRotate) && this._scaleRotate.cancelActiveAnimation();
  }
  _onScaleChanged() {
    if (t(this._scaleRotate))
      return;
    const t24 = this._scaleRotate.getScale();
    this._moveManipulation.displayScale = t24;
  }
  _updateMoveAngle() {
    this.view.state.viewingMode === l7.Local || this.view.scale < w13 ? this._moveManipulation.angle = this._scaleRotateAdapter.angle : this._moveManipulation.angle = 0;
  }
  _onGeometryChanged() {
    C9(this.view, this, this.graphic);
  }
  _enforceNonZeroSize(t24) {
    return t24 || this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation);
  }
  _updateMoveTooltip(t24, e21) {
    const { tooltipOptions: i21, _tooltip: a25 } = this;
    if (t(a25))
      return;
    a25.clear();
    const o18 = this.graphicState.isDraped ? "on-the-ground" : "absolute-height";
    switch (t24) {
      case M12.XY:
        a25.info = new r14({ tooltipOptions: i21 }), this._updateMoveTooltipDistance(a25.info, e21, (t25, e22) => a14(t25, e22, o18));
        break;
      case M12.XY_AXIS:
        a25.info = new a16({ tooltipOptions: i21 }), this._updateMoveTooltipDistance(a25.info, e21, (t25, i22) => {
          const a26 = a14(t25, i22, o18);
          return y6(a26, i18(e21));
        });
        break;
      case M12.Z:
        a25.info = new p13({ tooltipOptions: i21 }), this._updateMoveTooltipDistance(a25.info, e21, v7);
    }
  }
  _updateMoveTooltipDistance(t24, e21, i21) {
    if (r(e21) && "end" !== e21.action) {
      const { mapStart: a25, mapEnd: n20 } = e21, s19 = i21(a25, n20);
      t24.distance = r(s19) ? s19 : j5;
    }
  }
  get test() {
    return { discManipulator: this._moveManipulation.xyManipulation.test.discManipulator, zManipulator: this._moveManipulation.zManipulation.test.manipulator, ringManipulator: r(this._scaleRotate) ? this._scaleRotate.test.ringManipulator : null, arrowManipulators: this._moveManipulation.xyAxisManipulation.test.arrowManipulators, scaleRotateAdapter: this._scaleRotateAdapter, scaleRotateTransform: this._scaleRotate, tooltip: this._tooltip };
  }
};
e3([y2({ constructOnly: true, nonNullable: true })], V8.prototype, "view", void 0), e3([y2({ constructOnly: true, nonNullable: true })], V8.prototype, "graphic", void 0), e3([y2({ constructOnly: true, nonNullable: true })], V8.prototype, "enableZ", void 0), e3([y2()], V8.prototype, "enableRotation", void 0), e3([y2()], V8.prototype, "enableScaling", void 0), e3([y2({ constructOnly: true, type: p8 })], V8.prototype, "tooltipOptions", void 0), e3([y2()], V8.prototype, "graphicState", void 0), e3([y2({ value: false })], V8.prototype, "snapToScene", null), e3([y2({ constructOnly: true })], V8.prototype, "snappingManager", void 0), e3([y2({ readOnly: true })], V8.prototype, "type", void 0), e3([y2({ readOnly: true })], V8.prototype, "updating", null), V8 = e3([n4("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransformTool")], V8);

// node_modules/@arcgis/core/analysis/SlicePlane.js
var c13 = class extends i5(l2) {
  constructor(o18) {
    super(o18), this.type = "plane", this.position = null, this.heading = 0, this.tilt = 0, this.width = 10, this.height = 10;
  }
  equals(o18) {
    return this.heading === o18.heading && this.tilt === o18.tilt && y(this.position, o18.position) && this.width === o18.width && this.height === o18.height;
  }
};
e3([y2({ readOnly: true, json: { read: false, write: true } })], c13.prototype, "type", void 0), e3([y2({ type: w2 }), g4()], c13.prototype, "position", void 0), e3([y2({ type: Number, nonNullable: true, range: { min: 0, max: 360 } }), g4(), s3((o18) => s7.normalize(a4(o18), 0, true))], c13.prototype, "heading", void 0), e3([y2({ type: Number, nonNullable: true, range: { min: 0, max: 360 } }), g4(), s3((o18) => s7.normalize(a4(o18), 0, true))], c13.prototype, "tilt", void 0), e3([y2({ type: Number, nonNullable: true }), g4()], c13.prototype, "width", void 0), e3([y2({ type: Number, nonNullable: true }), g4()], c13.prototype, "height", void 0), c13 = e3([n4("esri.analysis.SlicePlane")], c13);

// node_modules/@arcgis/core/views/3d/analysis/Slice/sliceToolConfig.js
var c14 = has("mac") ? "Meta" : "Control";
var a24 = 2;
var f16 = 1.15;
var h22 = 1.15;
var p22 = Math.cos(m(45));
var j12 = Math.cos(m(5));
var k7 = 0.7;
var l19 = r2(1, 0.5, 0);
var b13 = e4([...l19, k7]);
var C14 = e4([...l19, 0.5]);
var S10 = r7(1, 1, 1, 1);
var U5 = r7(1, 0.8, 0.6, 1);
var d18 = r7(1, 0.93, 0.86, 1);
var g13 = e4([...l19, 1]);
var q10 = e4([...l19, 1]);
var w14 = 3;
var y11 = 11;
var z5 = 22.5;
var A15 = 40;
var B6 = 48;
var D9 = 2.25;
var E12 = e4([...l19, 1]);
var F7 = 4;
var G9 = 1;
var H7 = 0.3;
var I5 = 6;
var J4 = 4;

// node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js
var g14 = e6();

// node_modules/@arcgis/core/views/3d/webgl-engine/shaders/SlicePlaneMaterialTechnique.js
var u14 = class extends e10 {
  initializeProgram(e21) {
    return new o9(e21.rctx, u14.shader.get().build(this.configuration), E2);
  }
  initializePipeline() {
    return W({ blending: l9(R2.ONE, R2.ONE, R2.ONE_MINUS_SRC_ALPHA, R2.ONE_MINUS_SRC_ALPHA), depthTest: { func: I2.LESS }, colorWrite: _3 });
  }
};
u14.shader = new t9(g8, () => import("./SlicePlaneMaterial.glsl-PE34GLO2.js"));

// node_modules/@arcgis/core/geometry/support/coordinateSystem.js
var x16 = 2 ** 50;
var z6 = n2();
var I6 = n2();

// node_modules/@arcgis/core/views/3d/analysis/Slice/sliceToolUtils.js
function Bt(t24, e21) {
  return D5(t24.basis1, t24.basis2, t24.origin, e21);
}
function qt(t24, e21, i21, n20) {
  const r22 = e21.worldUpAtPosition(t24.origin, c2.get()), s19 = c2.get();
  switch (i21) {
    case Re2.HEADING:
      r3(s19, r22);
      break;
    case Re2.TILT:
      r3(s19, t24.basis1);
  }
  return _2(t24.origin, s19, n20);
}
function Jt(t24, e21, i21, n20) {
  const r22 = s2(n20.basis1), s19 = s2(n20.basis2), o18 = ne2(n20), a25 = re2(n20), d19 = o2(c2.get(), 0, 0, 0);
  u(d19, g(c2.get(), n20.basis1, e21.direction[0]), g(c2.get(), n20.basis2, e21.direction[1])), u(d19, n20.origin, d19);
  let m21 = 0, p23 = 1;
  if (se2(e21))
    1 === e21.direction[0] && -1 === e21.direction[1] ? m21 = ye : 1 === e21.direction[0] && 1 === e21.direction[1] ? m21 = Math.PI : -1 === e21.direction[0] && 1 === e21.direction[1] && (m21 = 3 * Math.PI / 2), p23 = a25;
  else {
    const t25 = 0 !== e21.direction[0] ? 1 : 2;
    m21 = 1 === t25 ? ye : 0, p23 = (1 === t25 ? s19 : r22) - o18;
  }
  const g16 = R(f6.get(), m21);
  i4(g16, g16, o2(c2.get(), p23, p23, p23)), u4(g16, i21, g16), g16[12] = 0, g16[13] = 0, g16[14] = 0, t24.modelTransform = g16, t24.renderLocation = d19;
}
function Kt(t24, e21, i21, n20) {
  const r22 = n20.worldUpAtPosition(i21.origin, c2.get()), s19 = ee(i21, te.POSITIVE_X), o18 = R(f6.get(), s19.edge * Math.PI / 2);
  b2(o18, o18, -be2(i21, r22)), u4(o18, e21, o18), o18[12] = 0, o18[13] = 0, o18[14] = 0, t24.modelTransform = o18, t24.renderLocation = s19.position;
}
var te;
function ee(t24, e21) {
  switch (e21) {
    case te.POSITIVE_X:
      return { basis: t24.basis1, direction: 1, position: u(c2.get(), t24.origin, t24.basis1), edge: e21 };
    case te.POSITIVE_Y:
      return { basis: t24.basis2, direction: 1, position: u(c2.get(), t24.origin, t24.basis2), edge: e21 };
    case te.NEGATIVE_X:
      return { basis: t24.basis1, direction: -1, position: e2(c2.get(), t24.origin, t24.basis1), edge: e21 };
    case te.NEGATIVE_Y:
      return { basis: t24.basis2, direction: -1, position: e2(c2.get(), t24.origin, t24.basis2), edge: e21 };
  }
}
function ne2(t24) {
  const e21 = s2(t24.basis1), i21 = s2(t24.basis2);
  return H7 * Math.min(e21, i21);
}
function re2(t24) {
  return ne2(t24);
}
function se2(t24) {
  return 0 !== t24.direction[0] && 0 !== t24.direction[1];
}
function oe2(t24, e21 = _e2.CENTER_ON_ARROW) {
  const i21 = e21 === _e2.CENTER_ON_CALLOUT ? A15 : 0, n20 = [r2(i21, 0, -B6 / 2), r2(i21, 0, B6 / 2)], r22 = pe3(n20, true), s19 = (t25, e22) => de2(n20, n20, { tubeRadius: w14, tipRadius: y11, tipLength: z5, tubeFocusMultiplier: f16, tipFocusMultiplier: h22, padding: t25, bothEnds: true, flat: null, focusTipLength: true, addCap: e22 }), o18 = s19(0, false), a25 = s19(D9, true), c16 = new m12({ color: S10, cullFace: n9.Back, renderOccluded: o7.Opaque }), l21 = new m12({ color: U5, cullFace: n9.Back, renderOccluded: o7.Opaque }), u15 = new m12({ color: d18, cullFace: n9.Back, renderOccluded: o7.Opaque }), d19 = new m12({ color: q10, transparent: true, writeDepth: false, cullFace: n9.Front, renderOccluded: o7.Transparent }), m21 = q6([[i21, 0, 0], [i21 - A15, 0, 0]]), p23 = q6([[i21, 0, 0], [i21 - A15, 0, 0]]), g16 = new F4({ color: g13, renderOccluded: o7.OccludeAndTransparent });
  return new ie({ view: t24, renderObjects: [...o18.normal.map(({ part: t25, geometry: e22, transform: i22 }) => ({ geometry: e22, material: "tip" === t25 ? c16 : "cap" === t25 ? l21 : u15, transform: i22, stateMask: t12.Unfocused | Ie })), ...a25.normal.map(({ geometry: t25, transform: e22 }) => ({ geometry: t25, material: d19, transform: e22, stateMask: t12.Unfocused | Ie })), { geometry: m21, material: g16, stateMask: t12.Unfocused | Ie | Ae }, ...o18.focused.map(({ part: t25, geometry: e22, transform: i22 }) => ({ geometry: e22, material: "tip" === t25 ? c16 : "cap" === t25 ? l21 : u15, transform: i22, stateMask: t12.Focused | Ie })), ...a25.focused.map(({ geometry: t25, transform: e22 }) => ({ geometry: t25, material: d19, transform: e22, stateMask: t12.Focused | Ie })), { geometry: p23, material: g16, stateMask: t12.Focused | Ie | Ae }], autoScaleRenderObjects: false, collisionType: { type: "line", paths: [r22] }, collisionPriority: 1, radius: y11, state: Ie });
}
function ue3(t24, e21) {
  const i21 = se2(e21), n20 = i21 ? [r2(1, 0, 0), r2(0, 0, 0), r2(0, 1, 0)] : [r2(1, 0, 0), r2(-1, 0, 0)], r22 = q6(n20), s19 = E12, o18 = (t25) => new H5({ color: s19, width: t25, renderOccluded: o7.OccludeAndTransparent }), a25 = () => new F4({ color: s19, renderOccluded: o7.OccludeAndTransparent }), c16 = i21 ? F7 : G9, l21 = c16 * a24, u15 = G9, d19 = (t25) => t25 > 1 ? o18(t25) : a25(), m21 = [{ geometry: r22, material: d19(c16), stateMask: t12.Unfocused | Me }, { geometry: r22, material: d19(l21), stateMask: t12.Focused | Me }, { geometry: r22, material: d19(u15), stateMask: Le }], p23 = new ie({ view: t24, renderObjects: m21, collisionType: { type: "line", paths: [n20] }, radius: i21 ? I5 : J4, ...x12 });
  return p23.state = Me, p23;
}
function de2(t24, e21, i21) {
  const n20 = (n21) => {
    const r22 = (n21 ? e21 : t24).slice(0), o18 = e2(c2.get(), r22[0], r22[1]);
    z(o18, o18);
    const a25 = e2(c2.get(), r22[r22.length - 1], r22[r22.length - 2]);
    if (z(a25, a25), i21.padding > 0) {
      const t25 = g(n2(), a25, -i21.padding);
      if (r22[r22.length - 1] = u(t25, t25, r22[r22.length - 1]), i21.bothEnds) {
        const t26 = g(n2(), o18, -i21.padding);
        r22[0] = u(t26, t26, r22[0]);
      }
    }
    const c16 = n21 ? i21.tipFocusMultiplier : 1, d19 = i21.tipLength * (i21.focusTipLength ? c16 : 1), T14 = i21.tipRadius * c16, E14 = r6(f6.get());
    if (i21.padding > 0) {
      const t25 = d19 / 4, e22 = o2(c2.get(), 0, t25, 0), n22 = 1 + i21.padding / t25;
      c(E14, E14, e22), i4(E14, E14, o2(c2.get(), n22, n22, n22)), c(E14, E14, g(e22, e22, -1 / n22));
    }
    const O7 = r6(e6()), w18 = r2(0, 1, 0), y14 = I(e6(), Q(o6.get(), w18, a25));
    y14[12] = r22[r22.length - 1][0], y14[13] = r22[r22.length - 1][1], y14[14] = r22[r22.length - 1][2], u4(y14, y14, E14);
    const M14 = [{ part: "tube", geometry: me2(i21.tubeRadius * (n21 ? i21.tubeFocusMultiplier : 1) + i21.padding, i21.flat, r22), transform: O7 }];
    let L9, C15;
    if (r(i21.flat) ? L9 = Z5(d19, T14, T14, i21.flat.thickness) : (L9 = C4(d19, T14, 24, false, false, true), C15 = C4(d19, T14, 24, false, true, false)), M14.push({ part: "tip", geometry: L9, transform: y14 }), C15 && M14.push({ part: "cap", geometry: C15, transform: y14 }), i21.bothEnds) {
      const t25 = I(e6(), Q(o6.get(), w18, o18));
      t25[12] = r22[0][0], t25[13] = r22[0][1], t25[14] = r22[0][2], u4(t25, t25, E14), M14.push({ part: "tip", geometry: L9, transform: t25 }), C15 && M14.push({ part: "cap", geometry: C15, transform: t25 });
    }
    return M14;
  };
  return { normal: n20(false), focused: n20(true) };
}
function me2(t24, e21, i21) {
  const n20 = [];
  if (r(e21))
    n20.push([t24, e21.thickness / 2], [-t24, e21.thickness / 2], [-t24, -e21.thickness / 2], [t24, -e21.thickness / 2]);
  else {
    const e22 = 12;
    for (let i22 = 0; i22 < e22; i22++) {
      const r22 = i22 / e22 * 2 * Math.PI;
      n20.push([Math.cos(r22) * t24, Math.sin(r22) * t24]);
    }
  }
  return k2(n20, i21, [], [], false);
}
function pe3(t24, e21) {
  const i21 = e2(n2(), t24[t24.length - 1], t24[t24.length - 2]);
  if (z(i21, i21), g(i21, i21, z5), u(i21, i21, t24[t24.length - 1]), e21) {
    const e22 = e2(n2(), t24[0], t24[1]);
    return z(e22, e22), g(e22, e22, z5), u(e22, e22, t24[0]), [e22, ...t24, i21];
  }
  return [...t24, i21];
}
function be2(t24, e21) {
  return i7(e21, t24.basis2, t24.basis1) + ye;
}
!function(t24) {
  t24[t24.POSITIVE_X = 0] = "POSITIVE_X", t24[t24.POSITIVE_Y = 1] = "POSITIVE_Y", t24[t24.NEGATIVE_X = 2] = "NEGATIVE_X", t24[t24.NEGATIVE_Y = 3] = "NEGATIVE_Y";
}(te || (te = {}));
var Ie = u7.Custom1;
var Re2;
var we;
!function(t24) {
  t24[t24.HEADING = 1] = "HEADING", t24[t24.TILT = 2] = "TILT";
}(Re2 || (Re2 = {})), function(t24) {
  t24[t24.HORIZONTAL_OR_VERTICAL = 0] = "HORIZONTAL_OR_VERTICAL", t24[t24.HORIZONTAL = 1] = "HORIZONTAL", t24[t24.VERTICAL = 2] = "VERTICAL", t24[t24.TILTED = 3] = "TILTED";
}(we || (we = {}));
var Ae = u7.Custom2;
var je = d3();
var ye = Math.PI / 2;
var Me = u7.Custom1;
var Le = u7.Custom2;
var _e2;
!function(t24) {
  t24[t24.CENTER_ON_CALLOUT = 0] = "CENTER_ON_CALLOUT", t24[t24.CENTER_ON_ARROW = 1] = "CENTER_ON_ARROW";
}(_e2 || (_e2 = {}));

// node_modules/@arcgis/core/views/3d/analysis/Slice/images/heading-rotate-png.js
var A17 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAnFBMVEUAAAD/gAD/gAD/cAD/gAD/eAD/gAD/eQD/gAD/egD/gAD/ewD/gAD/fAD/gAD/fAD/gAD/fAD/fQD/fQD/fQD/fQD/fQD/fgD/jR7/mjn/mjf/p1H/plH/smf/sWb/vHr/u3n/xYz/xIv/zZz/zJv/zJr/1Kv/1Kr/06r/06n/27n/27f/4cX/4cT/59D/7dr/8uX/9u7/+/f////u2EN0AAAAM3RSTlMACBAQICAoKDAwODhAQEhIUFBYYGhweICIkJCXmJ+gp6ivsLe4uL+/wMDHx8/P19/n7/cWvjXwAAACeUlEQVR42tWX3XqiMBCGY2pbtbrUnzhhdak/lHWliJD7v7fdJ+KG5AMhh30P8zCTmS+TycDaeBoHi5Wgf4jVYvbKmRfPgSAHMX9mPRnM1tSIGHM/c2QddLp4c8wxCvYIvqROBPfbHlm/sRYC6smMNTKn3sxZAyvyYNW1v38MM/IkcPQnZHPMLtciz9P9hhqwzoLD+cnfpTIUaYinyZlBkE2YKZcMXCyN/YhsPkuFlMfWJLiwo89VMxfpJDForMCwuG+Zx7ttGO2S/w4LJ42ZURDty5M0a4dqsZAQAihQfXqWdlhnpcmdEPAI0tv2EbnsbsKmdgi6/1GN7T1XJLx5sF0P9SWABMC+co5JBE4Ge/1NTM3EGIJgjFONXCdAbeQYwhN7pRrRV20LJNIhWOczdu+xPFzIBiQ62iIsyIOTvlZUY+HXySLQaMUEeSC1CPYxENIlwk+q8e0clFAIfiKG+qpaIvod4wfU8sqvkDLda+xCCqgDaAk7uyeNqD+feFlfGCcg3Hzsk+xS7Nz1Aq4CcauhhMc0uxaqIgcFsF0J+1WQyoCN7Y9ezeCVH5LhSxmyRvsihKbK1m7LafpSpkpj6yJgtsiVBh6AX5UyCVmMbrNpcwj5/h6DPN79JjAiQAhXVeN6SZI0q5bQnn4wBiHEqpUybp1ZJzWxStVCHhKhAhVLp/Emh6trHpGLaB6yZHk7wu3Z+ChOxhwUNEmYYjpUvqJDksSHraQmJm2DdqQK6sGUObybYtpSN+8Phm3pN2xjDH33R6b0CKxAZNLvl8foD3BBnSw5e8RI+G2P8GD9wHw6YN3wkfA0R4Zz8CGCIfOCv8zM738walXuLw6nXBvPr8wvAAAAAElFTkSuQmCC";

// node_modules/@arcgis/core/views/3d/analysis/Slice/images/Factory.js
var n19 = { mipmap: true, preMultiplyAlpha: true, width: 64, height: 64 };
function o17(r22) {
  return r22.fromData(A17, () => new L(A17, n19));
}

// node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/PreserveAspectRatio.js
var s18 = class {
  constructor() {
    this._lastDragEvent = null, this.next = new G3(), this._enabled = false;
  }
  get enabled() {
    return this._enabled;
  }
  set enabled(a25) {
    if (this._enabled !== a25 && r(this._lastDragEvent)) {
      const t24 = { ...this._lastDragEvent, action: "update" };
      a25 && this._adjustScaleFactors(t24), this.next.execute(t24);
    }
    this._enabled = a25;
  }
  createDragEventPipelineStep() {
    return this._lastDragEvent = null, (t24) => (this._lastDragEvent = "end" !== t24.action ? { ...t24 } : null, this._enabled && this._adjustScaleFactors(t24), t24);
  }
  _adjustScaleFactors(t24) {
    const e21 = se2(t24.handle) ? Math.max(Math.abs(t24.factor1), Math.abs(t24.factor2)) : 0 === t24.handle.direction[0] ? Math.abs(t24.factor2) : Math.abs(t24.factor1);
    t24.factor1 = t24.factor1 < 0 ? -e21 : e21, t24.factor2 = t24.factor2 < 0 ? -e21 : e21;
  }
  get test() {
    return { _adjustScaleFactors: (t24) => this._adjustScaleFactors(t24) };
  }
};

// node_modules/@arcgis/core/views/interactive/editGeometry/support/editPlaneUtils.js
function S12(s19, o18) {
  return _9(s19, o18, false);
}
function Y3(s19, o18) {
  return _9(s19, o18, true);
}
function _9(s19, o18, i21) {
  if (s19 instanceof t14) {
    if (s19.operation instanceof t15)
      return z7(s19.operation, o18, i21), true;
    if (s19.operation instanceof s12)
      return P11(s19.operation, o18, i21), true;
    if (s19.operation instanceof c6)
      return U6(s19.operation, o18, i21), true;
  }
  return false;
}
function z7(s19, o18, i21 = false) {
  const t24 = i21 ? -1 : 1, n20 = r2(t24 * s19.dx, t24 * s19.dy, t24 * s19.dz);
  u(o18.origin, o18.origin, n20);
}
function P11(s19, o18, i21 = false) {
  const t24 = i21 ? -s19.angle : s19.angle;
  T(o18.basis1, o18.basis1, f, t24), T(o18.basis2, o18.basis2, f, t24);
}
function U6(s19, o18, t24 = false) {
  const n20 = t24 ? 1 / s19.factor1 : s19.factor1, r22 = t24 ? 1 / s19.factor2 : s19.factor2;
  g(o18.basis1, o18.basis1, n20), g(o18.basis2, o18.basis2, r22), w5(o18.origin, o18.origin, s19.origin, s19.axis1, n20), w5(o18.origin, o18.origin, s19.origin, s19.axis2, r22);
}
function A18(s19, o18, i21, b15) {
  b15 || (b15 = G2());
  const f18 = r8(t6.get(), s19[1], -s19[0]), u15 = r8(t6.get(), Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY), m21 = r8(t6.get(), Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY), p23 = t6.get();
  o18.components.forEach((o19) => o19.vertices.forEach((o20) => {
    const i22 = o20.pos;
    r8(p23, j4(s19, i22), j4(f18, i22)), f5(u15, u15, p23), M2(m21, m21, p23);
  }));
  const I7 = 1e-6, d19 = r8(t6.get(), m21[0] - u15[0] < I7 ? i21 / 2 : 0, m21[1] - u15[1] < I7 ? i21 / 2 : 0);
  return o5(u15, u15, d19), s6(m21, m21, d19), l6(b15.basis1, s19, (m21[0] - u15[0]) / 2), l6(b15.basis2, f18, (m21[1] - u15[1]) / 2), r8(b15.origin, u15[0] * s19[0] + u15[1] * f18[0], u15[0] * s19[1] + u15[1] * f18[1]), s6(b15.origin, b15.origin, b15.basis1), s6(b15.origin, b15.origin, b15.basis2), b15;
}
function G11(s19, o18, i21, t24 = 0, n20) {
  n20 || (n20 = G2()), o18.toRenderCoords(s19.origin, i21, n20.origin);
  const r22 = c2.get();
  u(r22, s19.origin, s19.basis1), u(r22, r22, s19.basis2), o18.toRenderCoords(r22, i21, r22);
  const a25 = c2.get();
  u(a25, s19.origin, s19.basis1), e2(a25, a25, s19.basis2), o18.toRenderCoords(a25, i21, a25);
  const e21 = c2.get();
  e2(e21, s19.origin, s19.basis1), e2(e21, e21, s19.basis2), o18.toRenderCoords(e21, i21, e21);
  const c16 = c2.get();
  e2(c16, s19.origin, s19.basis1), u(c16, c16, s19.basis2), o18.toRenderCoords(c16, i21, c16);
  const g16 = A(c2.get(), r22, a25, 0.5);
  e2(g16, g16, n20.origin);
  const f18 = A(c2.get(), e21, c16, 0.5);
  e2(f18, n20.origin, f18), A(n20.basis1, g16, f18, 0.5);
  const h26 = A(c2.get(), c16, r22, 0.5);
  e2(h26, h26, n20.origin);
  const l21 = A(c2.get(), a25, e21, 0.5);
  e2(l21, n20.origin, l21), A(n20.basis2, h26, l21, 0.5);
  const x19 = _(c2.get(), n20.basis1, n20.basis2), V9 = _(x19, x19, n20.basis1);
  return z(V9, V9), g(n20.basis2, V9, P(n20.basis2, V9)), g(n20.basis1, n20.basis1, 1 + t24 / s2(n20.basis1)), g(n20.basis2, n20.basis2, 1 + t24 / s2(n20.basis2)), H3(n20), n20;
}
function M13(i21, t24, n20, r22) {
  const a25 = c2.get();
  e2(a25, e2(a25, i21.origin, i21.basis1), i21.basis2);
  const e21 = c2.get();
  q(e21, a25, i21.basis1, 2);
  const c16 = c2.get();
  q(c16, e21, i21.basis2, 2);
  const g16 = c2.get();
  q(g16, a25, i21.basis2, 2), a25[2] = e21[2] = c16[2] = g16[2] = t24;
  const b15 = r22 ? "on-the-ground" : "absolute-height", f18 = p10(g6(a25, e21, n20, b15), g6(g16, c16, n20, b15)), u15 = p10(g6(e21, c16, n20, b15), g6(a25, g16, n20, b15));
  return t(u15) || t(f18) ? null : [f18, u15];
}

// node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/ExtentTransformTool.js
var Zt = class extends n5.EventedMixin(p11) {
  constructor(t24) {
    super(t24), this.enableZ = true, this.enableRotation = true, this.enableScaling = true, this.tooltipOptions = new p8(), this._preserveAspectRatio = new s18(), this.grabbing = false, this.inputState = null, this.type = "transform-3d", this._handles = new t4(), this._moveZManipulator = null, this._resizeManipulators = null, this._rotateManipulator = null, this._attachmentOrigin = null, this._outlineVisualElement = null, this._mapBounds = G2(), this._mapBoundsStart = G2(), this._zmax = 0, this._sizeStart = null, this._displayBounds = G2(), this._displayBoundsStart = G2(), this._displayBoundsMarginStart = 0, this._resizeHandles = [{ direction: [1, 0] }, { direction: [1, 1] }, { direction: [0, 1] }, { direction: [-1, 1] }, { direction: [-1, 0] }, { direction: [-1, -1] }, { direction: [0, -1] }, { direction: [1, -1] }], this._moveXYTooltipInfo = null, this._moveZTooltipInfo = null, this._rotateTooltipInfo = null, this._scaleTooltipInfo = null, this._startAngle = 0, this._endAngle = 0, this._startScale = n8(), this._endScale = n8();
  }
  initialize() {
    const { view: t24, graphic: e21, manipulators: i21, _handles: s19 } = this, r22 = this._graphicState = new e19({ graphic: e21 }), n20 = e21.geometry;
    this._editGeometryOperations = V.fromGeometry(n20, t24.state.viewingMode), this._graphicMoveManipulation = new l18({ tool: this, view: t24, graphicState: r22 }), this._moveZManipulator = oe2(t24, _e2.CENTER_ON_CALLOUT), this._moveZManipulator.state |= Ae, s19.add([this._createMoveXYGraphicDragPipeline(), l3(() => this.enableZ, () => this._updateManipulatorAvailability(this._moveZManipulator, A12.TRANSLATE_Z)), this._createMoveZDragPipeline()]), i21.add(this._moveZManipulator), this._resizeManipulators = this._resizeHandles.map((e22) => {
      const i22 = ue3(t24, e22);
      return s19.add([l3(() => this.enableScaling, () => this._updateManipulatorAvailability(i22, A12.SCALE)), i22.events.on("grab-changed", (t25) => this._onResizeGrab(t25)), this._createResizeDragPipeline(i22, e22)]), i22;
    }), i21.addMany(this._resizeManipulators), this._rotateManipulatorTexture = o17(t24.toolViewManager.textures), this._rotateManipulator = R3(t24, { texture: this._rotateManipulatorTexture.texture }), s19.add([l3(() => this.enableRotation, () => this._updateManipulatorAvailability(this._rotateManipulator, A12.ROTATE)), this._rotateManipulator.events.on("grab-changed", (t25) => {
      this._onRotateGrab(t25);
    }), this._createRotateDragPipeline(this._rotateManipulator)]), i21.add(this._rotateManipulator), this._calculateMapBounds(), this._updateDisplayBounds();
    const p23 = i15({ view: t24, graphic: e21, forEachManipulator: (t25) => this._forEachManipulator(t25), onManipulatorsChanged: () => n3() });
    r(p23) && (this._outlineVisualElement = p23.visualElement instanceof S8 ? p23.visualElement : null), r(this._outlineVisualElement) && s19.add(this._outlineVisualElement.events.on("attachment-origin-changed", () => this._updateDisplayBounds())), s19.add(p23), s19.add([r22.on("changed", () => this._onGeometryChanged()), l3(() => r22.displaying, () => this._updateAllManipulatorAvailability()), l3(() => r22.isDraped, () => this._graphicDrapedChanged(), h4), t24.trackGraphicState(r22)]);
    const l21 = t24.pointsOfInterest;
    l21 && s19.add(l3(() => l21.centerOnSurfaceFrequent.location, () => this._updateDisplayBounds()));
    const d19 = (t25) => {
      s19.add(t25.events.on("grab-changed", () => {
        this.grabbing = t25.grabbing, this._updateAllManipulatorAvailability();
      }));
    };
    this._forEachManipulator(d19);
    const u15 = (t25, i22) => {
      s19.add(t25.events.on("immediate-click", (t26) => {
        i22 === A12.TRANSLATE_XY && this.emit("immediate-click", { ...t26, graphic: e21 }), t26.stopPropagation();
      }));
    };
    this._forEachManipulator(u15), this._onGeometryChanged(), this._updateAllManipulatorAvailability(), this._initializeTooltip(), this.finishToolCreation();
  }
  destroy() {
    this._mapBounds = null, this._displayBounds = null, this._rotateManipulatorTexture.release(), this._handles.destroy(), this._graphicMoveManipulation.destroy(), this._editGeometryOperations.destroy(), this._tooltip.destroy(), this._set("view", null), this._set("graphic", null);
  }
  _initializeTooltip() {
    const { _handles: t24, view: e21 } = this, i21 = this._tooltip = new m9({ view: e21 }), a25 = () => {
      i21.info = this._getUpdatedTooltipInfo();
    };
    t24.add([this.on("graphic-translate-start", a25), this.on("graphic-translate", a25), this.on("graphic-translate-stop", () => {
      this._moveXYTooltipInfo = null, this._moveZTooltipInfo = null, this._tooltip.clear();
    }), this.on("graphic-rotate-start", (t25) => {
      this._startAngle = t25.angle, a25();
    }), this.on("graphic-rotate", (t25) => {
      this._endAngle = t25.angle, a25();
    }), this.on("graphic-rotate-stop", () => {
      this._startAngle = 0, this._endAngle = 0, a25();
    }), this.on("graphic-scale-start", (t25) => {
      r8(this._startScale, t25.xScale, t25.yScale), r8(this._endScale, t25.xScale, t25.yScale), a25();
    }), this.on("graphic-scale", (t25) => {
      r8(this._endScale, t25.xScale, t25.yScale), a25();
    }), this.on("graphic-scale-stop", () => {
      r8(this._startScale, 0, 0), r8(this._endScale, 0, 0), a25();
    })]), this._forEachManipulator((e22) => {
      t24.add([e22.events.on("focus-changed", a25), e22.events.on("grab-changed", a25), e22.events.on("drag", (t25) => {
        "cancel" === t25.action ? this._tooltip.clear() : a25();
      })]);
    });
  }
  _getUpdatedTooltipInfo() {
    return this.tooltipOptions.enabled ? this._graphicMoveManipulation.grabbing || this._graphicMoveManipulation.dragging ? this._computeMoveXYTooltipInfo() : this._moveZManipulator.focused ? this._computeMoveZTooltipInfo() : this._rotateManipulator.focused ? this._computeRotateTooltipInfo() : this._resizeManipulators.some((t24) => t24.focused) ? this._computeScaleTooltipInfo() : null : null;
  }
  _computeMoveXYTooltipInfo() {
    return this._moveXYTooltipInfo = i(this._moveXYTooltipInfo, () => new r14({ tooltipOptions: this.tooltipOptions }));
  }
  _computeMoveZTooltipInfo() {
    const t24 = this._moveZTooltipInfo = i(this._moveZTooltipInfo, () => new p13({ tooltipOptions: this.tooltipOptions })), e21 = this._moveUnit;
    if (this._moveZManipulator.dragging) {
      const e22 = this._mapBoundsStart.origin, i21 = this._mapBounds.origin, a25 = D2(e22, i21, this.view.spatialReference);
      if (t(a25))
        return null;
      t24.distance = a25;
    } else
      t24.distance = a13(0, e21);
    return t24;
  }
  _computeRotateTooltipInfo() {
    const t24 = this._rotateTooltipInfo = i(this._rotateTooltipInfo, () => new i14({ tooltipOptions: this.tooltipOptions }));
    return t24.angle = this._startAngle - this._endAngle, t24;
  }
  _computeScaleTooltipInfo() {
    const t24 = this.graphic.geometry;
    if (t(t24))
      return null;
    const e21 = this._scaleTooltipInfo = i(this._scaleTooltipInfo, () => new p14({ tooltipOptions: this.tooltipOptions })), i21 = M13(this._mapBounds, this._zmax, t24.spatialReference, this._graphicState.isDraped);
    return t(i21) ? null : (e21.xSize = i21[0], e21.ySize = i21[1], r(this._sizeStart) && this._resizeManipulators.some((t25) => t25.dragging) ? (e21.xScale = i21[0].value / this._sizeStart[0].value, e21.yScale = i21[1].value / this._sizeStart[1].value) : (e21.xScale = 1, e21.yScale = 1), e21);
  }
  _graphicDrapedChanged() {
    this._handles.remove(Ct), this._updateDisplayBounds(), this._graphicState.isDraped && this._handles.add(this.view.elevationProvider.on("elevation-change", (t24) => {
      r(this._attachmentOrigin) && w4(t24.extent, this._attachmentOrigin.x, this._attachmentOrigin.y) && this._updateDisplayBounds();
    }), Ct);
  }
  _updateAllManipulatorAvailability() {
    this._forEachManipulator((t24, e21) => this._updateManipulatorAvailability(t24, e21));
  }
  _updateManipulatorAvailability(t24, e21) {
    const i21 = this.grabbing && !t24.grabbing;
    if (t24.interactive = !i21, t24 instanceof ie) {
      const a25 = this._graphicState.displaying, s19 = this.enableZ && t19(this.graphic);
      switch (e21) {
        case A12.ROTATE:
          t24.available = a25 && this.enableRotation;
          break;
        case A12.SCALE:
          t24.available = a25 && (this.enableScaling || this.enableRotation || s19), t24.interactive = !i21 && this.enableScaling, t24.state = this.enableScaling ? Me : Le;
          break;
        case A12.TRANSLATE_Z:
          t24.available = a25 && s19;
          break;
        default:
          t24.available = a25;
      }
    }
  }
  _forEachManipulator(t24) {
    this._graphicMoveManipulation.forEachManipulator(t24), this._resizeManipulators.forEach((e21) => t24(e21, A12.SCALE)), t24(this._rotateManipulator, A12.ROTATE), t24(this._moveZManipulator, A12.TRANSLATE_Z);
  }
  get preserveAspectRatio() {
    return this._preserveAspectRatio.enabled;
  }
  set preserveAspectRatio(t24) {
    this._preserveAspectRatio.enabled = t24, this._set("preserveAspectRatio", t24);
  }
  get _moveUnit() {
    return i(Z(this.view.spatialReference), "meters");
  }
  reset() {
  }
  _onGeometryChanged() {
    this._updateDisplayBounds();
  }
  _calculateMapBounds() {
    const t24 = this.graphic.geometry, e21 = this._editGeometryOperations.data, i21 = e21.components[0].edges[0], a25 = o5(t6.get(), i21.leftVertex.pos, i21.rightVertex.pos);
    v3(a25, a25);
    const s19 = i(N2(this.view, this.graphic), () => t24.extent.center);
    let o18 = Xt * this.view.pixelSizeAt(s19);
    const n20 = this.view.spatialReference, p23 = t24.spatialReference;
    n20.equals(p23) || (o18 *= $(n20) / $(p23)), A18(a25, e21, o18, this._mapBounds), this._updateZMax();
  }
  _updateZMax() {
    const t24 = this._editGeometryOperations.data;
    if (!t24.geometry.hasZ)
      return void (this._zmax = 0);
    const e21 = t24.coordinateHelper;
    let i21 = Number.NEGATIVE_INFINITY;
    for (const a25 of t24.components)
      for (const t25 of a25.vertices) {
        const a26 = e21.getZ(t25.pos);
        i21 = Math.max(a26, i21);
      }
    this._zmax = i21;
  }
  _updateDisplayBounds() {
    const t24 = this.graphic.geometry;
    if (t(t24))
      return;
    const e21 = r(this._outlineVisualElement) && !this._graphicState.isDraped && r(this._outlineVisualElement.attachmentOrigin) ? this._outlineVisualElement.attachmentOrigin : N2(this.view, this.graphic);
    this._attachmentOrigin = i(e21, t24.extent.center);
    const i21 = r(e21) ? e21.z : m11(this._mapBounds.origin, this.view.elevationProvider, h13.fromElevationInfo(f9(this.graphic)), this.view.renderCoordsHelper), a25 = X(this._mapBounds);
    a25.origin[2] = i21, G11(a25, this.view.renderCoordsHelper, t24.spatialReference, this._displayBoundsMargin, this._displayBounds), this._updateManipulators();
  }
  get _displayBoundsMargin() {
    const t24 = this.view.pointsOfInterest, e21 = t24 ? t24.centerOnSurfaceFrequent.location : this._editGeometryOperations.data.geometry.extent.center;
    return kt2 * this.view.pixelSizeAt(e21);
  }
  _createMoveXYGraphicDragPipeline() {
    return this._graphicMoveManipulation.createDragPipeline((t24, e21, i21) => this._applyGraphicMoveSteps(e21, i21, M12.XY));
  }
  _createMoveZDragPipeline() {
    const t24 = this.view, e21 = this._editGeometryOperations.data.spatialReference;
    return d10(this._moveZManipulator, (i21, a25, s19) => {
      const o18 = t2(i21.renderLocation), r22 = a25.next(G8(t24, o18, e21)).next(U3());
      this._applyGraphicMoveSteps(r22, s19, M12.Z);
    });
  }
  _applyGraphicMoveSteps(t24, e21, i21) {
    const a25 = t24.next((t25) => ("start" === t25.action && (this.inputState = { type: "move" }, this._updateOperationStartProperties(), this.emit("graphic-translate-start", { graphic: this.graphic, dxScreen: t25.screenDeltaX, dyScreen: t25.screenDeltaY })), t25)).next(P3()).next(this._moveDragUpdateGeometry()).next((t25) => {
      const e22 = { graphic: this.graphic, dxScreen: t25.screenDeltaX, dyScreen: t25.screenDeltaY };
      switch (t25.action) {
        case "start":
        case "update":
          (t25.mapEnd.x - t25.mapStart.x || t25.mapEnd.y - t25.mapStart.y || t25.mapEnd.z - t25.mapStart.z) && this.emit("graphic-translate", e22);
          break;
        case "end":
          this.inputState = null, this.emit("graphic-translate-stop", e22);
      }
      return t25;
    }).next((t25) => this._updateMoveTooltip(t25, i21));
    return e21.next(() => {
      r(this.inputState) && this.emit("graphic-translate-stop", { graphic: this.graphic, dxScreen: 0, dyScreen: 0 }), this._cancel();
    }), a25;
  }
  _updateOperationStartProperties() {
    X(this._displayBounds, this._displayBoundsStart), X(this._mapBounds, this._mapBoundsStart), t(this.graphic.geometry) ? this._sizeStart = null : this._sizeStart = M13(this._mapBoundsStart, this._zmax, this.graphic.geometry.spatialReference, this._graphicState.isDraped);
  }
  _moveDragUpdateGeometry() {
    return (t24) => {
      if (t(this.inputState) || "move" !== this.inputState.type)
        return t24;
      const e21 = [];
      for (const s19 of this._editGeometryOperations.data.components)
        e21.push(...s19.vertices);
      const i21 = "start" === t24.action ? E7.NEW_STEP : E7.ACCUMULATE_STEPS, a25 = this._editGeometryOperations.moveVertices(e21, t24.mapDeltaX, t24.mapDeltaY, t24.mapDeltaZ, i21);
      return S12(a25, this._mapBounds), this.graphic.geometry = this._editGeometryOperations.data.geometry, t24;
    };
  }
  _updateMoveTooltip(t24, e21) {
    if (e21 === M12.XY || e21 === M12.XY_AXIS) {
      const e22 = a14(t24.mapStart, t24.mapEnd, this._graphicState.isDraped ? "on-the-ground" : "absolute-height");
      r(e22) && r(this._moveXYTooltipInfo) && (this._moveXYTooltipInfo.distance = e22);
    }
    return t24;
  }
  _onResizeGrab(t24) {
    if ("start" !== t24.action)
      return;
    const e21 = this._calculatePickRay(t24.screenPoint);
    q3(this._displayBounds.plane, e21, c2.get()) && (this._updateOperationStartProperties(), this._displayBoundsMarginStart = this._displayBoundsMargin, this.inputState = { type: "resize" });
  }
  _createResizeDragPipeline(t24, e21) {
    return d10(t24, (t25, i21, a25) => {
      t(this.inputState) || (i21.next((t26) => ("start" === t26.action && this.emit("graphic-scale-start", { graphic: this.graphic, xScale: 1, yScale: 1 }), t26)).next(C11(this.view, this._displayBoundsStart.plane)).next((t26) => ({ ...t26, handle: e21 })).next(this._resizeDragRenderPlaneToFactors()).next(this._preserveAspectRatio.createDragEventPipelineStep(), this._preserveAspectRatio.next).next(this._resizeDragUpdateGeometry()).next((t26) => {
        const e22 = { graphic: this.graphic, xScale: t26.factor1, yScale: t26.factor2 };
        switch (t26.action) {
          case "start":
          case "update":
            this.emit("graphic-scale", e22);
            break;
          case "end":
            this.inputState = null, this.emit("graphic-scale-stop", e22);
        }
        return t26;
      }), a25.next(() => {
        r(this.inputState) && this.emit("graphic-scale-stop", { graphic: this.graphic, xScale: 1, yScale: 1 }), this._cancel();
      }));
    });
  }
  _resizeDragRenderPlaneToFactors() {
    return (t24) => {
      const e21 = this._displayBoundsStart, i21 = t24.handle.direction, a25 = this._displayBoundsMargin, s19 = this._displayBoundsMarginStart, o18 = r3(c2.get(), e21.origin);
      q(o18, o18, e21.basis1, -i21[0]), q(o18, o18, e21.basis2, -i21[1]);
      const r22 = e2(c2.get(), t24.renderEnd, o18), n20 = e2(c2.get(), t24.renderStart, o18), p23 = se2(t24.handle), l21 = re2(e21), h26 = re2(this._displayBounds) / l21, c16 = (t25, e22) => {
        if (0 === t25)
          return 1;
        let i22 = s2(e22), o19 = 0.5 * t25 * P(e22, r22) / i22;
        const l22 = o19 < 0 ? -1 : 1;
        if (p23) {
          o19 += (i22 - 0.5 * t25 * P(e22, n20) / i22) * l22 * h26;
        }
        const c17 = i22 < 1.5 * s19 ? 1 : Yt;
        return i22 = Math.max(i22 - s19, Yt), l22 > 0 && (o19 -= a25), l22 * Math.max(l22 * (o19 / i22), c17);
      };
      return { ...t24, factor1: c16(i21[0], e21.basis1), factor2: c16(i21[1], e21.basis2) };
    };
  }
  _resizeDragUpdateGeometry() {
    return (t24) => {
      const e21 = r3(n2(), this._mapBoundsStart.origin);
      q(e21, e21, this._mapBoundsStart.basis1, -t24.handle.direction[0]), q(e21, e21, this._mapBoundsStart.basis2, -t24.handle.direction[1]);
      const i21 = r8(n8(), this._mapBoundsStart.basis1[0], this._mapBoundsStart.basis1[1]);
      v3(i21, i21);
      const a25 = [];
      for (const r22 of this._editGeometryOperations.data.components)
        a25.push(...r22.vertices);
      const s19 = "start" === t24.action ? E7.NEW_STEP : E7.ACCUMULATE_STEPS, o18 = this._editGeometryOperations.scaleVertices(a25, e21, i21, t24.factor1, t24.factor2, s19, e14.REPLACE);
      return X(this._mapBoundsStart, this._mapBounds), S12(o18, this._mapBounds), this.graphic.geometry = this._editGeometryOperations.data.geometry, t24;
    };
  }
  _onRotateGrab(t24) {
    if ("start" !== t24.action)
      return;
    const e21 = qt(this._displayBounds, this.view.renderCoordsHelper, Re2.HEADING, p5()), i21 = this._calculatePickRay(t24.screenPoint);
    q3(e21, i21, c2.get()) && (this._updateOperationStartProperties(), this.inputState = { type: "rotate", rotatePlane: e21 });
  }
  _createRotateDragPipeline(t24) {
    return d10(t24, (t25, e21, i21) => {
      const a25 = this.inputState;
      t(a25) || (e21.next((t26) => ("start" === t26.action && this.emit("graphic-rotate-start", { graphic: this.graphic, angle: 0 }), t26)).next(C11(this.view, a25.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(a25)).next(this._rotateDragUpdateGeometry()).next((t26) => {
        const e22 = { graphic: this.graphic, angle: b(t26.rotateAngle) };
        switch (t26.action) {
          case "start":
          case "update":
            this.emit("graphic-rotate", e22);
            break;
          case "end":
            this.inputState = null, this.emit("graphic-rotate-stop", e22);
        }
        return t26;
      }), i21.next(() => {
        r(this.inputState) && this.emit("graphic-rotate-stop", { graphic: this.graphic, angle: 0 }), this._cancel();
      }));
    });
  }
  _rotateDragRenderPlaneToRotate(t24) {
    return (e21) => {
      const i21 = Y2(t24.rotatePlane), a25 = z4(e21.renderStart, e21.renderEnd, this._displayBounds.origin, i21);
      return { ...e21, rotateAxis: i21, rotateAngle: a25 };
    };
  }
  _rotateDragUpdateGeometry() {
    return (t24) => {
      const e21 = r3(n2(), this._mapBoundsStart.origin), i21 = [];
      for (const o18 of this._editGeometryOperations.data.components)
        i21.push(...o18.vertices);
      const a25 = "start" === t24.action ? E7.NEW_STEP : E7.ACCUMULATE_STEPS, s19 = this._editGeometryOperations.rotateVertices(i21, e21, t24.rotateAngle, a25, e14.REPLACE);
      return X(this._mapBoundsStart, this._mapBounds), S12(s19, this._mapBounds), this.graphic.geometry = this._editGeometryOperations.data.geometry, t24;
    };
  }
  _calculatePickRay(t24) {
    const e21 = d3(), i21 = d(t24);
    return s14(this.view.state.camera, i21, e21), z(e21.direction, e21.direction), e21;
  }
  _updateManipulators() {
    if (!this.visible)
      return;
    const t24 = Bt(this._displayBounds, f6.get());
    Kt(this._rotateManipulator, t24, this._displayBounds, this.view.renderCoordsHelper), this._updateZMoveHandle(this._moveZManipulator, t24), this._resizeManipulators.forEach((e21, i21) => {
      Jt(e21, this._resizeHandles[i21], t24, this._displayBounds);
    });
  }
  _updateZMoveHandle(t24, e21) {
    const i21 = this._displayBounds, a25 = { basis: i21.basis1, direction: -1, position: e2(c2.get(), i21.origin, i21.basis1), edge: 2 }, s19 = f6.get();
    m4(s19, e21, a25.edge * Math.PI / 2), s19[12] = 0, s19[13] = 0, s19[14] = 0, t24.modelTransform = s19, t24.renderLocation = a25.position;
  }
  _cancel() {
    const t24 = this._editGeometryOperations.lastOperation;
    t(t24) || (this._editGeometryOperations.undo(), this.graphic.geometry = this._editGeometryOperations.data.geometry, Y3(t24, this._mapBounds), this._updateDisplayBounds(), this.inputState = null);
  }
  get canUndo() {
    return this._editGeometryOperations.canUndo;
  }
  undo() {
    if (r(this.inputState))
      this.view.activeTool = null;
    else if (this.canUndo) {
      const t24 = this._editGeometryOperations.undo();
      this.graphic.geometry = this._editGeometryOperations.data.geometry, Y3(e(t24), this._mapBounds), this._updateDisplayBounds();
    }
  }
  get canRedo() {
    return this._editGeometryOperations.canRedo;
  }
  redo() {
    if (this.canRedo) {
      const t24 = this._editGeometryOperations.redo();
      this.graphic.geometry = this._editGeometryOperations.data.geometry, S12(e(t24), this._mapBounds), this._updateDisplayBounds();
    }
  }
  get test() {
    return { resizeManipulators: this._resizeManipulators, rotateManipulator: this._rotateManipulator, moveZManipulator: this._moveZManipulator, tooltip: this._tooltip };
  }
};
e3([y2({ constructOnly: true, nonNullable: true })], Zt.prototype, "view", void 0), e3([y2({ constructOnly: true, nonNullable: true })], Zt.prototype, "graphic", void 0), e3([y2({ constructOnly: true, nonNullable: true })], Zt.prototype, "enableZ", void 0), e3([y2()], Zt.prototype, "enableRotation", void 0), e3([y2()], Zt.prototype, "enableScaling", void 0), e3([y2({ constructOnly: true, type: p8 })], Zt.prototype, "tooltipOptions", void 0), e3([y2()], Zt.prototype, "preserveAspectRatio", null), e3([y2()], Zt.prototype, "grabbing", void 0), e3([y2()], Zt.prototype, "inputState", void 0), e3([y2({ readOnly: true })], Zt.prototype, "type", void 0), e3([y2()], Zt.prototype, "_moveUnit", null), Zt = e3([n4("esri.views.3d.interactive.editingTools.graphicTransform3D.ExtentTransformTool")], Zt);
var Ct = "draped-elevation-changes";
var kt2 = 10;
var Xt = 80;
var Yt = 1e-6;
export {
  T8 as DrawGraphicTool3D,
  Zt as ExtentTransformTool,
  B5 as GraphicMoveTool,
  v14 as GraphicReshapeTool,
  V8 as GraphicTransformTool
};
//# sourceMappingURL=editingTools-3KE6RLLL.js.map
