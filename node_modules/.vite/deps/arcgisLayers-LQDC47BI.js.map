{
  "version": 3,
  "sources": ["../../@arcgis/core/layers/support/arcgisLayers.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{isNone as r,isSome as a}from\"../../core/maybe.js\";import{getFilename as t,urlToObject as s}from\"../../core/urlUtils.js\";import{parse as n,parseNonStandardSublayerUrl as l}from\"./arcgisLayerUrl.js\";import{fetchService as o,fetchFeatureService as u}from\"./fetchService.js\";import{layerLookupMap as y}from\"./lazyLayerLoader.js\";async function c(e){const r=e.properties?.customParameters,a=await m(e.url,r),t={...e.properties,url:e.url};if(!a.sublayerIds)return null!=a.layerOrTableId&&(t.layerId=a.layerOrTableId,t.sourceJSON=a.sourceJSON),new a.Constructor(t);const s=new(0,(await import(\"../GroupLayer.js\")).default)({title:a.parsedUrl.title});return d(s,a,t),s}function i(e,r){return e?e.find((e=>e.id===r)):null}function d(e,r,t){function s(e,s){const n={...t,layerId:e,sublayerTitleMode:\"service-name\"};return a(s)&&(n.sourceJSON=s),new r.Constructor(n)}r.sublayerIds.forEach((a=>{const t=s(a,i(r.sublayerInfos,a));e.add(t)})),r.tableIds.forEach((a=>{const t=s(a,i(r.tableInfos,a));e.tables.add(t)}))}async function m(a,t){let s=n(a);if(r(s)&&(s=await f(a,t)),r(s))throw new e(\"arcgis-layers:url-mismatch\",\"The url '${url}' is not a valid arcgis resource\",{url:a});const{serverType:l,sublayer:u}=s;let y;const c={FeatureServer:\"FeatureLayer\",StreamServer:\"StreamLayer\",VectorTileServer:\"VectorTileLayer\"};switch(l){case\"MapServer\":y=null!=u?\"FeatureLayer\":b(a,t).then((e=>e?\"TileLayer\":\"MapImageLayer\"));break;case\"ImageServer\":y=o(a,{customParameters:t}).then((e=>{const r=e.tileInfo&&e.tileInfo.format;return e.tileInfo?\"LERC\"!==r?.toUpperCase()||e.cacheType&&\"elevation\"!==e.cacheType.toLowerCase()?\"ImageryTileLayer\":\"ElevationLayer\":\"ImageryLayer\"}));break;case\"SceneServer\":y=o(s.url.path,{customParameters:t}).then((e=>{if(e){if(\"Voxel\"===e?.layerType)return\"VoxelLayer\";if(e?.layers&&Array.isArray(e.layers)&&e.layers.length>0){const r={Point:\"SceneLayer\",\"3DObject\":\"SceneLayer\",IntegratedMesh:\"IntegratedMeshLayer\",PointCloud:\"PointCloudLayer\",Building:\"BuildingSceneLayer\"},a=e.layers[0]?.layerType;if(null!=r[a])return r[a]}}return\"SceneLayer\"}));break;default:y=c[l]}const i={FeatureLayer:!0,SceneLayer:!0},d=\"FeatureServer\"===l,m={parsedUrl:s,Constructor:null,layerOrTableId:d?u:null,sublayerIds:null,tableIds:null},p=await y;if(i[p]&&null==u){const e=await I(a,l,t);d&&(m.sublayerInfos=e.layerInfos,m.tableInfos=e.tableInfos);1!==e.layerIds.length+e.tableIds.length?(m.sublayerIds=e.layerIds,m.tableIds=e.tableIds):d&&(m.layerOrTableId=e.layerIds[0]??e.tableIds[0],m.sourceJSON=e.layerInfos[0]??e.tableInfos[0])}return m.Constructor=await S(p),m}async function f(e,r){const n=await o(e,{customParameters:r});let u=null,y=null;const c=n.type;if(\"Feature Layer\"===c||\"Table\"===c?(u=\"FeatureServer\",y=n.id):\"indexedVector\"===c?u=\"VectorTileServer\":n.hasOwnProperty(\"mapName\")?u=\"MapServer\":n.hasOwnProperty(\"bandCount\")&&n.hasOwnProperty(\"pixelSizeX\")?u=\"ImageServer\":n.hasOwnProperty(\"maxRecordCount\")&&n.hasOwnProperty(\"allowGeometryUpdates\")?u=\"FeatureServer\":n.hasOwnProperty(\"streamUrls\")?u=\"StreamServer\":p(n)?(u=\"SceneServer\",y=n.id):n.hasOwnProperty(\"layers\")&&p(n.layers?.[0])&&(u=\"SceneServer\"),!u)return null;const i=null!=y?l(e):null;return{title:a(i)&&n.name||t(e),serverType:u,sublayer:y,url:{path:a(i)?i.serviceUrl:s(e).path}}}function p(e){return e?.hasOwnProperty(\"store\")&&e.hasOwnProperty(\"id\")&&\"number\"==typeof e.id}async function I(e,r,a){let t,s=!1;if(\"FeatureServer\"===r){const r=await u(e,{customParameters:a});s=!!r.layersJSON,t=r.layersJSON||r.serviceJSON}else t=await o(e,{customParameters:a});const n=t?.layers,l=t?.tables;return{layerIds:n?.map((e=>e.id)).reverse()||[],tableIds:l?.map((e=>e.id)).reverse()||[],layerInfos:s?n:[],tableInfos:s?l:[]}}async function S(e){return(0,y[e])()}async function b(e,r){return(await o(e,{customParameters:r})).tileInfo}export{c as fromUrl};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAI+W,eAAe,EAAE,GAAE;AAJlY;AAImY,QAAMA,MAAE,OAAE,eAAF,mBAAc,kBAAiBC,KAAE,MAAMC,GAAE,EAAE,KAAIF,EAAC,GAAEG,KAAE,EAAC,GAAG,EAAE,YAAW,KAAI,EAAE,IAAG;AAAE,MAAG,CAACF,GAAE;AAAY,WAAO,QAAMA,GAAE,mBAAiBE,GAAE,UAAQF,GAAE,gBAAeE,GAAE,aAAWF,GAAE,aAAY,IAAIA,GAAE,YAAYE,EAAC;AAAE,QAAMC,KAAE,KAAI,IAAG,MAAM,OAAO,6BAAqB,SAAS,EAAC,OAAMH,GAAE,UAAU,MAAK,CAAC;AAAE,SAAO,EAAEG,IAAEH,IAAEE,EAAC,GAAEC;AAAC;AAAC,SAAS,EAAE,GAAEJ,IAAE;AAAC,SAAO,IAAE,EAAE,KAAM,CAAAK,OAAGA,GAAE,OAAKL,EAAE,IAAE;AAAI;AAAC,SAAS,EAAE,GAAEA,IAAEG,IAAE;AAAC,WAASC,GAAEC,IAAED,IAAE;AAAC,UAAM,IAAE,EAAC,GAAGD,IAAE,SAAQE,IAAE,mBAAkB,eAAc;AAAE,WAAO,EAAED,EAAC,MAAI,EAAE,aAAWA,KAAG,IAAIJ,GAAE,YAAY,CAAC;AAAA,EAAC;AAAC,EAAAA,GAAE,YAAY,QAAS,CAAAC,OAAG;AAAC,UAAME,KAAEC,GAAEH,IAAE,EAAED,GAAE,eAAcC,EAAC,CAAC;AAAE,MAAE,IAAIE,EAAC;AAAA,EAAC,CAAE,GAAEH,GAAE,SAAS,QAAS,CAAAC,OAAG;AAAC,UAAME,KAAEC,GAAEH,IAAE,EAAED,GAAE,YAAWC,EAAC,CAAC;AAAE,MAAE,OAAO,IAAIE,EAAC;AAAA,EAAC,CAAE;AAAC;AAAC,eAAeD,GAAED,IAAEE,IAAE;AAJ1iC;AAI2iC,MAAIC,KAAE,EAAEH,EAAC;AAAE,MAAG,EAAEG,EAAC,MAAIA,KAAE,MAAM,EAAEH,IAAEE,EAAC,IAAG,EAAEC,EAAC;AAAE,UAAM,IAAI,EAAE,8BAA6B,mDAAkD,EAAC,KAAIH,GAAC,CAAC;AAAE,QAAK,EAAC,YAAW,GAAE,UAAS,EAAC,IAAEG;AAAE,MAAI;AAAE,QAAME,KAAE,EAAC,eAAc,gBAAe,cAAa,eAAc,kBAAiB,kBAAiB;AAAE,UAAO;AAAA,SAAO;AAAY,UAAE,QAAM,IAAE,iBAAe,EAAEL,IAAEE,EAAC,EAAE,KAAM,OAAG,IAAE,cAAY,eAAgB;AAAE;AAAA,SAAU;AAAc,UAAE,EAAEF,IAAE,EAAC,kBAAiBE,GAAC,CAAC,EAAE,KAAM,OAAG;AAAC,cAAMH,KAAE,EAAE,YAAU,EAAE,SAAS;AAAO,eAAO,EAAE,WAAS,YAASA,MAAA,gBAAAA,GAAG,kBAAe,EAAE,aAAW,gBAAc,EAAE,UAAU,YAAY,IAAE,qBAAmB,mBAAiB;AAAA,MAAc,CAAE;AAAE;AAAA,SAAU;AAAc,UAAE,EAAEI,GAAE,IAAI,MAAK,EAAC,kBAAiBD,GAAC,CAAC,EAAE,KAAM,OAAG;AAJ1uD,YAAAI;AAI2uD,YAAG,GAAE;AAAC,cAAG,aAAU,uBAAG;AAAU,mBAAM;AAAa,eAAG,uBAAG,WAAQ,MAAM,QAAQ,EAAE,MAAM,KAAG,EAAE,OAAO,SAAO,GAAE;AAAC,kBAAMP,KAAE,EAAC,OAAM,cAAa,YAAW,cAAa,gBAAe,uBAAsB,YAAW,mBAAkB,UAAS,qBAAoB,GAAEC,MAAEM,MAAA,EAAE,OAAO,OAAT,gBAAAA,IAAa;AAAU,gBAAG,QAAMP,GAAEC;AAAG,qBAAOD,GAAEC;AAAA,UAAE;AAAA,QAAC;AAAC,eAAM;AAAA,MAAY,CAAE;AAAE;AAAA;AAAc,UAAEK,GAAE;AAAA;AAAG,QAAME,KAAE,EAAC,cAAa,MAAG,YAAW,KAAE,GAAEC,KAAE,oBAAkB,GAAEP,KAAE,EAAC,WAAUE,IAAE,aAAY,MAAK,gBAAeK,KAAE,IAAE,MAAK,aAAY,MAAK,UAAS,KAAI,GAAEC,KAAE,MAAM;AAAE,MAAGF,GAAEE,OAAI,QAAM,GAAE;AAAC,UAAM,IAAE,MAAM,EAAET,IAAE,GAAEE,EAAC;AAAE,IAAAM,OAAIP,GAAE,gBAAc,EAAE,YAAWA,GAAE,aAAW,EAAE;AAAY,UAAI,EAAE,SAAS,SAAO,EAAE,SAAS,UAAQA,GAAE,cAAY,EAAE,UAASA,GAAE,WAAS,EAAE,YAAUO,OAAIP,GAAE,kBAAe,OAAE,SAAS,OAAX,YAAe,EAAE,SAAS,IAAGA,GAAE,cAAW,OAAE,WAAW,OAAb,YAAiB,EAAE,WAAW;AAAA,EAAG;AAAC,SAAOA,GAAE,cAAY,MAAM,EAAEQ,EAAC,GAAER;AAAC;AAAC,eAAe,EAAE,GAAEF,IAAE;AAJlkF;AAImkF,QAAM,IAAE,MAAM,EAAE,GAAE,EAAC,kBAAiBA,GAAC,CAAC;AAAE,MAAI,IAAE,MAAK,IAAE;AAAK,QAAMM,KAAE,EAAE;AAAK,MAAG,oBAAkBA,MAAG,YAAUA,MAAG,IAAE,iBAAgB,IAAE,EAAE,MAAI,oBAAkBA,KAAE,IAAE,qBAAmB,EAAE,eAAe,SAAS,IAAE,IAAE,cAAY,EAAE,eAAe,WAAW,KAAG,EAAE,eAAe,YAAY,IAAE,IAAE,gBAAc,EAAE,eAAe,gBAAgB,KAAG,EAAE,eAAe,sBAAsB,IAAE,IAAE,kBAAgB,EAAE,eAAe,YAAY,IAAE,IAAE,iBAAe,EAAE,CAAC,KAAG,IAAE,eAAc,IAAE,EAAE,MAAI,EAAE,eAAe,QAAQ,KAAG,GAAE,OAAE,WAAF,mBAAW,EAAE,MAAI,IAAE,gBAAe,CAAC;AAAE,WAAO;AAAK,QAAME,KAAE,QAAM,IAAE,EAAE,CAAC,IAAE;AAAK,SAAM,EAAC,OAAM,EAAEA,EAAC,KAAG,EAAE,QAAM,GAAE,CAAC,GAAE,YAAW,GAAE,UAAS,GAAE,KAAI,EAAC,MAAK,EAAEA,EAAC,IAAEA,GAAE,aAAW,EAAE,CAAC,EAAE,KAAI,EAAC;AAAC;AAAC,SAAS,EAAE,GAAE;AAAC,UAAO,uBAAG,eAAe,aAAU,EAAE,eAAe,IAAI,KAAG,YAAU,OAAO,EAAE;AAAE;AAAC,eAAe,EAAE,GAAER,IAAEC,IAAE;AAAC,MAAIE,IAAEC,KAAE;AAAG,MAAG,oBAAkBJ,IAAE;AAAC,UAAMA,KAAE,MAAMA,GAAE,GAAE,EAAC,kBAAiBC,GAAC,CAAC;AAAE,IAAAG,KAAE,CAAC,CAACJ,GAAE,YAAWG,KAAEH,GAAE,cAAYA,GAAE;AAAA,EAAW;AAAM,IAAAG,KAAE,MAAM,EAAE,GAAE,EAAC,kBAAiBF,GAAC,CAAC;AAAE,QAAM,IAAEE,MAAA,gBAAAA,GAAG,QAAO,IAAEA,MAAA,gBAAAA,GAAG;AAAO,SAAM,EAAC,WAAS,uBAAG,IAAK,CAAAE,OAAGA,GAAE,IAAK,cAAW,CAAC,GAAE,WAAS,uBAAG,IAAK,CAAAA,OAAGA,GAAE,IAAK,cAAW,CAAC,GAAE,YAAWD,KAAE,IAAE,CAAC,GAAE,YAAWA,KAAE,IAAE,CAAC,EAAC;AAAC;AAAC,eAAe,EAAE,GAAE;AAAC,UAAO,GAAEH,GAAE,IAAI;AAAC;AAAC,eAAe,EAAE,GAAED,IAAE;AAAC,UAAO,MAAM,EAAE,GAAE,EAAC,kBAAiBA,GAAC,CAAC,GAAG;AAAQ;",
  "names": ["r", "a", "m", "t", "s", "e", "c", "_a", "i", "d", "p"]
}
