import {
  h
} from "./chunk-NF6EUNPP.js";
import {
  t as t2
} from "./chunk-RQ3CU5II.js";
import {
  M,
  N,
  j,
  q,
  x,
  y
} from "./chunk-O7LTV6XN.js";
import {
  a
} from "./chunk-JP3KAUQB.js";
import {
  i
} from "./chunk-DER356EU.js";
import {
  m as m2
} from "./chunk-SHFHZMHO.js";
import {
  l
} from "./chunk-RAX2HD42.js";
import {
  L,
  S,
  m
} from "./chunk-XQN7F674.js";
import {
  r as r2
} from "./chunk-BTUHYGXO.js";
import {
  s2 as s
} from "./chunk-UA3YPL2R.js";
import {
  u
} from "./chunk-6QC7MLLS.js";
import {
  e,
  r,
  t
} from "./chunk-MIHB3CIK.js";

// node_modules/@arcgis/core/renderers/support/numberUtils.js
var n = /^-?(\d+)(\.(\d+))?$/i;
function e2(t4, n4) {
  return t4 - n4;
}
function r3(t4, n4) {
  let e4, r7;
  return e4 = Number(t4.toFixed(n4)), e4 < t4 ? r7 = e4 + 1 / 10 ** n4 : (r7 = e4, e4 -= 1 / 10 ** n4), e4 = Number(e4.toFixed(n4)), r7 = Number(r7.toFixed(n4)), [e4, r7];
}
function o(t4, n4, e4, r7, o4) {
  const i5 = l2(t4, n4, e4, r7), u5 = null == i5.previous || i5.previous <= o4, s5 = null == i5.next || i5.next <= o4;
  return u5 && s5 || i5.previous + i5.next <= 2 * o4;
}
function i2(t4) {
  const e4 = String(t4), r7 = e4.match(n);
  if (r7 && r7[1])
    return { integer: r7[1].split("").length, fractional: r7[3] ? r7[3].split("").length : 0 };
  if (e4.toLowerCase().includes("e")) {
    const t5 = e4.split("e"), n4 = t5[0], r8 = t5[1];
    if (n4 && r8) {
      const t6 = Number(n4);
      let e5 = Number(r8);
      const o4 = e5 > 0;
      o4 || (e5 = Math.abs(e5));
      const l3 = i2(t6);
      return o4 ? (l3.integer += e5, e5 > l3.fractional ? l3.fractional = 0 : l3.fractional -= e5) : (l3.fractional += e5, e5 > l3.integer ? l3.integer = 1 : l3.integer -= e5), l3;
    }
  }
  return { integer: 0, fractional: 0 };
}
function l2(t4, n4, e4, r7) {
  const o4 = { previous: null, next: null };
  if (null != e4) {
    const r8 = t4 - e4, i5 = n4 - e4 - r8;
    o4.previous = Math.floor(Math.abs(100 * i5 / r8));
  }
  if (null != r7) {
    const e5 = r7 - t4, i5 = r7 - n4 - e5;
    o4.next = Math.floor(Math.abs(100 * i5 / e5));
  }
  return o4;
}
function u2(t4, n4 = {}) {
  const l3 = t4.slice(0), { tolerance: u5 = 2, strictBounds: s5 = false, indexes: c2 = l3.map((t5, n5) => n5) } = n4;
  c2.sort(e2);
  for (let e4 = 0; e4 < c2.length; e4++) {
    const t5 = c2[e4], n5 = l3[t5], a4 = 0 === t5 ? null : l3[t5 - 1], f = t5 === l3.length - 1 ? null : l3[t5 + 1], m5 = i2(n5).fractional;
    if (m5) {
      let i5, c3 = 0, g3 = false;
      for (; c3 <= m5 && !g3; ) {
        const t6 = r3(n5, c3);
        i5 = s5 && 0 === e4 ? t6[1] : t6[0], g3 = o(n5, i5, a4, f, u5), c3++;
      }
      g3 && (l3[t5] = i5);
    }
  }
  return l3;
}
var s2 = { maximumFractionDigits: 20 };
function c(n4) {
  return m(n4, s2);
}

// node_modules/@arcgis/core/widgets/Legend/support/utils.js
var s3 = "<";
var i3 = ">";
var r4 = S("short-date");
function o2(t4, l3, o4, e4) {
  let n4 = "";
  0 === l3 ? n4 = `${s3} ` : l3 === o4 && (n4 = `${i3} `);
  let u5 = null;
  return u5 = e4 ? L(t4, r4) : c(t4), n4 + u5;
}
var e3 = ["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];
async function n2(A) {
  if (!("visualVariables" in A) || !A.visualVariables)
    return null;
  const t4 = A.visualVariables.find((A2) => "color" === A2.type);
  if (!t4)
    return null;
  let a4 = null, l3 = null;
  if (t4.stops) {
    if (1 === t4.stops.length)
      return t4.stops[0].color;
    a4 = t4.stops[0].value, l3 = t4.stops[t4.stops.length - 1].value;
  }
  const s5 = a4 + (l3 - a4) / 2, { getColor: i5 } = await import("./visualVariableUtils-VEK2HJVO.js");
  return i5(t4, s5);
}
async function u3(A, t4) {
  const a4 = A.trailCap, s5 = A.trailWidth || 1, i5 = t4 || await n2(A) || A.color;
  return new m2({ cap: a4, color: i5, width: s5 });
}

// node_modules/@arcgis/core/widgets/Legend/support/colorRampUtils.js
var o3 = new l([64, 64, 64]);
function n3(l3, o4) {
  const n4 = [], r7 = l3.length - 1;
  return 5 === l3.length ? n4.push(0, 2, 4) : n4.push(0, r7), l3.map((l4, t4) => n4.includes(t4) ? o2(l4, t4, r7, o4) : null);
}
async function r5(l3, e4, o4) {
  let r7 = false, a4 = [], u5 = [];
  if (l3.stops) {
    const e5 = l3.stops;
    a4 = e5.map((l4) => l4.value), r7 = e5.some((l4) => !!l4.label), r7 && (u5 = e5.map((l4) => l4.label));
  }
  const s5 = a4[0], i5 = a4[a4.length - 1];
  if (null == s5 && null == i5)
    return null;
  const c2 = r7 ? null : n3(a4, o4);
  return (await Promise.all(a4.map(async (o5, n4) => ({ value: o5, color: "opacity" === l3.type ? await t3(o5, l3, e4) : (await import("./visualVariableUtils-VEK2HJVO.js")).getColor(l3, o5), label: r7 ? u5[n4] : c2[n4] })))).reverse();
}
async function t3(e4, n4, r7 = o3) {
  const t4 = new l(r7), a4 = (await import("./visualVariableUtils-VEK2HJVO.js")).getOpacity(n4, e4);
  return null != a4 && (t4.a = a4), t4;
}
function a2(l3) {
  let e4 = false, o4 = [], r7 = [];
  o4 = l3.map((l4) => l4.value), e4 = l3.some((l4) => !!l4.label), e4 && (r7 = l3.map((l4) => l4.label));
  const t4 = o4[0], a4 = o4[o4.length - 1];
  if (null == t4 && null == a4)
    return null;
  const s5 = e4 ? null : n3(o4, false);
  return o4.map((o5, n4) => ({ value: o5, color: u4(o5, l3), label: e4 ? r7[n4] : s5[n4] })).reverse();
}
function u4(e4, o4) {
  const { startIndex: n4, endIndex: r7, weight: t4 } = s4(e4, o4);
  if (n4 === r7)
    return o4[n4].color;
  const a4 = l.blendColors(o4[n4].color, o4[r7].color, t4);
  return new l(a4);
}
function s4(l3, e4) {
  let o4 = 0, n4 = e4.length - 1;
  return e4.some((e5, r7) => l3 < e5.value ? (n4 = r7, true) : (o4 = r7, false)), { startIndex: o4, endIndex: n4, weight: (l3 - e4[o4].value) / (e4[n4].value - e4[o4].value) };
}
function i4(e4, o4) {
  let n4 = [];
  if (e4 && "multipart" === e4.type)
    e4.colorRamps.reverse().forEach((r7, t4) => {
      0 === t4 ? n4.push({ value: o4.max, color: new l(r7.toColor), label: "high" }) : n4.push({ value: null, color: new l(r7.toColor), label: "" }), t4 === e4.colorRamps.length - 1 ? n4.push({ value: o4.min, color: new l(r7.fromColor), label: "low" }) : n4.push({ value: null, color: new l(r7.fromColor), label: "" });
    });
  else {
    let r7, t4;
    e4 && "algorithmic" === e4.type ? (r7 = e4.fromColor, t4 = e4.toColor) : (r7 = [0, 0, 0, 1], t4 = [255, 255, 255, 1]), n4 = [{ value: o4.max, color: new l(t4), label: "high" }, { value: o4.min, color: new l(r7), label: "low" }];
  }
  return n4;
}

// node_modules/@arcgis/core/widgets/Legend/support/heatmapRampUtils.js
function r6(r7) {
  if (!r7.colorStops)
    return [];
  const e4 = [...r7.colorStops].filter((o4) => {
    var _a;
    return ((_a = o4.color) == null ? void 0 : _a.a) > 0;
  });
  let t4 = e4.length - 1;
  if (e4 && e4[0]) {
    const r8 = e4[t4];
    r8 && 1 !== r8.ratio && (e4.push(new a({ ratio: 1, color: r8.color })), t4++);
  }
  return e4.map((o4, e5) => {
    var _a, _b;
    let l3 = "";
    return 0 === e5 ? l3 = ((_a = r7.legendOptions) == null ? void 0 : _a.minLabel) || "low" : e5 === t4 && (l3 = ((_b = r7.legendOptions) == null ? void 0 : _b.maxLabel) || "high"), { color: o4.color, label: l3, ratio: o4.ratio };
  }).reverse();
}

// node_modules/@arcgis/core/symbols/support/symbolUtils.js
var y2 = null;
var p = [255, 255, 255];
function d(e4, t4) {
  return Math.floor(Math.random() * (t4 - e4 + 1) + e4);
}
function m3(e4, t4, l3) {
  const { backgroundColor: r7, outline: i5, dotSize: o4 } = e4, a4 = l3 && l3.swatchSize || t2.size, n4 = 0.8, c2 = Math.round(a4 * a4 / o4 ** 2 * n4), u5 = window.devicePixelRatio, f = document.createElement("canvas"), h3 = a4 * u5;
  f.width = h3, f.height = h3, f.style.width = f.width / u5 + "px", f.style.height = f.height / u5 + "px";
  const p2 = f.getContext("2d");
  if (r7 && (p2.fillStyle = r7.toCss(true), p2.fillRect(0, 0, h3, h3), p2.fill()), p2.fillStyle = t4.toCss(true), y2 && y2.length / 2 === c2)
    for (let s5 = 0; s5 < 2 * c2; s5 += 2) {
      const e5 = y2[s5], t5 = y2[s5 + 1];
      p2.fillRect(e5, t5, o4 * u5, o4 * u5), p2.fill();
    }
  else {
    y2 = [];
    for (let e5 = 0; e5 < 2 * c2; e5 += 2) {
      const e6 = d(0, h3), t5 = d(0, h3);
      y2.push(e6, t5), p2.fillRect(e6, t5, o4 * u5, o4 * u5), p2.fill();
    }
  }
  i5 && (i5.color && (p2.strokeStyle = i5.color.toCss(true)), p2.lineWidth = i5.width, p2.strokeRect(0, 0, h3, h3));
  const m5 = new Image(a4, a4);
  return m5.src = f.toDataURL(), m5;
}
function b(e4, t4 = {}) {
  const l3 = t4.radius || 40, r7 = 2 * Math.PI * l3, s5 = e4.length, a4 = r7 / s5, n4 = [], c2 = y(t4.outline);
  null != (c2 == null ? void 0 : c2.width) && (c2.width *= 2), (c2 || t4.backgroundColor) && n4.push({ shape: { type: "circle", cx: l3, cy: l3, r: l3 }, fill: t4.backgroundColor, stroke: c2, offset: [0, 0] });
  const u5 = t4.values, f = u5 && u5.length === s5 && 100 === u5.reduce((e5, t5) => e5 + t5, 0), h3 = [0];
  for (let i5 = 0; i5 < s5; i5++) {
    let t5 = null;
    f && (t5 = u5[i5] * r7 / 100, h3.push(t5 + h3[i5])), n4.push({ shape: { type: "circle", cx: l3, cy: l3, r: l3 / 2 }, fill: [0, 0, 0, 0], stroke: { width: l3, dashArray: `${(t5 != null ? t5 : a4) / 2} ${r7}`, dashoffset: "-" + (f ? h3[i5] / 2 : i5 * (a4 / 2)), color: e4[i5] }, offset: [0, 0] });
  }
  let y3 = null;
  const d2 = 2 * l3 + ((c2 == null ? void 0 : c2.width) || 0), m5 = t4.holePercentage;
  if (m5) {
    c2 && n4.push({ shape: { type: "circle", cx: l3, cy: l3, r: l3 * m5 }, fill: null, stroke: c2, offset: [0, 0] });
    const e5 = d2 / 2;
    y3 = [[{ shape: { type: "circle", cx: e5, cy: e5, r: e5 }, fill: p, stroke: c2 ? { ...c2, color: p } : null, offset: [0, 0] }, { shape: { type: "circle", cx: e5, cy: e5, r: l3 * m5 }, fill: [0, 0, 0], stroke: null, offset: [0, 0] }]];
  }
  return h([n4], [d2, d2], { effectView: t4.effectList, ignoreStrokeWidth: true, masking: y3, rotation: -90 });
}
function g(e4, t4 = {}) {
  const l3 = 24, r7 = 75, i5 = "horizontal" === t4.align, s5 = i5 ? r7 : l3, o4 = i5 ? l3 : r7, { width: a4 = s5, height: n4 = o4, gradient: c2 = true } = t4, u5 = window.devicePixelRatio, f = a4 * u5, h3 = n4 * u5, y3 = document.createElement("canvas");
  y3.width = f, y3.height = h3, y3.style.width = `${a4}px`, y3.style.height = `${n4}px`;
  const p2 = y3.getContext("2d"), d2 = i5 ? f : 0, m5 = i5 ? 0 : h3;
  if (c2) {
    const t5 = p2.createLinearGradient(0, 0, d2, m5), l4 = e4.length, r8 = 1 === l4 ? 0 : 1 / (l4 - 1);
    e4.forEach((e5, l5) => t5.addColorStop(l5 * r8, e5.toString())), p2.fillStyle = t5, p2.fillRect(0, 0, f, h3);
  } else {
    const t5 = i5 ? f / e4.length : f, l4 = i5 ? h3 : h3 / e4.length;
    let r8 = 0, s6 = 0;
    for (const o5 of e4)
      p2.fillStyle = o5.toString(), p2.fillRect(r8, s6, t5, l4), r8 = i5 ? r8 + t5 : 0, s6 = i5 ? 0 : s6 + l4;
  }
  const b3 = document.createElement("div");
  return b3.style.width = `${a4}px`, b3.style.height = `${n4}px`, w(b3, t4 == null ? void 0 : t4.effectList), b3.appendChild(y3), b3;
}
function w(e4, t4) {
  if (!t4)
    return;
  e4.style.filter = q(t4);
  const l3 = t4.effects;
  if (l3) {
    for (const r7 of l3)
      if ("drop-shadow" === (r7 == null ? void 0 : r7.type)) {
        r7.offsetX < 0 ? e4.style.marginLeft = `${Math.abs(r7.offsetX)}px` : e4.style.marginRight = `${r7.offsetX}px`;
        break;
      }
  }
}
async function S2(e4, t4) {
  switch (e4.type) {
    case "web-style": {
      const { previewWebStyleSymbol: l3 } = await import("./previewWebStyleSymbol-O75YBQUL.js");
      return l3(e4, S2, t4);
    }
    case "label-3d":
    case "line-3d":
    case "mesh-3d":
    case "point-3d":
    case "polygon-3d": {
      const { previewSymbol3D: l3 } = await import("./previewSymbol3D-JPRDJHKH.js");
      return l3(e4, t4);
    }
    case "simple-marker":
    case "simple-line":
    case "simple-fill":
    case "picture-marker":
    case "picture-fill":
    case "text": {
      const { previewSymbol2D: l3 } = await import("./previewSymbol2D-PB46PQLH.js");
      return l3(e4, t4);
    }
    case "cim": {
      const { previewCIMSymbol: l3 } = await import("./previewCIMSymbol-PKHWCVKY.js");
      return l3(e4, t4);
    }
    default:
      return;
  }
}
function v(e4) {
  return e4 && "opacity" in e4 ? e4.opacity * v(e4.parent) : 1;
}
async function x2(i5, s5) {
  var _a, _b;
  if (!i5)
    return;
  const o4 = i5.sourceLayer, a4 = (_a = r(s5) && s5.useSourceLayer ? o4 : i5.layer) != null ? _a : o4, f = v(a4);
  if (r(i5.symbol) && (!r(s5) || true !== s5.ignoreGraphicSymbol)) {
    const t4 = "web-style" === i5.symbol.type ? await i5.symbol.fetchSymbol({ ...s5, cache: r(s5) ? s5.webStyleCache : null }) : i5.symbol.clone();
    return x(t4, null, f), t4;
  }
  const h3 = (_b = r(s5) ? s5.renderer : null) != null ? _b : a4 && "renderer" in a4 ? a4.renderer : null;
  let y3 = h3 && "getSymbolAsync" in h3 ? await h3.getSymbolAsync(i5, s5) : null;
  if (!y3)
    return;
  if (y3 = "web-style" === y3.type ? await y3.fetchSymbol({ ...s5, cache: r(s5) ? s5.webStyleCache : null }) : y3.clone(), !(h3 && "visualVariables" in h3 && h3.visualVariables && h3.visualVariables.length))
    return x(y3, null, f), y3;
  if ("arcadeRequiredForVisualVariables" in h3 && h3.arcadeRequiredForVisualVariables && (t(s5) || t(s5.arcade))) {
    const e4 = { ...e(s5) };
    e4.arcade = await i(), s5 = e4;
  }
  const p2 = await import("./visualVariableUtils-VEK2HJVO.js"), d2 = [], m5 = [], b3 = [], g3 = [];
  for (const e4 of h3.visualVariables)
    switch (e4.type) {
      case "color":
        d2.push(e4);
        break;
      case "opacity":
        m5.push(e4);
        break;
      case "rotation":
        g3.push(e4);
        break;
      case "size":
        e4.target || b3.push(e4);
    }
  const w2 = !!d2.length && d2[d2.length - 1], S3 = w2 ? p2.getColor(w2, i5, s5) : null, x3 = !!m5.length && m5[m5.length - 1];
  let V = x3 ? p2.getOpacity(x3, i5, s5) : null;
  if (null != f && (V = null != V ? V * f : f), x(y3, S3, V), b3.length) {
    const e4 = p2.getAllSizes(b3, i5, s5);
    await M(y3, e4);
  }
  for (const e4 of g3)
    N(y3, p2.getRotationAngle(e4, i5, s5), e4.axis);
  return y3;
}

// node_modules/@arcgis/core/renderers/support/utils.js
var m4 = s.getLogger("esri.renderers.support.utils");
var g2 = S("short-date");
async function h2(e4, t4, i5) {
  r2(e4, t4, () => []).push(...i5);
}
async function b2(t4) {
  var _a, _b, _c, _d;
  const l3 = /* @__PURE__ */ new Map();
  if (!t4)
    return l3;
  if ("visualVariables" in t4 && t4.visualVariables) {
    const e4 = t4.visualVariables.filter((e5) => "color" === e5.type);
    for (const t5 of e4) {
      const e5 = (await r5(t5)).map((e6) => e6.color);
      await h2(l3, t5.field || t5.valueExpression, e5);
    }
  }
  if ("heatmap" === t4.type) {
    const e4 = r6(t4).map((e5) => e5.color);
    await h2(l3, t4.field || t4.valueExpression, e4);
  } else if ("pie-chart" === t4.type) {
    for (const e4 of t4.attributes)
      await h2(l3, e4.field || e4.valueExpression, [e4.color]);
    await h2(l3, "default", [(_a = t4 == null ? void 0 : t4.othersCategory) == null ? void 0 : _a.color, j(t4.backgroundFillSymbol, null)]);
  } else if ("dot-density" === t4.type) {
    for (const e4 of t4.attributes)
      await h2(l3, e4.field || e4.valueExpression, [e4.color]);
    await h2(l3, "default", [t4.backgroundColor]);
  } else if ("unique-value" === t4.type)
    if ("predominance" === ((_b = t4.authoringInfo) == null ? void 0 : _b.type))
      for (const e4 of (_c = t4.uniqueValueInfos) != null ? _c : [])
        await h2(l3, e4.value.toString(), [j(e4.symbol, null)]);
    else {
      const e4 = ((_d = t4.uniqueValueInfos) != null ? _d : []).map((e5) => j(e5.symbol, null)), { field: i5, field2: o4, field3: n4, valueExpression: a4 } = t4;
      (i5 || a4) && await h2(l3, i5 || a4, e4), o4 && await h2(l3, o4, e4), n4 && await h2(l3, n4, e4);
    }
  else if ("class-breaks" === t4.type) {
    const e4 = t4.classBreakInfos.map((e5) => j(e5.symbol, null)), { field: i5, valueExpression: o4 } = t4;
    await h2(l3, i5 != null ? i5 : o4, e4);
  } else
    "simple" === t4.type && await h2(l3, "default", [j(t4.symbol, null)]);
  return "defaultSymbol" in t4 && t4.defaultSymbol && await h2(l3, "default", [j(t4.defaultSymbol, null)]), l3.forEach((t5, i5) => {
    const o4 = u(t5.filter(Boolean), (e4, t6) => JSON.stringify(e4) === JSON.stringify(t6));
    l3.set(i5, o4);
  }), l3;
}

export {
  i2 as i,
  l2 as l,
  u2 as u,
  s3 as s,
  i3 as i2,
  o2 as o,
  e3 as e,
  n2 as n,
  u3 as u2,
  r5 as r,
  a2 as a,
  u4 as u3,
  i4 as i3,
  r6 as r2,
  b2 as b,
  m3 as m,
  b as b2,
  g,
  S2 as S,
  x2 as x
};
//# sourceMappingURL=chunk-SI2PF7MG.js.map
