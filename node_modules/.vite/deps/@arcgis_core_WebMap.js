import {
  b
} from "./chunk-LYH4KRKH.js";
import "./chunk-XFAJKRMY.js";
import {
  r as r4
} from "./chunk-4BIBXEQB.js";
import {
  i as i5
} from "./chunk-LX2NI53X.js";
import "./chunk-IZUZZJS7.js";
import {
  c,
  f,
  i as i3,
  s as s4
} from "./chunk-BWNO4YZY.js";
import {
  a as a2,
  n as n3
} from "./chunk-G34PZCB3.js";
import {
  L,
  m as m4
} from "./chunk-XWL2KVTH.js";
import "./chunk-TM6KXMYT.js";
import "./chunk-APU7GFNJ.js";
import "./chunk-E4KPV765.js";
import "./chunk-DUCSW4OU.js";
import "./chunk-WVDA5Z37.js";
import {
  S as S2,
  h,
  v as v2
} from "./chunk-K3N3RUKL.js";
import "./chunk-3KEVP6XQ.js";
import {
  y as y3
} from "./chunk-745B43YA.js";
import {
  n as n2
} from "./chunk-CN5IW2C7.js";
import {
  l as l2,
  o as o3
} from "./chunk-RLIJP6DT.js";
import "./chunk-FFVIDMFN.js";
import {
  b as b2
} from "./chunk-Z2QOAKIG.js";
import {
  u
} from "./chunk-VQXS4XNR.js";
import "./chunk-ZN2ROKCE.js";
import "./chunk-53VWTVL2.js";
import "./chunk-6CR2FXC5.js";
import "./chunk-VYG3YGZX.js";
import "./chunk-65SMURZR.js";
import "./chunk-VGNX3TFX.js";
import "./chunk-TZTENXCS.js";
import "./chunk-RQPDRERN.js";
import "./chunk-MBLYC2KR.js";
import "./chunk-XGEPEYGB.js";
import "./chunk-6BYMCM5A.js";
import "./chunk-BR5PSTJI.js";
import "./chunk-2T7LFOXQ.js";
import "./chunk-NCONZRBI.js";
import "./chunk-76CXRT5P.js";
import "./chunk-LZKCWJVH.js";
import "./chunk-7Q5M7ANT.js";
import "./chunk-LPRQBCQL.js";
import {
  l as l3
} from "./chunk-QR4K7IDQ.js";
import "./chunk-7N45W3EA.js";
import "./chunk-MQVQXXLV.js";
import "./chunk-YTOF4Z6B.js";
import "./chunk-HAVCYBU2.js";
import "./chunk-4HXPP4EA.js";
import "./chunk-M3NPSHCI.js";
import "./chunk-SBKKCBDN.js";
import "./chunk-MLVV3H5S.js";
import "./chunk-A4HIS5ZJ.js";
import "./chunk-AMLHWG76.js";
import "./chunk-OFQYIOO7.js";
import "./chunk-ZJZBAYFU.js";
import "./chunk-G3HEFWHV.js";
import "./chunk-3GENFQBG.js";
import "./chunk-FX6IXM55.js";
import {
  O,
  S
} from "./chunk-QFFP6A5Q.js";
import "./chunk-O5PXWHV2.js";
import {
  j as j5
} from "./chunk-J5VTDQTQ.js";
import "./chunk-YF2CRSQX.js";
import "./chunk-JP3KAUQB.js";
import "./chunk-INL7BDTP.js";
import "./chunk-PDEVQZ7U.js";
import "./chunk-7XXQ7762.js";
import "./chunk-DVGM5RQS.js";
import "./chunk-R6OA44DQ.js";
import "./chunk-QTYVDCOW.js";
import "./chunk-YGVY4EIZ.js";
import "./chunk-HSDU7DIL.js";
import "./chunk-FWRLW4G5.js";
import "./chunk-JNNRJ7GQ.js";
import "./chunk-E52E6T7N.js";
import "./chunk-UK3I5WXR.js";
import "./chunk-GLGOVVCK.js";
import {
  i as i2
} from "./chunk-BUVDI6S7.js";
import "./chunk-6Z6ZAVRA.js";
import "./chunk-PK4W65H4.js";
import "./chunk-GY2AJLN6.js";
import "./chunk-W62B63EU.js";
import "./chunk-N43PI2UO.js";
import "./chunk-O6VYMEIX.js";
import "./chunk-NDQ5FHGV.js";
import "./chunk-HUQX7WZO.js";
import {
  x
} from "./chunk-BYSA56OH.js";
import "./chunk-ZWUEORSX.js";
import {
  T as T2
} from "./chunk-US2IWMHE.js";
import "./chunk-ZL4T4NIV.js";
import "./chunk-NAKEKTIK.js";
import "./chunk-QWNKYSI4.js";
import "./chunk-FMJZBZWF.js";
import "./chunk-GOYVJTGW.js";
import "./chunk-ZPYDYUP5.js";
import "./chunk-TDV3ZXCQ.js";
import "./chunk-XJCUKRCO.js";
import "./chunk-SOEQPPQP.js";
import "./chunk-22F6X66Z.js";
import "./chunk-AIDV7EKX.js";
import "./chunk-FZQZIM7U.js";
import "./chunk-YM6PUX7G.js";
import "./chunk-QEYOWTXD.js";
import "./chunk-CZBRZ6SU.js";
import "./chunk-KDO6J2FO.js";
import "./chunk-RT3T2K4S.js";
import "./chunk-WJCI2CGX.js";
import "./chunk-REIQNAQW.js";
import "./chunk-J6LQZWZI.js";
import "./chunk-OD3FDQCI.js";
import "./chunk-J2PJNRU7.js";
import "./chunk-56SPM3WK.js";
import "./chunk-XMZAPOBR.js";
import "./chunk-BLJKKR5D.js";
import "./chunk-ZGNCYHMZ.js";
import "./chunk-X2S4RQJ4.js";
import "./chunk-FUPLN7UM.js";
import "./chunk-376OPXM4.js";
import "./chunk-DER356EU.js";
import "./chunk-MZIWIEIR.js";
import "./chunk-TQEOEDAZ.js";
import "./chunk-SHFHZMHO.js";
import "./chunk-NRP45AHD.js";
import "./chunk-IWQ7452U.js";
import {
  r as r3
} from "./chunk-NAN5J6QS.js";
import "./chunk-B4DKBAM3.js";
import "./chunk-6M2AHKYV.js";
import {
  j as j6
} from "./chunk-SZIJNKCV.js";
import {
  m as m3
} from "./chunk-6O43OEU5.js";
import "./chunk-J2K7ZDSV.js";
import "./chunk-2UML3WQZ.js";
import {
  i as i4
} from "./chunk-KXVMEIWT.js";
import {
  j as j4
} from "./chunk-UDND2Z3V.js";
import "./chunk-23Y3DIC6.js";
import "./chunk-JUVQV3R3.js";
import "./chunk-RAX2HD42.js";
import "./chunk-ZYRIJWLX.js";
import "./chunk-C5H57NTD.js";
import "./chunk-3LR5O4WA.js";
import "./chunk-GDVNKPJ7.js";
import "./chunk-D4V6J5BT.js";
import "./chunk-OSHI574D.js";
import {
  i
} from "./chunk-YWAQYJRC.js";
import "./chunk-B356PXLT.js";
import {
  v
} from "./chunk-EHPBHJYZ.js";
import "./chunk-3MNMDUQZ.js";
import {
  R,
  j
} from "./chunk-UWG37XSU.js";
import {
  E as E2,
  k2 as k
} from "./chunk-LNZAOBFW.js";
import "./chunk-PF5I4XZQ.js";
import {
  r as r2
} from "./chunk-HLM6QCL2.js";
import {
  o as o2
} from "./chunk-RXYULINL.js";
import {
  j as j3
} from "./chunk-5NXILPDI.js";
import "./chunk-THVR7IAM.js";
import {
  m as m2
} from "./chunk-ZWJJTUFL.js";
import "./chunk-XQN7F674.js";
import "./chunk-DMI7A7TC.js";
import {
  a2 as a
} from "./chunk-ZHAW7FZS.js";
import {
  St,
  X,
  j as j2,
  nt
} from "./chunk-KAN4HXCG.js";
import "./chunk-4FEGON7M.js";
import "./chunk-VWYWOOPX.js";
import {
  s as s3
} from "./chunk-M5VHU5LK.js";
import "./chunk-CXFRNDG4.js";
import {
  d,
  l
} from "./chunk-7QMMKGW4.js";
import {
  e as e2,
  m,
  n2 as n,
  y as y2
} from "./chunk-OOLCFNXJ.js";
import "./chunk-6KZ2LTDA.js";
import "./chunk-U2XHEJM7.js";
import {
  E
} from "./chunk-MJXQTGI2.js";
import {
  s as s2
} from "./chunk-LIZHLHNA.js";
import {
  T
} from "./chunk-BTUHYGXO.js";
import {
  s2 as s
} from "./chunk-UA3YPL2R.js";
import {
  o,
  y
} from "./chunk-HVKDYDPP.js";
import "./chunk-6QC7MLLS.js";
import {
  e,
  r
} from "./chunk-MIHB3CIK.js";
import "./chunk-OL3AADLO.js";

// node_modules/@arcgis/core/layers/support/FacilityLayerInfo.js
var s5 = class extends l {
  constructor(r5) {
    super(r5), this.facilityIdField = null, this.layerId = null, this.nameField = null, this.siteIdField = null, this.sublayerId = null;
  }
};
e2([y2({ type: String, json: { write: true } })], s5.prototype, "facilityIdField", void 0), e2([y2({ type: String, json: { write: true } })], s5.prototype, "layerId", void 0), e2([y2({ type: String, json: { write: true } })], s5.prototype, "nameField", void 0), e2([y2({ type: String, json: { write: true } })], s5.prototype, "siteIdField", void 0), e2([y2({ type: Number, json: { read: { source: "subLayerId" }, write: { target: "subLayerId" }, origins: { "web-scene": { read: false, write: false } } } })], s5.prototype, "sublayerId", void 0), s5 = e2([n("esri.layers.support.FacilityLayerInfo")], s5);
var i6 = s5;

// node_modules/@arcgis/core/layers/support/LevelLayerInfo.js
var i7 = class extends l {
  constructor(e4) {
    super(e4), this.facilityIdField = null, this.layerId = null, this.levelIdField = null, this.levelNumberField = null, this.longNameField = null, this.shortNameField = null, this.sublayerId = null, this.verticalOrderField = null;
  }
};
e2([y2({ type: String, json: { write: true } })], i7.prototype, "facilityIdField", void 0), e2([y2({ type: String, json: { write: true } })], i7.prototype, "layerId", void 0), e2([y2({ type: String, json: { write: true } })], i7.prototype, "levelIdField", void 0), e2([y2({ type: String, json: { write: true } })], i7.prototype, "levelNumberField", void 0), e2([y2({ type: String, json: { write: true } })], i7.prototype, "longNameField", void 0), e2([y2({ type: String, json: { write: true } })], i7.prototype, "shortNameField", void 0), e2([y2({ type: Number, json: { read: { source: "subLayerId" }, write: { target: "subLayerId" }, origins: { "web-scene": { read: false, write: false } } } })], i7.prototype, "sublayerId", void 0), e2([y2({ type: String, json: { write: true } })], i7.prototype, "verticalOrderField", void 0), i7 = e2([n("esri.layers.support.LevelLayerInfo")], i7);
var s6 = i7;

// node_modules/@arcgis/core/layers/support/SiteLayerInfo.js
var s7 = class extends l {
  constructor(r5) {
    super(r5), this.layerId = null, this.nameField = null, this.siteIdField = null, this.sublayerId = null;
  }
};
e2([y2({ type: String, json: { write: true } })], s7.prototype, "layerId", void 0), e2([y2({ type: String, json: { write: true } })], s7.prototype, "nameField", void 0), e2([y2({ type: String, json: { write: true } })], s7.prototype, "siteIdField", void 0), e2([y2({ type: Number, json: { read: { source: "subLayerId" }, write: { target: "subLayerId" }, origins: { "web-scene": { read: false, write: false } } } })], s7.prototype, "sublayerId", void 0), s7 = e2([n("esri.layers.support.SiteLayerInfo")], s7);
var i8 = s7;

// node_modules/@arcgis/core/support/MapFloorInfo.js
var a3 = class extends l {
  constructor(r5) {
    super(r5), this.levelLayer = null, this.facilityLayer = null, this.siteLayer = null;
  }
};
e2([y2({ type: s6, json: { write: true } })], a3.prototype, "levelLayer", void 0), e2([y2({ type: i6, json: { write: true } })], a3.prototype, "facilityLayer", void 0), e2([y2({ type: i8, json: { write: true } })], a3.prototype, "siteLayer", void 0), a3 = e2([n("esri.support.MapFloorInfo")], a3);
var l4 = a3;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/ExpressionInfo.js
var p = class extends i4(l) {
  constructor(r5) {
    super(r5), this.expression = null, this.returnType = "string", this.title = null;
  }
};
e2([y2({ type: String, json: { write: { isRequired: true } } })], p.prototype, "expression", void 0), e2([y2({ type: ["number", "string"], json: { write: true } })], p.prototype, "returnType", void 0), e2([y2({ type: String, json: { write: true } })], p.prototype, "title", void 0), p = e2([n("esri.webdoc.geotriggersInfo.ExpressionInfo")], p);
var i9 = p;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/DeviceLocationFeed.js
var c2 = new s3({ deviceLocation: "device-location" });
var a4 = class extends i4(l) {
  constructor(o6) {
    super(o6), this.filterExpression = null, this.type = "device-location";
  }
};
e2([y2({ type: i9, json: { write: true } })], a4.prototype, "filterExpression", void 0), e2([y2({ type: c2.apiValues, readOnly: true, json: { type: c2.jsonValues, read: c2.read, write: c2.write } })], a4.prototype, "type", void 0), a4 = e2([n("esri.webdoc.geotriggersInfo.DeviceLocationFeed")], a4);
var n4 = a4;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureFilter.js
var c3 = class extends i4(l) {
  constructor(r5) {
    super(r5), this.geometry = null, this.where = null;
  }
};
e2([y2({ types: i, json: { read: v, write: true } })], c3.prototype, "geometry", void 0), e2([y2({ type: String, json: { write: true } })], c3.prototype, "where", void 0), c3 = e2([n("esri.webdoc.geotriggersInfo.FeatureFilter")], c3);
var m5 = c3;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureLayerSource.js
var p2 = class extends i4(l) {
  constructor(r5) {
    super(r5), this.layerId = null, this.layerUrl = null, this.type = "feature-layer";
  }
};
e2([y2({ type: String, json: { write: { overridePolicy() {
  return { isRequired: null === this.layerUrl };
} } } })], p2.prototype, "layerId", void 0), e2([y2({ type: String, json: { write: { overridePolicy() {
  return { isRequired: null === this.layerId };
} } } })], p2.prototype, "layerUrl", void 0), e2([r3({ featureLayer: "feature-layer" }, { readOnly: true })], p2.prototype, "type", void 0), p2 = e2([n("esri.webdoc.geotriggersInfo.FeatureLayerSource")], p2);
var a5 = p2;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureFenceParameters.js
var a6 = class extends i4(l) {
  constructor(r5) {
    super(r5), this.fenceSource = null, this.filter = null, this.bufferDistance = null, this.type = "features";
  }
};
e2([y2({ type: a5, json: { write: { isRequired: true } } })], a6.prototype, "fenceSource", void 0), e2([y2({ type: m5, json: { write: true } })], a6.prototype, "filter", void 0), e2([y2({ type: Number, json: { write: true } })], a6.prototype, "bufferDistance", void 0), e2([r3({ features: "features" }, { readOnly: true })], a6.prototype, "type", void 0), a6 = e2([n("esri.webdoc.geotriggersInfo.FeatureFenceParameters")], a6);
var u2 = a6;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/Geotrigger.js
var c4 = class extends i4(l) {
  constructor(r5) {
    super(r5), this.type = "fence";
  }
};
e2([r3({ fence: "fence" }, { readOnly: true })], c4.prototype, "type", void 0), c4 = e2([n("esri.webdoc.geotriggersInfo.Geotrigger")], c4);
var p3 = c4;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/GeotriggerNotificationOptions.js
var i10 = class extends i4(l) {
  constructor(o6) {
    super(o6), this.expressionInfo = null, this.requestedActions = null;
  }
};
e2([y2({ type: i9, json: { write: true } })], i10.prototype, "expressionInfo", void 0), e2([y2({ type: [String], json: { write: true } })], i10.prototype, "requestedActions", void 0), i10 = e2([n("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")], i10);
var c5 = i10;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/support/typeUtils.js
var t = new s3({ enterContainsAndExitDoesNotContain: "enter-contains-and-exit-does-not-contain", enterContainsAndExitDoesNotIntersect: "enter-contains-and-exit-does-not-intersect", enterIntersectsAndExitDoesNotIntersect: "enter-intersects-and-exit-does-not-intersect" });
var n5 = new s3({ useGeometry: "use-geometry", useGeometryWithAccuracy: "use-geometry-with-accuracy" });
var o4 = new s3({ enter: "enter", enterOrExit: "enter-or-exit", exit: "exit" });

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FenceGeotrigger.js
var d2 = class extends p3 {
  constructor(e4) {
    super(e4), this.enterExitRule = "enter-contains-and-exit-does-not-intersect", this.feed = null, this.feedAccuracyMode = "use-geometry", this.fenceNotificationRule = null, this.fenceParameters = null, this.name = null, this.notificationOptions = null, this.type = "fence";
  }
};
e2([r3(t)], d2.prototype, "enterExitRule", void 0), e2([y2({ type: n4, json: { write: { isRequired: true } } })], d2.prototype, "feed", void 0), e2([r3(n5)], d2.prototype, "feedAccuracyMode", void 0), e2([y2({ type: o4.apiValues, json: { type: o4.jsonValues, read: o4.read, write: { writer: o4.write, isRequired: true } } })], d2.prototype, "fenceNotificationRule", void 0), e2([y2({ type: u2, json: { write: { isRequired: true } } })], d2.prototype, "fenceParameters", void 0), e2([y2({ type: String, json: { write: true } })], d2.prototype, "name", void 0), e2([y2({ type: c5, json: { write: true } })], d2.prototype, "notificationOptions", void 0), e2([r3({ fence: "fence" }, { readOnly: true })], d2.prototype, "type", void 0), d2 = e2([n("esri.webdoc.geotriggersInfo.FenceGeotrigger")], d2);
var f2 = d2;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/support/geotriggerTypes.js
var o5 = { base: p3, key: "type", typeMap: { fence: f2 } };

// node_modules/@arcgis/core/webdoc/GeotriggersInfo.js
var c6 = class extends i4(l) {
  constructor(r5) {
    super(r5), this.geotriggers = null;
  }
};
e2([y2({ types: [o5], json: { write: { isRequired: true } } })], c6.prototype, "geotriggers", void 0), c6 = e2([n("esri.webdoc.GeotriggersInfo")], c6);
var i11 = c6;

// node_modules/@arcgis/core/webdoc/RangeInfo.js
var s8;
var a7 = s8 = class extends l {
  constructor(e4) {
    super(e4), this.activeRange = null, this.currentRangeExtent = null, this.fullRangeExtent = null;
  }
  clone() {
    return new s8(y({ activeRange: this.activeRange, currentRangeExtent: this.currentRangeExtent, fullRangeExtent: this.fullRangeExtent }));
  }
};
e2([y2({ type: String, nonNullable: true, json: { read: { source: "activeRangeName" }, write: { target: "activeRangeName", isRequired: true } } })], a7.prototype, "activeRange", void 0), e2([y2({ type: [Number], json: { write: true } })], a7.prototype, "currentRangeExtent", void 0), e2([y2({ type: [Number], json: { write: true } })], a7.prototype, "fullRangeExtent", void 0), a7 = s8 = e2([n("esri.webdoc.RangeInfo")], a7);
var c7 = a7;

// node_modules/@arcgis/core/webdoc/widgets/FloorFilter.js
var s9;
var n6 = s9 = class extends l {
  constructor(e4) {
    super(e4), this.enabled = false, this.longNames = false, this.minimized = false, this.pinnedLevels = false, this.site = null, this.facility = null, this.level = null;
  }
  clone() {
    return new s9(y({ enabled: this.enabled, longNames: this.longNames, minimized: this.minimized, pinnedLevels: this.pinnedLevels, site: this.site, facility: this.facility, level: this.level }));
  }
};
e2([y2({ type: Boolean, json: { read: { source: "enabled" }, write: { target: "enabled" } } })], n6.prototype, "enabled", void 0), e2([y2({ type: Boolean, json: { read: { source: "longNames" }, write: { target: "longNames" } } })], n6.prototype, "longNames", void 0), e2([y2({ type: Boolean, json: { read: { source: "minimized" }, write: { target: "minimized" } } })], n6.prototype, "minimized", void 0), e2([y2({ type: Boolean, json: { read: { source: "pinnedLevels" }, write: { target: "pinnedLevels" } } })], n6.prototype, "pinnedLevels", void 0), e2([y2({ type: String, json: { read: { source: "site" }, write: { target: "site" } } })], n6.prototype, "site", void 0), e2([y2({ type: String, json: { read: { source: "facility" }, write: { target: "facility" } } })], n6.prototype, "facility", void 0), e2([y2({ type: String, json: { read: { source: "level" }, write: { target: "level" } } })], n6.prototype, "level", void 0), n6 = s9 = e2([n("esri.webdoc.widgets.FloorFilter")], n6);
var l5 = n6;

// node_modules/@arcgis/core/webdoc/widgets/Range.js
var i12;
var n7 = new s3({ slider: "slider", picker: "picker" });
var p4 = i12 = class extends l {
  constructor(e4) {
    super(e4), this.interactionMode = null, this.numStops = null, this.stopInterval = null;
  }
  clone() {
    return new i12({ interactionMode: this.interactionMode, numStops: this.numStops, stopInterval: this.stopInterval });
  }
};
e2([y2({ type: n7.apiValues, nonNullable: true, json: { type: n7.jsonValues, default: null, read: { reader: n7.read }, write: { isRequired: true, writer: n7.write } } })], p4.prototype, "interactionMode", void 0), e2([y2({ type: Number, json: { read: { source: "numberOfStops" }, write: { target: "numberOfStops", overridePolicy() {
  const e4 = null != this.stopInterval;
  return { enabled: !e4, isRequired: !e4 };
} } } })], p4.prototype, "numStops", void 0), e2([y2({ type: Number, json: { write: { overridePolicy() {
  return { isRequired: null == this.numStops };
} } } })], p4.prototype, "stopInterval", void 0), p4 = i12 = e2([n("esri.webdoc.widgets.Range")], p4);
var u3 = p4;

// node_modules/@arcgis/core/webdoc/widgets/TimeSlider.js
var a8;
var c8 = a8 = class extends l {
  constructor(t3) {
    super(t3), this.currentTimeExtent = null, this.fullTimeExtent = null, this.loop = false, this.numStops = null, this.numThumbs = null, this.stopDelay = null, this.stopInterval = null, this.stops = null;
  }
  readCurrentTimeExtent(t3) {
    if (!t3)
      return;
    const r5 = null != t3[0] ? new Date(t3[0]) : null, o6 = null != t3[1] ? new Date(t3[1]) : null;
    return new T2({ start: r5, end: o6 });
  }
  writeCurrentTimeExtent(t3, e4, r5) {
    t3 && o(r5, [r(t3.start) ? t3.start.getTime() : null, r(t3.end) ? t3.end.getTime() : null], e4);
  }
  readFullTimeExtent(t3, r5) {
    const o6 = r5.properties;
    if (!o6)
      return;
    const s11 = null != o6.endTime ? new Date(o6.endTime) : null, n10 = null != o6.startTime ? new Date(o6.startTime) : null;
    return new T2({ start: n10, end: s11 });
  }
  writeFullTimeExtent(t3, e4) {
    if (!t3)
      return;
    const r5 = e4.properties = e4.properties || {}, o6 = t3.end, s11 = t3.start;
    o6 && (r5.endTime = r(o6) ? o6.getTime() : null), s11 && (r5.startTime = r(s11) ? s11.getTime() : null);
  }
  readStopInterval(t3, e4, o6) {
    return t3 ? l3.fromJSON({ value: t3.interval, unit: t3.units }, o6) : null;
  }
  writeStopInterval(t3, e4, r5, o6) {
    if (!t3)
      return;
    const s11 = t3.toJSON(o6);
    o(r5, { interval: s11.value, units: s11.unit }, e4);
  }
  readStops(t3) {
    return t3 && t3.length ? t3.map((t4) => new Date(t4)) : null;
  }
  writeStops(t3, e4, r5) {
    t3 && t3.length && o(r5, t3.map((t4) => t4.getTime()), e4);
  }
  clone() {
    return new a8(y({ currentTimeExtent: this.currentTimeExtent, fullTimeExtent: this.fullTimeExtent, loop: this.loop, numStops: this.numStops, numThumbs: this.numThumbs, stopDelay: this.stopDelay, stopInterval: this.stopInterval, stops: this.stops }));
  }
};
e2([y2({ type: T2, json: { read: { source: "properties.currentTimeExtent" }, write: { target: "properties.currentTimeExtent" } } })], c8.prototype, "currentTimeExtent", void 0), e2([o2("currentTimeExtent")], c8.prototype, "readCurrentTimeExtent", null), e2([r2("currentTimeExtent")], c8.prototype, "writeCurrentTimeExtent", null), e2([y2({ type: T2, json: { read: { source: ["properties.endTime", "properties.startTime"] }, write: { target: { "properties.endTime": { type: Number }, "properties.startTime": { type: Number } } } } })], c8.prototype, "fullTimeExtent", void 0), e2([o2("fullTimeExtent")], c8.prototype, "readFullTimeExtent", null), e2([r2("fullTimeExtent")], c8.prototype, "writeFullTimeExtent", null), e2([y2({ type: Boolean, nonNullable: true, json: { default: false, read: { source: "properties.loop" }, write: { target: "properties.loop" } } })], c8.prototype, "loop", void 0), e2([y2({ type: Number, json: { read: { source: "properties.numberOfStops" }, write: { target: "properties.numberOfStops", overridePolicy() {
  var _a;
  const t3 = !!this.stopInterval, e4 = !!((_a = this.stops) == null ? void 0 : _a.length), r5 = !(t3 || e4);
  return { enabled: r5, isRequired: r5 };
} } } })], c8.prototype, "numStops", void 0), e2([y2({ type: [1, 2], nonNullable: true, json: { read: { source: "properties.thumbCount" }, write: { target: "properties.thumbCount", isRequired: true } } })], c8.prototype, "numThumbs", void 0), e2([y2({ type: Number, nonNullable: true, json: { read: { source: "properties.thumbMovingRate" }, write: { target: "properties.thumbMovingRate", isRequired: true } } })], c8.prototype, "stopDelay", void 0), e2([y2({ type: l3, json: { read: { source: "properties.timeStopInterval" }, write: { target: "properties.timeStopInterval", overridePolicy() {
  var _a;
  const t3 = null != this.numStops, e4 = !!((_a = this.stops) == null ? void 0 : _a.length);
  return { enabled: !e4, isRequired: !(t3 || e4) };
} } } })], c8.prototype, "stopInterval", void 0), e2([o2("stopInterval")], c8.prototype, "readStopInterval", null), e2([r2("stopInterval")], c8.prototype, "writeStopInterval", null), e2([y2({ type: [Date], json: { read: { source: "properties.stops" }, write: { target: "properties.stops", overridePolicy() {
  return { isRequired: null == this.numStops && !this.stopInterval };
} } } })], c8.prototype, "stops", void 0), e2([o2("stops")], c8.prototype, "readStops", null), e2([r2("stops")], c8.prototype, "writeStops", null), c8 = a8 = e2([n("esri.webdoc.widgets.TimeSlider")], c8);
var d3 = c8;

// node_modules/@arcgis/core/webdoc/Widgets.js
var m6;
var c9 = m6 = class extends l {
  constructor(r5) {
    super(r5), this.range = null, this.timeSlider = null, this.floorFilter = null;
  }
  clone() {
    return new m6(y({ range: this.range, timeSlider: this.timeSlider, floorFilter: this.floorFilter }));
  }
};
e2([y2({ type: u3, json: { write: true } })], c9.prototype, "range", void 0), e2([y2({ type: d3, json: { write: true } })], c9.prototype, "timeSlider", void 0), e2([y2({ type: l5, json: { write: true } })], c9.prototype, "floorFilter", void 0), c9 = m6 = e2([n("esri.webdoc.Widgets")], c9);
var n8 = c9;

// node_modules/@arcgis/core/webdoc/support/thumbnailUtils.js
var h2 = { width: 600, height: 400 };
var t2 = 1.5;
function i13(i17, e4) {
  e4 = e4 || h2;
  let { width: d4, height: n10 } = e4;
  const g = d4 / n10;
  return g < t2 ? n10 = d4 / t2 : g > t2 && (d4 = n10 * t2), d4 > i17.width && (n10 *= i17.width / d4, d4 = i17.width), n10 > i17.height && (d4 *= i17.height / n10, n10 = i17.height), { width: Math.round(d4), height: Math.round(n10) };
}

// node_modules/@arcgis/core/core/accessorSupport/extensions/serializableProperty/writePolicyUtils.js
function e3(e4) {
  return { enabled: !!(e4 == null ? void 0 : e4.length) };
}

// node_modules/@arcgis/core/webdoc/applicationProperties/SearchLayerField.js
var c10;
var a9 = c10 = class extends l {
  constructor(r5) {
    super(r5), this.exactMatch = false, this.name = null, this.type = null;
  }
  clone() {
    return new c10({ exactMatch: this.exactMatch, type: this.type, name: this.name });
  }
};
e2([y2({ type: Boolean, json: { write: true } })], a9.prototype, "exactMatch", void 0), e2([y2({ type: String, json: { write: true } })], a9.prototype, "name", void 0), e2([r3(i2)], a9.prototype, "type", void 0), a9 = c10 = e2([n("esri.webdoc.applicationProperties.SearchLayerField")], a9);
var i14 = a9;

// node_modules/@arcgis/core/webdoc/applicationProperties/SearchLayer.js
var c11;
var a10 = c11 = class extends l {
  constructor(r5) {
    super(r5), this.field = null, this.id = null, this.subLayer = null;
  }
  clone() {
    return new c11(y({ field: this.field, id: this.id, subLayer: this.subLayer }));
  }
};
e2([y2({ type: i14, json: { write: { isRequired: true } } })], a10.prototype, "field", void 0), e2([y2({ type: String, json: { write: { isRequired: true } } })], a10.prototype, "id", void 0), e2([y2({ type: T, json: { write: true } })], a10.prototype, "subLayer", void 0), a10 = c11 = e2([n("esri.webdoc.applicationProperties.SearchLayer")], a10);
var u4 = a10;

// node_modules/@arcgis/core/webdoc/applicationProperties/SearchTableField.js
var c12;
var a11 = c12 = class extends l {
  constructor(r5) {
    super(r5), this.exactMatch = false, this.name = null, this.type = null;
  }
  clone() {
    return new c12({ exactMatch: this.exactMatch, type: this.type, name: this.name });
  }
};
e2([y2({ type: Boolean, json: { write: true } })], a11.prototype, "exactMatch", void 0), e2([y2({ type: String, json: { write: true } })], a11.prototype, "name", void 0), e2([r3(i2)], a11.prototype, "type", void 0), a11 = c12 = e2([n("esri.webdoc.applicationProperties.SearchTableField")], a11);
var i15 = a11;

// node_modules/@arcgis/core/webdoc/applicationProperties/SearchTable.js
var p5;
var c13 = p5 = class extends l {
  constructor(r5) {
    super(r5), this.field = null, this.id = null;
  }
  clone() {
    return new p5(y({ field: this.field, id: this.id }));
  }
};
e2([y2({ type: i15, json: { write: { isRequired: true } } })], c13.prototype, "field", void 0), e2([y2({ type: String, json: { write: { isRequired: true } } })], c13.prototype, "id", void 0), c13 = p5 = e2([n("esri.webdoc.applicationProperties.SearchTable")], c13);
var l6 = c13;

// node_modules/@arcgis/core/webdoc/applicationProperties/Search.js
var p6;
var b3 = j4.ofType(u4);
var h3 = j4.ofType(l6);
var u5 = p6 = class extends l {
  constructor(e4) {
    super(e4), this.addressSearchEnabled = true, this.enabled = true, this.hintText = null, this.layers = new b3(), this.tables = new h3();
  }
  readAddressSearchEnabled(e4) {
    return !e4;
  }
  writeAddressSearchEnabled(e4, r5, o6) {
    r5[o6] = !e4;
  }
  clone() {
    return new p6(y({ addressSearchEnabled: this.addressSearchEnabled, enabled: this.enabled, hintText: this.hintText, layers: this.layers, tables: this.tables }));
  }
};
e2([y2({ type: Boolean, nonNullable: true, json: { read: { source: "disablePlaceFinder" }, write: { target: "disablePlaceFinder", isRequired: true }, origins: { "web-scene": { read: false, write: false } } } })], u5.prototype, "addressSearchEnabled", void 0), e2([o2("addressSearchEnabled")], u5.prototype, "readAddressSearchEnabled", null), e2([r2("addressSearchEnabled")], u5.prototype, "writeAddressSearchEnabled", null), e2([y2({ type: Boolean, nonNullable: true, json: { write: true, origins: { "web-map": { write: { isRequired: true } }, "web-scene": { default: true, write: true } } } })], u5.prototype, "enabled", void 0), e2([y2({ type: String, json: { write: true } })], u5.prototype, "hintText", void 0), e2([y2({ type: b3, json: { write: { overridePolicy: e3 }, origins: { "web-scene": { write: { isRequired: true } } } } })], u5.prototype, "layers", void 0), e2([y2({ type: h3, json: { read: true, write: { overridePolicy: e3 } } })], u5.prototype, "tables", void 0), u5 = p6 = e2([n("esri.webdoc.applicationProperties.Search")], u5);
var y4 = u5;

// node_modules/@arcgis/core/webdoc/applicationProperties/Viewing.js
var p7;
var a12 = p7 = class extends l {
  constructor(r5) {
    super(r5), this.search = null;
  }
  clone() {
    return new p7(y({ search: this.search }));
  }
};
e2([y2({ type: y4, json: { write: true } })], a12.prototype, "search", void 0), a12 = p7 = e2([n("esri.webdoc.applicationProperties.Viewing")], a12);
var i16 = a12;

// node_modules/@arcgis/core/webmap/ApplicationProperties.js
var p8;
var n9 = p8 = class extends l {
  constructor(o6) {
    super(o6), this.editing = null, this.offline = null, this.viewing = null;
  }
  clone() {
    return new p8(y({ editing: this.editing, offline: this.offline, viewing: this.viewing }));
  }
};
e2([y2({ json: { write: true } })], n9.prototype, "editing", void 0), e2([y2({ json: { write: true } })], n9.prototype, "offline", void 0), e2([y2({ type: i16, json: { write: true } })], n9.prototype, "viewing", void 0), n9 = p8 = e2([n("esri.webmap.ApplicationProperties")], n9);
var c14 = n9;

// node_modules/@arcgis/core/webmap/InitialViewProperties.js
var c15;
var l7 = c15 = class extends m {
  constructor(o6) {
    super(o6), this.background = null, this.rangeInfo = null, this.spatialReference = null, this.viewpoint = null;
  }
  clone() {
    return new c15(y({ background: this.background, rangeInfo: this.rangeInfo, spatialReference: this.spatialReference, viewpoint: this.viewpoint }));
  }
};
e2([y2({ type: m4 })], l7.prototype, "background", void 0), e2([y2({ type: c7 })], l7.prototype, "rangeInfo", void 0), e2([y2({ type: k })], l7.prototype, "spatialReference", void 0), e2([y2({ type: u })], l7.prototype, "viewpoint", void 0), l7 = c15 = e2([n("esri.webmap.InitialViewProperties")], l7);
var m7 = l7;

// node_modules/@arcgis/core/webmap/Version.js
var s10 = class extends r4 {
  constructor(r5, s11) {
    super(r5, s11, "webmap");
  }
};

// node_modules/@arcgis/core/WebMap.js
var re = new s10(2, 26);
var ie = "Web Map";
var oe = j4.ofType(b2);
var ae = j4.ofType(b);
var se = /* @__PURE__ */ new Map();
se.set("image/jpeg", "jpeg"), se.set("image/jpg", "jpg"), se.set("image/png", "png"), se.set("image/gif", "gif");
var ne = "ArcGIS Pro";
var le = f.JSAPI;
var pe = "CollectorDisabled";
var me = "Collector";
var he = "Data Editing";
var ue = "OfflineDisabled";
var de = "Offline";
var ce = "Workforce Project";
var ye = "Workforce Worker";
var we = "Workforce Dispatcher";
var ge = "Offline Map Areas";
var fe = "FieldMapsDisabled";
var be = f.DEVELOPER_BASEMAP;
var _e = "UtilityNetwork";
var ve = ["NatGeo_World_Map", "Ocean_Basemap", "USA_Topo_Maps", "World_Imagery", "World_Street_Map", "World_Terrain_Base", "World_Topo_Map", "World_Hillshade", "Canvas/World_Light_Gray_Base", "Canvas/World_Light_Gray_Reference", "Canvas/World_Dark_Gray_Base", "Canvas/World_Dark_Gray_Reference", "Ocean/World_Ocean_Base", "Ocean/World_Ocean_Reference", "Reference/World_Boundaries_and_Places", "Reference/World_Reference_Overlay", "Reference/World_Transportation"].map((e4) => e4.toLowerCase());
var Ie = class extends O(m3.LoadableMixin(m2(L))) {
  constructor(e4) {
    super(e4), this.applicationProperties = null, this.bookmarks = new oe(), this.floorInfo = null, this.geotriggersInfo = null, this.initialViewProperties = new m7(), this.portalItem = null, this.presentation = null, this.sourceVersion = null, this.widgets = null, this.utilityNetworks = null, this.authoringApp = this.authoringAppVersion = null, this._isAuthoringAppSetByUser = this._isAuthoringAppVersionSetByUser = false;
  }
  destroy() {
    const e4 = this.portalItem;
    this.portalItem = null, e4 == null ? void 0 : e4.destroy();
  }
  initialize() {
    if (this.when().catch((e4) => {
      s.getLogger(this.declaredClass).error("#load()", "Failed to load web map", e4);
    }), this.resourceInfo) {
      let t3;
      try {
        t3 = this._validateJSON(this.resourceInfo);
      } catch (e4) {
        return void this.addResolvingPromise(Promise.reject(e4));
      }
      this.read(t3);
    }
  }
  set authoringApp(e4) {
    this._isAuthoringAppSetByUser = true, this._set("authoringApp", e4);
  }
  writeAuthoringApp(e4, t3) {
    e4 && this._isAuthoringAppSetByUser ? t3.authoringApp = e4 : t3.authoringApp = le;
  }
  set authoringAppVersion(e4) {
    this._isAuthoringAppVersionSetByUser = true, this._set("authoringAppVersion", e4);
  }
  writeAuthoringAppVersion(e4, r5) {
    e4 && this._isAuthoringAppVersionSetByUser ? r5.authoringAppVersion = e4 : r5.authoringAppVersion = a;
  }
  readInitialViewProperties(e4, t3) {
    var _a;
    const r5 = new m7();
    t3.background && (r5.background = m4.fromJSON(t3.background));
    const o6 = (_a = t3.initialState) == null ? void 0 : _a.viewpoint;
    if (o6) {
      if (o6.rotation) {
        s10.parse(t3.version || "", "webmap").lessThan(2, 20) && t3.authoringApp === ne && (o6.rotation *= -1);
      }
      r5.viewpoint = u.fromJSON(o6);
    }
    return t3.mapRangeInfo && (r5.rangeInfo = c7.fromJSON(t3.mapRangeInfo)), t3.spatialReference && (r5.spatialReference = k.fromJSON(t3.spatialReference)), r5;
  }
  writeInitialViewProperties(e4, t3, r5, i17) {
    if (!e4)
      return;
    const o6 = e4.background;
    o6 && o6.color && (t3.background = o6.write({}, i17)), e4.viewpoint && (t3.initialState = { viewpoint: e4.viewpoint.write({}, i17) }), e4.rangeInfo && (t3.mapRangeInfo = e4.rangeInfo.toJSON(i17)), e4.spatialReference && (t3.spatialReference = e4.spatialReference.write({}, i17));
  }
  writeLayers(e4, t3, r5, i17) {
    t3[r5] = this._writeLayers(e4, i17, "operational-layers");
  }
  readSourceVersion(e4, t3) {
    const [r5, i17] = t3.version.split(".");
    return new s10(parseInt(r5, 10), parseInt(i17, 10));
  }
  writeSourceVersion(e4, t3, r5) {
    t3[r5] = `${re.major}.${re.minor}`;
  }
  writeTables(e4, t3, r5, i17) {
    const o6 = this._writeLayers(e4, i17, "tables");
    o6.length && (t3[r5] = o6);
  }
  get thumbnailUrl() {
    return this.portalItem && this.portalItem.thumbnailUrl || null;
  }
  set thumbnailUrl(e4) {
    e4 ? (this._override("thumbnailUrl", e4), this._thumbnailFilename = this._generateCustomThumbnailFilename(e4)) : this._clearThumbnailOverride();
  }
  load(e4) {
    return this.addResolvingPromise(this._loadFromSource()), Promise.resolve(this);
  }
  loadAll() {
    return n2(this, (e4) => {
      e4(this.ground, this.basemap, this.layers, this.tables);
    });
  }
  read(e4, t3) {
    t3 = { ...t3, origin: "web-map" };
    const r5 = this._getAuthoringPropsState();
    d(this, e4, (t4) => super.read(e4, t4), t3), this._restoreAuthoringPropsFromState(r5);
  }
  write(e4, t3) {
    if ("loaded" !== this.loadStatus) {
      const e5 = new s2("webmap:not-loaded", "Web map must be loaded before it can be serialized");
      throw s.getLogger(this.declaredClass).error("#toJSON()", "Web map must be loaded before it can be serialized", this.loadError || this.loadStatus), e5;
    }
    return this._removeDanglingLayerRefs(), t3 = { ...t3, origin: "web-map", restrictedWebMapWriting: true, webmap: this }, super.write(e4, t3);
  }
  async save(e4) {
    e4 = e4 || {}, this._validateItem(), await this._updateFromPromise, await this.load(), await this._loadLayerContainers(), await this._beforeSave(), await this._validateMap();
    const t3 = this.portalItem, r5 = { origin: "web-map", messages: [], writtenProperties: [], url: t3.itemUrl && j2(t3.itemUrl), portal: t3.portal || j6.getDefault() }, i17 = this.write({}, r5);
    return this._validateJSONForWriting(r5, e4), await this._updateItemProperties(t3), await this._updateItem(t3, i17, r5), await this._updateItemThumbnail(), t3;
  }
  async saveAs(e4, t3) {
    t3 = t3 || {};
    const r5 = this._getPortalItem(e4);
    await this._updateFromPromise, await this.load(), await this._loadLayerContainers(), await this._beforeSave(), await this._validateMap();
    const i17 = { origin: "web-map", messages: [], writtenProperties: [], url: null, portal: r5.portal }, o6 = this.write({}, i17);
    this._validateJSONForWriting(i17, t3), await this._updateItemPropertiesForSaveAs(r5);
    const a13 = this._getThumbnailState();
    return await this._createItem(r5, o6, i17, t3), this._restoreThumbnailFromState(a13), await this._updateItemThumbnail(), r5;
  }
  async updateFrom(e4, t3) {
    const r5 = this._updateFromInternal(e4, t3);
    this._updateFromPromise = r5, await r5;
    r5 === this._updateFromPromise && (this._updateFromPromise = null);
  }
  getLayerJSONFromResourceInfo(e4) {
    var _a, _b, _c, _d;
    const t3 = this.resourceInfo;
    return this._collectAllLayersJSON([...((_a = t3 == null ? void 0 : t3.baseMap) == null ? void 0 : _a.baseMapLayers) || [], ...(t3 == null ? void 0 : t3.operationalLayers) || [], ...((_d = (_c = (_b = this.basemap) == null ? void 0 : _b.resourceInfo) == null ? void 0 : _c.data) == null ? void 0 : _d.baseMapLayers) || []]).find((t4) => t4.id === e4.id);
  }
  _collectAllLayersJSON(e4) {
    return e4.reduce((e5, t3) => (e5.push(t3), "GroupLayer" === t3.layerType && (e5 = e5.concat(this._collectAllLayersJSON(t3.layers || []))), e5), []);
  }
  _writeLayers(e4, t3, r5) {
    t3 = { ...t3, layerContainerType: r5 };
    return e4.map((e5) => e(y3(e5, "tables" === r5 ? null : this.getLayerJSONFromResourceInfo(e5), t3))).filter(Boolean).toArray();
  }
  _loadFromSource() {
    return this.resourceInfo ? this._loadFromJSON(this.resourceInfo, { origin: "web-map" }) : this.portalItem && this.portalItem.id ? this._loadFromItem(this.portalItem) : Promise.resolve(null);
  }
  _loadFromItem(e4) {
    return e4.load().catch((e5) => {
      throw new s2("webmap:load-portal-item", "Failed to load portal item", { error: e5 });
    }).then(() => {
      if ("Web Map" !== e4.type)
        throw new s2("webmap:invalid-portal-item", "Invalid portal item type '${type}', expected 'Web Map'", { type: e4.type });
    }).then(() => e4.fetchData()).then((t3) => (this.resourceInfo = t3, this._readAndLoadFromJSON(t3, { origin: "web-map", portal: e4.portal || j6.getDefault() }))).then(() => this._computeInitialViewpoint());
  }
  _readAndLoadFromJSON(e4, t3) {
    const r5 = this._validateJSON(e4);
    return this.read(r5, t3), this._loadFromJSON(r5, t3);
  }
  _validateJSON(e4) {
    const t3 = s10.parse(e4.version || "", "webmap");
    return re.validate(t3), e4.version = `${t3.major}.${t3.minor}`, e4;
  }
  _loadFromJSON(e4, t3) {
    const r5 = { context: { ...t3, layerContainerType: "operational-layers" } };
    return this.portalItem && (r5.context.portal = this.portalItem.portal || j6.getDefault()), import("./layersCreator-LWHV5JQX.js").then(({ populateOperationalLayers: t4 }) => {
      const i17 = [], o6 = e4.operationalLayers;
      o6 && o6.length && i17.push(t4(this.layers, o6, r5));
      const a13 = { ...r5, context: { ...r5.context, layerContainerType: "tables" }, defaultLayerType: "ArcGISFeatureLayer" }, s11 = e4.tables;
      return s11 && s11.length && i17.push(t4(this.tables, s11, a13)), E(i17).then(() => {
      });
    });
  }
  async _computeInitialViewpoint() {
    var _a;
    let e4 = this.initialViewProperties;
    const t3 = (_a = e4 == null ? void 0 : e4.viewpoint) == null ? void 0 : _a.targetGeometry;
    if (t3)
      return;
    const r5 = await this._getExtentFromItem();
    r5 && (e4 = e4 ? e4.clone() : new m7(), e4.viewpoint = new u(), e4.viewpoint.targetGeometry = r5, this.initialViewProperties = e4);
  }
  async _getExtentFromItem() {
    var _a, _b;
    const e4 = (_a = this.initialViewProperties) == null ? void 0 : _a.spatialReference, t3 = (_b = this.portalItem) == null ? void 0 : _b.extent;
    if (e4 && t3) {
      if (e4.isWGS84)
        return t3.clone();
      if (e4.isWebMercator)
        return R(t3);
      return (await import("./geometryServiceUtils-OK3VBR2C.js")).getGeometryServiceURL(this.portalItem).then((r5) => {
        const i17 = new a2();
        return i17.geometries = [t3], i17.outSpatialReference = e4, n3(r5, i17);
      }).then((e5) => e5[0]).catch((e5) => (s.getLogger(this.declaredClass).error("Error projecting item's extent:", e5), null));
    }
    return null;
  }
  _removeDanglingLayerRefs() {
    const e4 = this.applicationProperties, t3 = e4 && e4.viewing && e4.viewing.search, r5 = (e5) => this.allLayers.some((t4) => t4.id === e5);
    t3 && t3.layers && (t3.layers = t3.layers.filter((e5) => r5(e5.id))), t3 && t3.tables && (t3.tables = t3.tables.filter((e5) => this.tables.some((t4) => t4.id === e5.id)));
    const i17 = e4 && e4.editing && e4.editing.locationTracking;
    i17 && i17.info && !r5(i17.info.layerId) && (e4.editing = null);
    const o6 = this.presentation && this.presentation.slides;
    o6 && o6.forEach((e5) => {
      e5.visibleLayers && (e5.visibleLayers = e5.visibleLayers.filter((e6) => r5(e6.id)));
    });
  }
  async _validateMap() {
    var _a;
    if (!((_a = this.basemap) == null ? void 0 : _a.baseLayers.length))
      throw new s2("webmap:save", "Map does not have a valid basemap with a base layer.");
    let e4 = null;
    if (await j3(() => {
      const t3 = h(this.initialViewProperties, this.basemap);
      return e4 = t3.spatialReference, !t3.updating;
    }), !E2(e4, this.initialViewProperties.spatialReference))
      throw new s2("webmap:save", "The spatial reference of the basemap is not compatible with the one from the map.", { expected: this.initialViewProperties.spatialReference, actual: e4 });
  }
  _validateItem() {
    if (!this.portalItem)
      throw s.getLogger(this.declaredClass).error("save: requires the portalItem property to be set"), new s2("webmap:portal-item-not-set", "Portal item to save to has not been set on the WebMap");
    this._validateItemType(this.portalItem);
  }
  _validateItemType(e4) {
    if (e4.type !== ie)
      throw new s2("webmap:portal-item-wrong-type", `Portal item needs to have type "${ie}"`);
  }
  _loadLayerContainers() {
    const e4 = [];
    return this.basemap && e4.push(this.basemap.load()), this.ground && e4.push(this.ground.load()), E(e4).then(() => {
    });
  }
  async _beforeSave() {
    const e4 = [];
    for (const t3 of this.allLayers)
      if ("beforeSave" in t3 && "function" == typeof t3.beforeSave) {
        const r5 = t3.beforeSave();
        r5 && e4.push(r5);
      }
    await E(e4);
  }
  _loadAllLayers() {
    const e4 = this._getAllLayersAndTables().map((e5) => e5.load());
    return E(e4).then(() => {
    });
  }
  _getAllLayersAndTables() {
    return this.allLayers.concat(this.allTables);
  }
  _validateJSONForWriting(e4, t3) {
    let r5 = e4.messages.filter((e5) => "error" === e5.type).map((e5) => new s2(e5.name, e5.message, e5.details));
    if (t3.ignoreUnsupported && (r5 = r5.filter((e5) => "layer:unsupported" !== e5.name && "symbol:unsupported" !== e5.name && "symbol-layer:unsupported" !== e5.name && "property:unsupported" !== e5.name && "url:unsupported" !== e5.name)), r5.length > 0)
      throw new s2("webmap:save", "Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information", { errors: r5 });
  }
  async _updateItemProperties(e4) {
    e4.extent = await this._getWGS84Extent(this.initialViewProperties.viewpoint.targetGeometry), await this._updateTypeKeywords(e4);
  }
  async _updateItemPropertiesForSaveAs(e4) {
    c(e4, pe), c(e4, fe), c(e4, f.METADATA), c(e4, ue), c(e4, ge), c(e4, we), c(e4, ce), c(e4, ye), await this._updateItemProperties(e4);
  }
  async _getWGS84Extent(e4) {
    const t3 = e4.clone().normalize();
    let r5;
    if (t3.length > 1)
      for (const i17 of t3)
        r5 ? i17.width > r5.width && (r5 = i17) : r5 = i17;
    else
      r5 = t3[0];
    return this._projectToWGS84(r5);
  }
  async _projectToWGS84(e4) {
    const t3 = e4.spatialReference;
    if (t3.isWGS84)
      return e4.clone();
    if (t3.isWebMercator)
      return j(e4);
    const r5 = await import("./geometryServiceUtils-OK3VBR2C.js"), i17 = await r5.getGeometryServiceURL(this.portalItem), o6 = new a2();
    o6.geometries = [e4], o6.outSpatialReference = k.WGS84;
    return (await n3(i17, o6))[0];
  }
  async _updateTypeKeywords(e4) {
    i3(e4, le), await this._loadAllLayers(), this._evalCollectorKeyword(e4), this._evalDataEditingKeyword(e4), this._evalOfflineKeyword(e4), this._evalDeveloperBasemapKeyword(e4), this._evalUtilityNetworkKeyword(e4), e4.typeKeywords && (e4.typeKeywords = e4.typeKeywords.filter((e5, t3, r5) => r5.indexOf(e5) === t3));
  }
  _evalCollectorKeyword(e4) {
    s4(e4, pe) || s4(e4, ce) || s4(e4, ye) || s4(e4, we) || !this._hasEditableFeatureLayer() ? c(e4, me) : i3(e4, me);
  }
  _evalDataEditingKeyword(e4) {
    this._hasEditableFeatureLayer() ? i3(e4, he) : c(e4, he);
  }
  _evalOfflineKeyword(e4) {
    !s4(e4, ue) && this._isOfflineCapableMap() ? i3(e4, de) : c(e4, de);
  }
  _evalDeveloperBasemapKeyword(e4) {
    v2(this.basemap) ? i3(e4, be) : c(e4, be);
  }
  _evalUtilityNetworkKeyword(e4) {
    var _a;
    ((_a = this.utilityNetworks) == null ? void 0 : _a.length) ? i3(e4, _e) : c(e4, _e);
  }
  _hasEditableFeatureLayer() {
    return this._getAllLayersAndTables().some((e4) => e4.loaded && o3(e4) && e4.capabilities.operations.supportsEditing && e4.editingEnabled);
  }
  _isOfflineCapableMap() {
    return this._getAllLayersAndTables().filter((e4) => "group" !== e4.type).every((e4) => e4.loaded && this._isOfflineCapableLayer(e4));
  }
  _isFeatureCollectionLike(e4) {
    return l2(e4) || "map-notes" === e4.type || "route" === e4.type;
  }
  _isOfflineCapableLayer(e4) {
    return o3(e4) && e4.capabilities.operations.supportsSync || this._isFeatureCollectionLike(e4) && !e4.portalItem || ("tile" === e4.type || "vector-tile" === e4.type) && (e4.capabilities.operations.supportsExportTiles || this._isExportableAGOLTileLayer(e4) || S2(e4)) && e4.spatialReference.equals(this.initialViewProperties.spatialReference);
  }
  _isExportableAGOLTileLayer(e4) {
    return "tile" === e4.type && (j5(e4.url) && ve.some((t3) => e4.url.toLowerCase().includes("/" + t3 + "/")));
  }
  async _updateItem(e4, t3, r5) {
    await e4.update({ data: t3 }), this._syncUpInstanceWithItem(e4, t3, r5);
  }
  async _createItem(e4, t3, r5, i17) {
    const o6 = this.portalItem, s11 = !!(o6 && o6.id && o6.portal.user), n10 = e4.portal;
    if (await n10._signIn(), !await this._canCopyItem(o6, s11, n10))
      throw new s2("webmap:save-as-copy-not-allowed", "Owner of this map does not allow others to save a copy");
    await n10.user.addItem({ item: e4, folder: i17.folder, data: t3 }), this.portalItem = e4, this._syncUpInstanceWithItem(e4, t3, r5);
  }
  async _canCopyItem(e4, t3, r5) {
    return !(r(e4) && e4.id && e4.typeKeywords && e4.typeKeywords.includes("useOnly")) || e4.portal.portalHostname === r5.portalHostname && (t3 || await e4.reload(), "admin" === e4.itemControl || "update" === e4.itemControl);
  }
  _syncUpInstanceWithItem(e4, t3, r5) {
    S.prototype.read.call(this, { version: t3.version, authoringApp: t3.authoringApp, authoringAppVersion: t3.authoringAppVersion }, { origin: "web-map", ignoreDefaults: true, url: e4.itemUrl && j2(e4.itemUrl) }), i5(r5), this.resourceInfo = t3;
  }
  async _updateItemThumbnail() {
    this.thumbnailUrl && this._isOverridden("thumbnailUrl") && (await this.portalItem.updateThumbnail({ thumbnail: this.thumbnailUrl, filename: this._thumbnailFilename }), this._clearThumbnailOverride());
  }
  _getPortalItem(e4) {
    let t3 = x.from(e4);
    return t3.id && (t3 = t3.clone(), t3.id = null), t3.type || (t3.type = ie), t3.portal || (t3.portal = j6.getDefault()), this._validateItemType(t3), t3;
  }
  async _updateFromInternal(e4, t3) {
    if (t3 = t3 || {}, await j3(() => e4.ready), this._updateInitialViewProperties(e4, t3), e4.map === this)
      for (const r5 of e4.allLayerViews)
        for (const e5 of ["visible", "featureEffect"])
          e5 in r5 && e5 in r5.layer && r5._isOverridden(e5) && (r5.layer[e5] = r5[e5]);
    await this._updateThumbnailUrl(e4, t3);
  }
  _updateInitialViewProperties(e4, t3) {
    var _a;
    if (t3.backgroundExcluded || (this.initialViewProperties.background = (_a = e4.background) == null ? void 0 : _a.clone()), this.initialViewProperties.spatialReference = e4.spatialReference.clone(), t3.viewpointExcluded || (this.initialViewProperties.viewpoint = new u({ rotation: e4.rotation, scale: t3.scalePreserved ? e4.scale : null, targetGeometry: this._getViewExtent(e4) })), !t3.widgetsExcluded)
      for (const r5 of e4.persistableViewModels)
        r5.updateWebDocument(this);
  }
  _getViewExtent(e4) {
    const t3 = e4.center.clone().normalize(), r5 = e4.extent.clone(), i17 = r5.width / 2;
    return r5.xmin = t3.x - i17, r5.xmax = t3.x + i17, r5;
  }
  async _updateThumbnailUrl(e4, t3) {
    if (t3.thumbnailExcluded)
      return;
    const r5 = i13(e4, t3.thumbnailSize), i17 = await e4.takeScreenshot({ format: "png", width: r5.width, height: r5.height });
    this._setAutoGeneratedThumbnail(i17.dataUrl);
  }
  _setAutoGeneratedThumbnail(e4) {
    this.thumbnailUrl = e4, this._thumbnailFilename = null;
  }
  _clearThumbnailOverride() {
    this._clearOverride("thumbnailUrl"), this.clear("thumbnailUrl", "user"), this._thumbnailFilename = null;
  }
  _generateCustomThumbnailFilename(e4) {
    if (X(e4)) {
      const t3 = nt(e4), r5 = t3 && t3.mediaType, i17 = r5 && se.get(r5.toLowerCase()) || null, o6 = `thumbnail${Date.now()}`;
      return i17 ? `${o6}.${i17}` : o6;
    }
    return null;
  }
  _getThumbnailState() {
    let e4 = this.thumbnailUrl;
    return e4 && (e4 = this._isOverridden("thumbnailUrl") ? e4 : St(e4, "w", "8192")), { thumbnailUrl: e4, filename: this._thumbnailFilename };
  }
  _restoreThumbnailFromState(e4) {
    this.thumbnailUrl = e4.thumbnailUrl, this._thumbnailFilename = e4.filename;
  }
  _getAuthoringPropsState() {
    return { authoringApp: this.authoringApp, authoringAppVersion: this.authoringAppVersion, isAuthoringAppSetByUser: this._isAuthoringAppSetByUser, isAuthoringAppVersionSetByUser: this._isAuthoringAppVersionSetByUser };
  }
  _restoreAuthoringPropsFromState(e4) {
    e4.isAuthoringAppSetByUser ? this.authoringApp = e4.authoringApp : this._isAuthoringAppSetByUser = false, e4.isAuthoringAppVersionSetByUser ? this.authoringAppVersion = e4.authoringAppVersion : this._isAuthoringAppVersionSetByUser = false;
  }
  static fromJSON(e4) {
    const t3 = e4;
    if (!t3)
      throw new s2("webmap:empty-resource", "Expected a JSON resource but got nothing");
    return new this({ resourceInfo: t3 });
  }
};
Ie.VERSION = re, e2([y2({ type: c14, json: { write: true } })], Ie.prototype, "applicationProperties", void 0), e2([y2({ type: String, json: { write: { allowNull: true, ignoreOrigin: true } } })], Ie.prototype, "authoringApp", null), e2([r2("authoringApp")], Ie.prototype, "writeAuthoringApp", null), e2([y2({ type: String, json: { write: { allowNull: true, ignoreOrigin: true } } })], Ie.prototype, "authoringAppVersion", null), e2([r2("authoringAppVersion")], Ie.prototype, "writeAuthoringAppVersion", null), e2([y2({ json: { read: { source: "baseMap" }, write: { target: "baseMap" } } })], Ie.prototype, "basemap", void 0), e2([y2({ type: oe, json: { write: { overridePolicy: (e4) => ({ enabled: !!(e4 && e4.length > 0), ignoreOrigin: true }) } } })], Ie.prototype, "bookmarks", void 0), e2([y2({ type: l4, json: { read: { source: "mapFloorInfo" }, write: { target: "mapFloorInfo" } } })], Ie.prototype, "floorInfo", void 0), e2([y2({ type: i11, json: { write: true } })], Ie.prototype, "geotriggersInfo", void 0), e2([y2({ type: m7, nonNullable: true, json: { read: { source: ["background", "initialState.viewpoint", "mapRangeInfo", "spatialReference"] }, write: { ignoreOrigin: true, target: { background: { type: m4 }, "initialState.viewpoint": { type: u }, mapRangeInfo: { type: c7 }, spatialReference: { type: k } } } } })], Ie.prototype, "initialViewProperties", void 0), e2([o2("initialViewProperties")], Ie.prototype, "readInitialViewProperties", null), e2([r2("initialViewProperties")], Ie.prototype, "writeInitialViewProperties", null), e2([y2({ json: { read: false, write: { target: "operationalLayers", ignoreOrigin: true } } })], Ie.prototype, "layers", void 0), e2([r2("layers")], Ie.prototype, "writeLayers", null), e2([y2({ type: x })], Ie.prototype, "portalItem", void 0), e2([y2({ json: { write: true } })], Ie.prototype, "presentation", void 0), e2([y2()], Ie.prototype, "resourceInfo", void 0), e2([y2({ readOnly: true, type: s10, json: { read: { source: "version" }, write: { allowNull: true, ignoreOrigin: true, target: "version", isRequired: true } } })], Ie.prototype, "sourceVersion", void 0), e2([o2("sourceVersion")], Ie.prototype, "readSourceVersion", null), e2([r2("sourceVersion")], Ie.prototype, "writeSourceVersion", null), e2([y2({ json: { read: false, write: { ignoreOrigin: true } } })], Ie.prototype, "tables", void 0), e2([r2("tables")], Ie.prototype, "writeTables", null), e2([y2()], Ie.prototype, "thumbnailUrl", null), e2([y2({ type: n8, json: { write: true } })], Ie.prototype, "widgets", void 0), e2([y2({ type: ae, json: { read: true, write: true } })], Ie.prototype, "utilityNetworks", void 0), Ie = e2([n("esri.WebMap")], Ie);
var Ae = Ie;

// dep:@arcgis_core_WebMap
var arcgis_core_WebMap_default = Ae;
export {
  arcgis_core_WebMap_default as default
};
//# sourceMappingURL=@arcgis_core_WebMap.js.map
