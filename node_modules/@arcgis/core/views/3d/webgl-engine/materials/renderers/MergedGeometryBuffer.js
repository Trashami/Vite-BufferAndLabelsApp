/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class e{constructor(e,s){this._pool=e,this._size=0,this._buffer=e.newBuffer(r(s))}dispose(){this._buffer=this._pool.deleteBuffer(this._buffer),this._size=0}release(){this.erase(0,this._size),this.dispose()}get buffer(){return this._buffer}get size(){return this._size}grow(e){this._resize(this._size+e,!0).dispose()}allocate(e){return this._resize(e,!1)}_resize(e,s){let r;const i=t(this._buffer.length,this._size,e);if(this._buffer.length!==i){const e=this._pool.newBuffer(i);s&&(e.array.set(this._buffer.array.subarray(0,Math.min(this._size,i))),e.vao.vertexBuffers.geometry.setSubData(e.array,0,0,e.array.length)),r=this._buffer,this._buffer=e}const f=this._size;return this._size=e,r?{dispose:()=>{r.array.fill(0,0,f),this._pool.deleteBuffer(r)},copy:(e,s,t)=>this._buffer.array.set(r.array.subarray(s,t),e),hasNewBuffer:!0}:{dispose:()=>{},copy:(e,s,r)=>{e!==s&&this._buffer.array.copyWithin(e,s,r)},hasNewBuffer:!1}}erase(e,s){this._buffer.array.fill(0,e,s)}}const s=65536;function r(e){return Math.ceil(e/s)*s}function t(e,s,t){return s<=t?e>=t?e:r(Math.max(2*e,t)):e<=2*t?e:r(t)}export{s as BLOCK_SIZE,e as MergedGeometryBuffer};
