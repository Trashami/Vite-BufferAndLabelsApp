/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{isSome as e,isNone as r}from"../../../../core/maybe.js";import{B as t}from"../../../../chunks/mat4.js";import{c as s}from"../../../../chunks/vec2.js";import{f as o}from"../../../../chunks/vec2f64.js";import{b as i}from"../../../../chunks/vec3.js";import{c}from"../../../../chunks/vec3f64.js";import{g as a,c as l}from"../../../../chunks/vec4.js";import{f as h}from"../../../../chunks/vec4f64.js";import{Object3DVisualElement as n}from"./Object3DVisualElement.js";import{Geometry as d}from"../../webgl-engine/lib/Geometry.js";import{RenderOccludedFlag as m}from"../../webgl-engine/lib/Material.js";import{VertexAttribute as u}from"../../webgl-engine/lib/VertexAttribute.js";import{CheckerBoardMaterial as _}from"../../webgl-engine/materials/CheckerBoardMaterial.js";class p extends n{constructor(e){super(e),this._checkerBoardMaterial=null,this._renderOccluded=m.OccludeAndTransparent,this._geometry=null,this._size=o(1,1),this._color1=h(1,.5,0,.5),this._color2=h(1,1,1,.5),this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._geometryChanged()}get size(){return this._size}set size(e){s(this._size,e),this._updateMaterial()}get color1(){return this._color1}set color1(e){a(e,this._color1)||(l(this._color1,e),this._updateMaterial())}get color2(){return this._color2}set color2(e){a(e,this._color2)||(l(this._color2,e),this._updateMaterial())}_updateMaterial(){e(this._checkerBoardMaterial)&&this._checkerBoardMaterial.setParameters({size:this._size,color1:this._color1,color2:this._color2,renderOccluded:this._renderOccluded})}createExternalResources(){this._checkerBoardMaterial=new _({size:this._size,color1:this._color1,color2:this._color2,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:m.OccludeAndTransparent})}destroyExternalResources(){this._checkerBoardMaterial=null}forEachExternalMaterial(r){e(this._checkerBoardMaterial)&&r(this._checkerBoardMaterial)}createGeometries(e){if(r(this._geometry)||r(this._checkerBoardMaterial))return;const s=g;t(s,this.transform);const o=this._geometry,a=[],l=c();o.position.forEach((e=>{i(l,e,s),a.push(l[0],l[1],l[2])}));const h=[];o.uv.forEach((e=>{h.push(e[0],e[1])}));const n=new d([[u.POSITION,{size:3,data:a,exclusive:!0}],[u.UV0,{size:2,data:h,exclusive:!0}]],[[u.POSITION,o.triangleIndices],[u.UV0,o.triangleIndices]]);e.addGeometry(n,this._checkerBoardMaterial)}_geometryChanged(){this.recreateGeometry()}}const g=c();export{p as MeasurementAreaVisualElement};
