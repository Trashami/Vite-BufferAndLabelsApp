/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import r from"../../core/Error.js";import{isSome as e}from"../../core/maybe.js";import{verifyBasicFieldValidity as i}from"./support/utils.js";import{verifyBinningParams as a}from"../support/binningUtils.js";import{binningCapableLayerTypes as n,defaultSupportedLayerTypes as t,createLayerAdapter as o,getLayerTypeLabels as s}from"../support/adapters/support/layerUtils.js";async function p(p){if(!(p&&p.layer&&p.view&&p.fields))throw new r("predominant-categories:missing-parameters","'layer', 'view' and 'fields' parameters are required");p.forBinning&&a(p,"predominant-categories");const{layer:l,...m}=p,f=p.forBinning?n:t,d=o(l,f,p.forBinning),c={layerAdapter:d,...m};if(!d)throw new r("predominant-categories:invalid-parameters","'layer' must be one of these types: "+s(f).join(", "));const g=e(c.signal)?{signal:c.signal}:null;await Promise.all([c.view.when(),d.load(g)]);const u=i(d,c.fields,"predominant-categories:invalid-parameters");if(u)throw u;return c}async function l(r){const{layerAdapter:e,...i}=await p(r);return e.predominantCategories(i)}export{l as default};
