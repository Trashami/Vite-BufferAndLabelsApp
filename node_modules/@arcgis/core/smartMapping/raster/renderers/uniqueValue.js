/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import e from"../../../core/Error.js";import{isNone as r}from"../../../core/maybe.js";import{createUVRenderer as a,isSingleBand8BitRasterWithStats as s,getClassField as t}from"../../../renderers/support/rasterRendererHelper.js";import{processRasterRendererParameters as o}from"../support/utils.js";async function n(a){a=await o(a);const{rasterInfo:n}=a.layer;if(n.bandCount>1)throw new e("raster-class-breaks-renderer:not-supported","Multiband raster is not supported");const{attributeTable:i}=n;if(r(i)){if(s(n))return a.classFieldName=a.classFieldName||"value",a;throw new e("raster-unique-value-renderer:not-supported","The source raster does not have an attribute table")}const l=a.classFieldName?.toLowerCase();if(l&&!i.fields.some((e=>e.name.toLowerCase()===l)))throw new e("raster-unique-value-renderer:invalid-parameters","A valid 'classfieldName' is required");return l||(a.classFieldName=t(i).name),a}async function i(s){s=await n(s);const{classFieldName:t,colors:o,colorRamp:i}=s,l=a(s.layer.rasterInfo,t,o,i);if(r(l))throw new e("raster-unique-value-renderer:not-supported","UniqueValueRenderer is not supported on the provided data source");return{renderer:l,classFieldName:t}}export{i as createRenderer};
