/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import o from"../../core/Collection.js";import{clone as r}from"../../core/lang.js";import t from"../../core/Logger.js";import{property as i}from"../../core/accessorSupport/decorators/property.js";import"../../core/accessorSupport/ensureType.js";import{reader as s}from"../../core/accessorSupport/decorators/reader.js";import{subclass as n}from"../../core/accessorSupport/decorators/subclass.js";import{writer as l}from"../../core/accessorSupport/decorators/writer.js";import p from"../../geometry/Extent.js";import a from"../../geometry/HeightModelInfo.js";import d from"../../geometry/SpatialReference.js";import{sanitizeUrlWithLayerId as c,writeUrlWithLayerId as u}from"../support/arcgisLayerUrl.js";import{elevationInfo as y,minScale as m,maxScale as v,url as f}from"../support/commonProperties.js";import{FeatureIndex as h}from"../support/FeatureIndex.js";import{geometryTypeKebabDict as g,getFeatureLayerCapabilities as I,readGlobalIdField as S,readObjectIdField as F,readVersion as j}from"../support/featureLayerUtils.js";import b from"../support/GeometryFieldsInfo.js";import x from"../support/LayerFloorInfo.js";import w from"../support/Relationship.js";const M=M=>{let E=class extends M{constructor(){super(...arguments),this.capabilities=null,this.copyright=null,this.datesInUnknownTimezone=!1,this.displayField=null,this.definitionExpression=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.isTable=!1,this.layerId=void 0,this.minScale=0,this.maxScale=0,this.globalIdField=null,this.objectIdField=null,this.relationships=null,this.sourceJSON=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.spatialReference=d.WGS84,this.subtypeField=null,this.trackIdField=null,this.indexes=new(o.ofType(h)),this.userIsAdmin=!1,this.version=void 0}readCapabilitiesFromService(e,o){return I(e,o,this.url)}readEditingInfo(e,o){const{editingInfo:r}=o;return r?{lastEditDate:null!=r.lastEditDate?new Date(r.lastEditDate):null}:null}readIsTableFromService(e,o){return"Table"===o.type}readMinScale(e,o){return o.effectiveMinScale||e||0}readMaxScale(e,o){return o.effectiveMaxScale||e||0}readGlobalIdFieldFromService(e,o){return S(o)}readObjectIdFieldFromService(e,o){return F(o)}readServiceDefinitionExpression(e,o){return o.definitionQuery||o.definitionExpression}set url(e){const o=c({layer:this,url:e,nonStandardUrlAllowed:!0,logger:t.getLogger(this.declaredClass)});this._set("url",o.url),null!=o.layerId&&this._set("layerId",o.layerId)}writeUrl(e,o,r,t){u(this,e,null,o,t)}readVersion(e,o){return j(o)}};return e([i({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],E.prototype,"capabilities",void 0),e([s("service","capabilities")],E.prototype,"readCapabilitiesFromService",null),e([i({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],E.prototype,"copyright",void 0),e([i({type:Boolean})],E.prototype,"datesInUnknownTimezone",void 0),e([i({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],E.prototype,"displayField",void 0),e([i({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],E.prototype,"definitionExpression",void 0),e([i({readOnly:!0})],E.prototype,"editFieldsInfo",void 0),e([i({readOnly:!0})],E.prototype,"editingInfo",void 0),e([s("editingInfo")],E.prototype,"readEditingInfo",null),e([i((()=>{const e=r(y),o=e.json.origins;return o["web-map"]={read:!1,write:!1},o["portal-item"]={read:!1,write:!1},e})())],E.prototype,"elevationInfo",void 0),e([i({type:x,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],E.prototype,"floorInfo",void 0),e([i({type:p,json:{origins:{service:{read:{source:"extent"}}}}})],E.prototype,"fullExtent",void 0),e([i()],E.prototype,"gdbVersion",void 0),e([i({readOnly:!0,type:b,json:{read:{source:"geometryProperties"}}})],E.prototype,"geometryFieldsInfo",void 0),e([i({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:g.read}}}})],E.prototype,"geometryType",void 0),e([i({type:Boolean,json:{origins:{service:{read:!0}}}})],E.prototype,"hasM",void 0),e([i({type:Boolean,json:{origins:{service:{read:!0}}}})],E.prototype,"hasZ",void 0),e([i({readOnly:!0,type:a})],E.prototype,"heightModelInfo",void 0),e([i({type:Date})],E.prototype,"historicMoment",void 0),e([i({readOnly:!0})],E.prototype,"isTable",void 0),e([s("service","isTable",["type"])],E.prototype,"readIsTableFromService",null),e([i({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],E.prototype,"layerId",void 0),e([i(m)],E.prototype,"minScale",void 0),e([s("service","minScale",["minScale","effectiveMinScale"])],E.prototype,"readMinScale",null),e([i(v)],E.prototype,"maxScale",void 0),e([s("service","maxScale",["maxScale","effectiveMaxScale"])],E.prototype,"readMaxScale",null),e([i({type:String})],E.prototype,"globalIdField",void 0),e([s("service","globalIdField",["globalIdField","fields"])],E.prototype,"readGlobalIdFieldFromService",null),e([i({type:String})],E.prototype,"objectIdField",void 0),e([s("service","objectIdField",["objectIdField","fields"])],E.prototype,"readObjectIdFieldFromService",null),e([i({type:[w],readOnly:!0})],E.prototype,"relationships",void 0),e([i()],E.prototype,"sourceJSON",void 0),e([i({type:Boolean})],E.prototype,"returnM",void 0),e([i({type:Boolean})],E.prototype,"returnZ",void 0),e([i({readOnly:!0})],E.prototype,"serviceDefinitionExpression",void 0),e([s("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],E.prototype,"readServiceDefinitionExpression",null),e([i({type:d,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],E.prototype,"spatialReference",void 0),e([i({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],E.prototype,"subtypeField",void 0),e([i({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],E.prototype,"trackIdField",void 0),e([i({readOnly:!0,json:{write:!1}})],E.prototype,"serverGens",void 0),e([i({type:o.ofType(h),readOnly:!0})],E.prototype,"indexes",void 0),e([i(f)],E.prototype,"url",null),e([l("url")],E.prototype,"writeUrl",null),e([i({readOnly:!0})],E.prototype,"userIsAdmin",void 0),e([i({json:{origins:{service:{read:!0}},read:!1}})],E.prototype,"version",void 0),e([s("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],E.prototype,"readVersion",null),E=e([n("esri.layers.mixins.FeatureLayerBase")],E),E};export{M as FeatureLayerBase};
