/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{unwrap as t,isSome as e}from"../../../core/maybe.js";import n from"../PixelBlock.js";var o;!function(t){t[t.Plus=1]="Plus",t[t.Minus=2]="Minus",t[t.Times=3]="Times",t[t.SquareRoot=4]="SquareRoot",t[t.Power=5]="Power",t[t.ACos=6]="ACos",t[t.ASin=7]="ASin",t[t.ATan=8]="ATan",t[t.ATanH=9]="ATanH",t[t.Abs=10]="Abs",t[t.BitwiseAnd=11]="BitwiseAnd",t[t.BitwiseLeftShift=12]="BitwiseLeftShift",t[t.BitwiseNot=13]="BitwiseNot",t[t.BitwiseOr=14]="BitwiseOr",t[t.BitwiseRightShift=15]="BitwiseRightShift",t[t.BitwiseXOr=16]="BitwiseXOr",t[t.BooleanAnd=17]="BooleanAnd",t[t.BooleanNot=18]="BooleanNot",t[t.BooleanOr=19]="BooleanOr",t[t.BooleanXOr=20]="BooleanXOr",t[t.Cos=21]="Cos",t[t.CosH=22]="CosH",t[t.Divide=23]="Divide",t[t.EqualTo=24]="EqualTo",t[t.Exp=25]="Exp",t[t.Exp10=26]="Exp10",t[t.Exp2=27]="Exp2",t[t.GreaterThan=28]="GreaterThan",t[t.GreaterThanEqual=29]="GreaterThanEqual",t[t.Int=30]="Int",t[t.IsNull=31]="IsNull",t[t.Float=32]="Float",t[t.LessThan=33]="LessThan",t[t.LessThanEqual=34]="LessThanEqual",t[t.Ln=35]="Ln",t[t.Log10=36]="Log10",t[t.Log2=37]="Log2",t[t.Majority=38]="Majority",t[t.Max=39]="Max",t[t.Mean=40]="Mean",t[t.Med=41]="Med",t[t.Min=42]="Min",t[t.Minority=43]="Minority",t[t.Mod=44]="Mod",t[t.Negate=45]="Negate",t[t.NotEqual=46]="NotEqual",t[t.Range=47]="Range",t[t.RoundDown=48]="RoundDown",t[t.RoundUp=49]="RoundUp",t[t.SetNull=50]="SetNull",t[t.Sin=51]="Sin",t[t.SinH=52]="SinH",t[t.Square=53]="Square",t[t.Std=54]="Std",t[t.Sum=55]="Sum",t[t.Tan=56]="Tan",t[t.TanH=57]="TanH",t[t.Variety=58]="Variety",t[t.ACosH=59]="ACosH",t[t.ASinH=60]="ASinH",t[t.ATan2=61]="ATan2",t[t.FloatDivide=64]="FloatDivide",t[t.FloorDivide=65]="FloorDivide",t[t.MajorityIgnoreNoData=66]="MajorityIgnoreNoData",t[t.MaxIgnoreNoData=67]="MaxIgnoreNoData",t[t.MeanIgnoreNoData=68]="MeanIgnoreNoData",t[t.MedIgnoreNoData=69]="MedIgnoreNoData",t[t.MinIgnoreNoData=70]="MinIgnoreNoData",t[t.MinorityIgnoreNoData=71]="MinorityIgnoreNoData",t[t.RangeIgnoreNoData=72]="RangeIgnoreNoData",t[t.StdIgnoreNoData=73]="StdIgnoreNoData",t[t.SumIgnoreNoData=74]="SumIgnoreNoData",t[t.VarietyIgnoreNoData=75]="VarietyIgnoreNoData",t[t.Con=76]="Con"}(o||(o={}));const r=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,1,1,1,1,999,999,1,1,999,1,1,2,2,2,999,999,999,999,999,999,999,999,999,999,3];function a(t){const n=t.map((t=>t.mask)).filter((t=>e(t)));if(0===n.length)return null;const o=n[0].length,r=new Uint8Array(o);if(1===n.length)return r.set(n[0]),r;let a,s=n[0];for(let e=1;e<n.length;e++){a=n[e];for(let t=0;t<o;t++)r[t]=s[t]|a[t];s=a}return r}function s(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]+a[n]);return l}function l(t,e,o){const[r]=t,a=r.length,s=n.createEmptyBand("f32",a);return s.set(r),s}function i(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]-a[n]);return l}function c(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]*a[n]);return l}function u(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=0===a[n]?0:r[n]/a[n]);return l}function f(t,e,n){return u(t,e,"f32")}function h(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=0===a[n]?0:Math.floor(r[n]/a[n]));return l}function g(t,e,o,r){const[a]=t,s=a.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r(a[n]));return l}function d(t,e,o,r){const[a,s]=t,l=a.length,i=n.createEmptyBand(o,l);for(let n=0;n<l;n++)e&&!e[n]||(i[n]=r(a[n],s[n]));return i}function p(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]&a[n]);return l}function y(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]<<a[n]);return l}function B(t,e,o){const[r]=t,a=r.length,s=n.createEmptyBand(o,a);for(let n=0;n<a;n++)e&&!e[n]||(s[n]=~r[n]);return s}function M(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]|a[n]);return l}function m(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]>>a[n]);return l}function E(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]^a[n]);return l}function N(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]&&a[n]?1:0);return l}function w(t,e,o){const[r]=t,a=r.length,s=n.createEmptyBand(o,a);for(let n=0;n<a;n++)e&&!e[n]||(s[n]=r[n]?0:1);return s}function D(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]||a[n]?1:0);return l}function S(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=(r[n]?1:0)^(a[n]?1:0));return l}function A(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]===a[n]?1:0);return l}function I(t,e,o,r){const[a]=t,s=a.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r**a[n]);return l}function T(t,e,n){return I(t,e,n,10)}function x(t,e,n){return I(t,e,n,2)}function q(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]>a[n]?1:0);return l}function H(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]>=a[n]?1:0);return l}function L(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]<a[n]?1:0);return l}function R(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]<=a[n]?1:0);return l}function C(t,e,o){const[r]=t,a=r.length,s=n.createEmptyBand(o,a);if(!e)return s;for(let n=0;n<a;n++)s[n]=e[n]?0:1;return s}function F(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]%a[n]);return l}function O(t,e,o){const[r]=t,a=r.length,s=n.createEmptyBand(o,a);for(let n=0;n<a;n++)e&&!e[n]||(s[n]=-r[n]);return s}function b(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]===a[n]?0:1);return l}function k(t,e,o){const[r,a]=t,s=r.length,l=n.createEmptyBand(o,s),i=new Uint8Array(s);for(let n=0;n<s;n++)null!=e&&!e[n]||0!==r[n]||(l[n]=a[n],i[n]=255);return{band:l,mask:i}}function v(t,e,o){const[r,a,s]=t,l=r.length,i=n.createEmptyBand(o,l);for(let n=0;n<l;n++)e&&!e[n]||(i[n]=r[n]?a[n]:s[n]);return i}function j(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=n.createEmptyBand(o,s);l.set(a);for(let n=0;n<s;n++)if(!e||e[n])for(let e=1;e<r;e++){const o=t[e];l[n]<o[n]&&(l[n]=o[n])}return l}function P(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=n.createEmptyBand(o,s);l.set(a);for(let n=0;n<s;n++)if(!e||e[n])for(let e=1;e<r;e++){const o=t[e];l[n]>o[n]&&(l[n]=o[n])}return l}function G(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=n.createEmptyBand(o,s);l.set(a);for(let n=0;n<s;n++)if(!e||e[n]){let e=l[n];for(let o=1;o<r;o++){const r=t[o];l[n]<r[n]&&(l[n]=r[n]),e>r[n]&&(e=r[n])}l[n]-=e}return l}function U(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=n.createEmptyBand(o,s);l.set(a);for(let n=0;n<s;n++)if(!e||e[n]){for(let e=1;e<r;e++){const o=t[e];l[n]+=o[n]}l[n]/=r}return l}function V(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=n.createEmptyBand(o,s);l.set(a);for(let n=0;n<s;n++)if(!e||e[n])for(let e=1;e<r;e++){const o=t[e];l[n]+=o[n]}return l}function X(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=n.createEmptyBand(o,s);for(let n=0;n<s;n++)if(!e||e[n]){const e=new Float32Array(r);let o=0;for(let s=0;s<r;s++){const r=t[s];o+=r[n],e[s]=r[n]}o/=r;let a=0;for(let t=0;t<r;t++)a+=(e[t]-o)*e[t]-o;l[n]=Math.sqrt(a/r-1)}return l}function z(t,e,o){const r=t.length;if(r<2)return t[0];const a=Math.floor(r/2),[s]=t,l=s.length,i=n.createEmptyBand(o,l),c=new Float32Array(r);for(let n=0;n<l;n++)if(!e||e[n]){for(let e=0;e<r;e++)c[e]=t[e][n];c.sort(),i[n]=c[a]}return i}function J(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=n.createEmptyBand(o,s),i=new Map;for(let n=0;n<s;n++)if(!e||e[n]){let e;i.clear();for(let s=0;s<r;s++)e=t[s][n],i.set(e,i.has(e)?i.get(e)+1:1);let o=0,a=0;for(const t of i.keys())o=i.get(t),o>a&&(a=o,e=t);l[n]=e}return l}function K(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=n.createEmptyBand(o,s),i=new Map;for(let n=0;n<s;n++)if(!e||e[n]){let e;i.clear();for(let s=0;s<r;s++)e=t[s][n],i.set(e,i.has(e)?i.get(e)+1:1);let o=0,a=t.length;for(const t of i.keys())o=i.get(t),o<a&&(a=o,e=t);l[n]=e}return l}function Q(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=n.createEmptyBand(o,s),i=new Set;for(let n=0;n<s;n++)if(!e||e[n]){let e;i.clear();for(let o=0;o<r;o++)e=t[o][n],i.add(e);l[n]=i.size}return l}function W(t,e,n){return J(t,null,n)}function Y(t,e,n){return K(t,null,n)}function Z(t,e,n){return Q(t,null,n)}function $(t,e,n){return j(t,null,n)}function _(t,e,n){return P(t,null,n)}function tt(t,e,n){return X(t,null,n)}function et(t,e,n){return V(t,null,n)}function nt(t,e,n){return U(t,null,n)}function ot(t,e,n){return z(t,null,n)}function rt(t,e,n){return G(t,null,n)}const at=new Map,st=new Map,lt=new Map;function it(){at.size||(at.set(4,Math.sqrt),at.set(6,Math.acos),at.set(7,Math.asin),at.set(8,Math.atan),at.set(9,Math.atanh),at.set(10,Math.abs),at.set(21,Math.cos),at.set(22,Math.cosh),at.set(25,Math.exp),at.set(30,Math.floor),at.set(35,Math.log),at.set(36,Math.log10),at.set(37,Math.log2),at.set(48,Math.floor),at.set(49,Math.ceil),at.set(51,Math.sin),at.set(52,Math.sinh),at.set(56,Math.tan),at.set(57,Math.tanh),at.set(59,Math.acosh),at.set(60,Math.asinh),at.set(65,Math.floor),st.set(5,Math.pow),st.set(61,Math.atan2),lt.set(1,s),lt.set(2,i),lt.set(3,c),lt.set(11,p),lt.set(12,y),lt.set(12,y),lt.set(13,B),lt.set(14,M),lt.set(15,m),lt.set(16,E),lt.set(17,N),lt.set(18,w),lt.set(19,D),lt.set(20,S),lt.set(23,u),lt.set(24,A),lt.set(26,T),lt.set(27,x),lt.set(28,q),lt.set(29,H),lt.set(31,C),lt.set(32,l),lt.set(33,L),lt.set(34,R),lt.set(44,F),lt.set(45,O),lt.set(46,b),lt.set(64,f),lt.set(65,h),lt.set(76,v),lt.set(38,J),lt.set(39,j),lt.set(40,U),lt.set(41,z),lt.set(42,P),lt.set(43,K),lt.set(47,G),lt.set(54,X),lt.set(55,V),lt.set(58,Q),lt.set(66,W),lt.set(67,$),lt.set(68,nt),lt.set(69,ot),lt.set(70,_),lt.set(71,Y),lt.set(72,rt),lt.set(73,tt),lt.set(74,et),lt.set(75,Z))}function ct(e,r,s={}){it();const l=t(a(e)),{processAsMultiband:i,outputPixelType:c="f32"}=s,u=i?e[0].pixels.length:1,f=[];let h;for(let t=0;t<u;t++){const n=e.map((e=>e.pixels[t]));let a;if(r===o.SetNull){const t=k(n,l,c);a=t.band,h=t.mask}else if(lt.has(r)){a=lt.get(r)(n,l,c)}else at.has(r)?a=g(n,l,c,at.get(r)):st.has(r)&&(a=d(n,l,c,st.get(r)));if(null==a)return null;f.push(a)}h||r===o.IsNull||(h=l);const p=e[0];return new n({width:p.width,height:p.height,pixelType:c,mask:h,pixels:f})}export{o as LocalOperator,ct as local,r as operandsCount};
