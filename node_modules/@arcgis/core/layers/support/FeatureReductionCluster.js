/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import r from"../../PopupTemplate.js";import"../../renderers/ClassBreaksRenderer.js";import"../../renderers/DictionaryRenderer.js";import"../../renderers/DotDensityRenderer.js";import"../../renderers/HeatmapRenderer.js";import"../../renderers/PieChartRenderer.js";import"../../renderers/Renderer.js";import o from"../../renderers/SimpleRenderer.js";import t from"../../renderers/UniqueValueRenderer.js";import{read as s}from"../../renderers/support/jsonUtils.js";import{rendererTypes as i}from"../../renderers/support/types.js";import{symbolTypesRenderer as p,symbolTypesCluster as n}from"../../symbols.js";import{JSONSupport as l}from"../../core/JSONSupport.js";import{clone as a}from"../../core/lang.js";import{setDeepValue as d}from"../../core/object.js";import{toPt as u}from"../../core/screenUtils.js";import{property as m}from"../../core/accessorSupport/decorators/property.js";import"../../core/accessorSupport/ensureType.js";import{reader as c}from"../../core/accessorSupport/decorators/reader.js";import{subclass as y}from"../../core/accessorSupport/decorators/subclass.js";import{writer as f}from"../../core/accessorSupport/decorators/writer.js";import{createTypeReader as b}from"../../core/accessorSupport/extensions/serializableProperty/reader.js";import j from"./AggregateField.js";import{popupEnabled as h,labelsVisible as g}from"./commonProperties.js";import S from"./LabelClass.js";var w;const I=b({types:p}),v="esri.layers.support.FeatureReductionCluster";function R(e){return"simple"===e.type&&!e.visualVariables?.length}let x=w=class extends l{constructor(e){super(e),this.type="cluster",this.clusterRadius=u("80px"),this.clusterMinSize=u("12px"),this.clusterMaxSize=u("50px"),this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=null}readRenderer(e,r,i){const p=r.drawingInfo?.renderer;return p?.authoringInfo?.isAutoGenerated?null:p?R(p)?null:s(p,r,i)??void 0:r.defaultSymbol?r.types&&r.types.length?new t({defaultSymbol:I(r.defaultSymbol,r,i),field:r.typeIdField,uniqueValueInfos:r.types.map((e=>({id:e.id,symbol:I(e.symbol,e,i)})))}):new o({symbol:I(r.defaultSymbol,r,i)}):null}readSymbol(e,r,o){const t=r.drawingInfo?.renderer;if(t?.authoringInfo?.isAutoGenerated)return null;if(t&&R(t)){return s(t,r,o)?.symbol}return null}writeSymbol(e,r,t,s){const i=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||i){const t=new o({symbol:e});r.drawingInfo={renderer:t.write({},s)}}}writeFields(e,r,o){const t=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));d(o,t,r)}readFields(e,r,o){return e.filter((e=>!e.isAutoGenerated)).map((e=>j.fromJSON(e)))}clone(){return new w({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:a(this.labelingInfo),labelsVisible:this.labelsVisible,fields:a(this.fields),renderer:a(this.renderer),symbol:a(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:a(this.popupTemplate)})}};e([m({type:["cluster"],readOnly:!0,json:{write:!0}})],x.prototype,"type",void 0),e([m({type:Number,cast:e=>"auto"===e?e:u(e),json:{write:!0}})],x.prototype,"clusterRadius",void 0),e([m({type:Number,cast:u,json:{write:!0}})],x.prototype,"clusterMinSize",void 0),e([m({type:Number,cast:u,json:{write:!0}})],x.prototype,"clusterMaxSize",void 0),e([m(h)],x.prototype,"popupEnabled",void 0),e([m({type:r,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],x.prototype,"popupTemplate",void 0),e([m({types:i,json:{write:{target:"drawingInfo.renderer"}}})],x.prototype,"renderer",void 0),e([c("renderer",["drawingInfo.renderer"])],x.prototype,"readRenderer",null),e([m({types:n})],x.prototype,"symbol",void 0),e([c("symbol",["drawingInfo.renderer"])],x.prototype,"readSymbol",null),e([f("symbol")],x.prototype,"writeSymbol",null),e([m({type:[S],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],x.prototype,"labelingInfo",void 0),e([m(g)],x.prototype,"labelsVisible",void 0),e([m({type:[j],json:{write:!0}})],x.prototype,"fields",void 0),e([f("fields")],x.prototype,"writeFields",null),e([c("fields")],x.prototype,"readFields",null),x=w=e([y(v)],x);const z=x;export{z as default};
